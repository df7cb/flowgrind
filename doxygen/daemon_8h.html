<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Flowgrind: src/daemon.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="flowgrind.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Flowgrind
   </div>
   <div id="projectbrief">Advanced TCP traffic generator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('daemon_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">daemon.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines used by the Flowgrind daemon.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;sys/socket.h&gt;</code><br />
<code>#include &lt;gsl/gsl_rng.h&gt;</code><br />
<code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__list_8h_source.html">fg_list.h</a>&quot;</code><br />
<code>#include &lt;xmlrpc-c/base.h&gt;</code><br />
<code>#include &lt;xmlrpc-c/server.h&gt;</code><br />
<code>#include &lt;xmlrpc-c/server_abyss.h&gt;</code><br />
<code>#include &lt;xmlrpc-c/util.h&gt;</code><br />
</div>
<p><a href="daemon_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structflow.html">flow</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structflow__source__settings.html">flow_source_settings</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrequest.html">request</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrequest__add__flow__destination.html">request_add_flow_destination</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrequest__add__flow__source.html">request_add_flow_source</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrequest__get__status.html">request_get_status</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrequest__get__uuid.html">request_get_uuid</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">structure for getting the UUID.  <a href="structrequest__get__uuid.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrequest__start__flows.html">request_start_flows</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrequest__stop__flow.html">request_stop_flow</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structflow_1_1statistics.html">flow::statistics</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a518951727d690b29538e702125381488"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a518951727d690b29538e702125381488">DEFAULT_SELECT_TIMEOUT</a>&#160;&#160;&#160;10000000</td></tr>
<tr class="memdesc:a518951727d690b29538e702125381488"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time select() will block waiting for a file descriptor to become ready.  <a href="daemon_8h.html#a518951727d690b29538e702125381488">More...</a><br /></td></tr>
<tr class="separator:a518951727d690b29538e702125381488"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cb3dd3b58581d382be8492aba04511f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a1cb3dd3b58581d382be8492aba04511f">REQUEST_ADD_DESTINATION</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a1cb3dd3b58581d382be8492aba04511f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a11d078671d380e037fd310d4e614cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a3a11d078671d380e037fd310d4e614cd">REQUEST_ADD_SOURCE</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a3a11d078671d380e037fd310d4e614cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98e181f48db2db4c7cbf28cde6f9232a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a98e181f48db2db4c7cbf28cde6f9232a">REQUEST_GET_STATUS</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a98e181f48db2db4c7cbf28cde6f9232a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7956881b57fbb4cf42cb60ce602c8313"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a7956881b57fbb4cf42cb60ce602c8313">REQUEST_GET_UUID</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a7956881b57fbb4cf42cb60ce602c8313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03812c2ffe8d7c7ee20036c7ff10debb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a03812c2ffe8d7c7ee20036c7ff10debb">REQUEST_START_FLOWS</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a03812c2ffe8d7c7ee20036c7ff10debb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ce8d4ae1e4221490780ddcf1e48191c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a3ce8d4ae1e4221490780ddcf1e48191c">REQUEST_STOP_FLOW</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a3ce8d4ae1e4221490780ddcf1e48191c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ab8dcbe03f47dda503913a20c52bf4de7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7">flow_state_t</a> { <a class="el" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c">GRIND_WAIT_CONNECT</a> = 0, 
<a class="el" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a30e50ffb173bb9b94042b020c00308a8">GRIND_WAIT_ACCEPT</a>, 
<a class="el" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a3ac693700b72f74b4434e2581a52e825">GRIND</a>
 }</td></tr>
<tr class="separator:ab8dcbe03f47dda503913a20c52bf4de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0a01949c50bc8128d13198fce302a021"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a0a01949c50bc8128d13198fce302a021">add_report</a> (struct <a class="el" href="structreport.html">report</a> *<a class="el" href="structreport.html">report</a>)</td></tr>
<tr class="separator:a0a01949c50bc8128d13198fce302a021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab772e063b6500100f2a49a3c1cbc743e"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#ab772e063b6500100f2a49a3c1cbc743e">daemon_main</a> (void *ptr)</td></tr>
<tr class="separator:ab772e063b6500100f2a49a3c1cbc743e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4271388fd018c3d910e4839b3747df96"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a> (struct <a class="el" href="structrequest.html">request</a> *<a class="el" href="structrequest.html">request</a>, int type)</td></tr>
<tr class="memdesc:a4271388fd018c3d910e4839b3747df96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispatch a request to daemon loop.  <a href="daemon_8h.html#a4271388fd018c3d910e4839b3747df96">More...</a><br /></td></tr>
<tr class="separator:a4271388fd018c3d910e4839b3747df96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b81f4cc8f5217b1d4ffa4a437377429"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, const char *fmt,...)</td></tr>
<tr class="separator:a2b81f4cc8f5217b1d4ffa4a437377429"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1c880d68d8e730eaf7836e3883b6fbf"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structreport.html">report</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#ae1c880d68d8e730eaf7836e3883b6fbf">get_reports</a> (int *has_more)</td></tr>
<tr class="separator:ae1c880d68d8e730eaf7836e3883b6fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af02359addacb39f08b62d85d0dc38ed8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#af02359addacb39f08b62d85d0dc38ed8">get_uuid_string</a> (char *uuid_str)</td></tr>
<tr class="memdesc:af02359addacb39f08b62d85d0dc38ed8"><td class="mdescLeft">&#160;</td><td class="mdescRight">To generate daemon UUID.  <a href="daemon_8h.html#af02359addacb39f08b62d85d0dc38ed8">More...</a><br /></td></tr>
<tr class="separator:af02359addacb39f08b62d85d0dc38ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace116bed071948dc1f66acc55607feb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#ace116bed071948dc1f66acc55607feb3">request_error</a> (struct <a class="el" href="structrequest.html">request</a> *<a class="el" href="structrequest.html">request</a>, const char *fmt,...)</td></tr>
<tr class="separator:ace116bed071948dc1f66acc55607feb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa6483c8495b4df9665927f6ab4eaabb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#afa6483c8495b4df9665927f6ab4eaabb">set_flow_tcp_options</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:afa6483c8495b4df9665927f6ab4eaabb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a114a7eaf522519c4b3efbefb5fc069cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a114a7eaf522519c4b3efbefb5fc069cf">daemon_pipe</a> [2]</td></tr>
<tr class="separator:a114a7eaf522519c4b3efbefb5fc069cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a00c14be1565cda838246a824529e42"><td class="memItemLeft" align="right" valign="top">pthread_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a6a00c14be1565cda838246a824529e42">daemon_thread</a></td></tr>
<tr class="separator:a6a00c14be1565cda838246a824529e42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e00b9f05b6a2247bb6c99ff3387a932"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a9e00b9f05b6a2247bb6c99ff3387a932">dump_dir</a></td></tr>
<tr class="separator:a9e00b9f05b6a2247bb6c99ff3387a932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a016095bb5b1fadba7bc57d2a0d1a75f8"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a016095bb5b1fadba7bc57d2a0d1a75f8">dump_prefix</a></td></tr>
<tr class="separator:a016095bb5b1fadba7bc57d2a0d1a75f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404ebcfc5a80e668901703c46a807157"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlinked__list.html">linked_list</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a404ebcfc5a80e668901703c46a807157">flows</a></td></tr>
<tr class="separator:a404ebcfc5a80e668901703c46a807157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4acff8232e4aec9cd5c6dc200ac55ef3"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a></td></tr>
<tr class="separator:a4acff8232e4aec9cd5c6dc200ac55ef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33febb18ddf50438a47e5eee54be6c77"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a></td></tr>
<tr class="separator:a33febb18ddf50438a47e5eee54be6c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5981029394ee67ad583f0319dc9468b5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structreport.html">report</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a5981029394ee67ad583f0319dc9468b5">reports</a></td></tr>
<tr class="separator:a5981029394ee67ad583f0319dc9468b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dd776b27a8695d29a8f178ddb26a2eb"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structreport.html">report</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a></td></tr>
<tr class="separator:a7dd776b27a8695d29a8f178ddb26a2eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa94c4a05963e33561e701944c82d645"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structrequest.html">request</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#aaa94c4a05963e33561e701944c82d645">requests</a></td></tr>
<tr class="separator:aaa94c4a05963e33561e701944c82d645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c8ad0b474e5da9a984f42d401e58d9c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structrequest.html">request</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a5c8ad0b474e5da9a984f42d401e58d9c">requests_last</a></td></tr>
<tr class="separator:a5c8ad0b474e5da9a984f42d401e58d9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22822755789d0770b81f031d467cd6e4"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8h.html#a22822755789d0770b81f031d467cd6e4">started</a></td></tr>
<tr class="separator:a22822755789d0770b81f031d467cd6e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines used by the Flowgrind daemon. </p>

<p class="definition">Definition in file <a class="el" href="daemon_8h_source.html">daemon.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a518951727d690b29538e702125381488"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a518951727d690b29538e702125381488">&#9670;&nbsp;</a></span>DEFAULT_SELECT_TIMEOUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_SELECT_TIMEOUT&#160;&#160;&#160;10000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Time select() will block waiting for a file descriptor to become ready. </p>

<p class="definition">Definition at line <a class="el" href="daemon_8h_source.html#l00051">51</a> of file <a class="el" href="daemon_8h_source.html">daemon.h</a>.</p>

</div>
</div>
<a id="a1cb3dd3b58581d382be8492aba04511f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cb3dd3b58581d382be8492aba04511f">&#9670;&nbsp;</a></span>REQUEST_ADD_DESTINATION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQUEST_ADD_DESTINATION&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8h_source.html#l00173">173</a> of file <a class="el" href="daemon_8h_source.html">daemon.h</a>.</p>

</div>
</div>
<a id="a3a11d078671d380e037fd310d4e614cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a11d078671d380e037fd310d4e614cd">&#9670;&nbsp;</a></span>REQUEST_ADD_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQUEST_ADD_SOURCE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8h_source.html#l00174">174</a> of file <a class="el" href="daemon_8h_source.html">daemon.h</a>.</p>

</div>
</div>
<a id="a98e181f48db2db4c7cbf28cde6f9232a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98e181f48db2db4c7cbf28cde6f9232a">&#9670;&nbsp;</a></span>REQUEST_GET_STATUS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQUEST_GET_STATUS&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8h_source.html#l00177">177</a> of file <a class="el" href="daemon_8h_source.html">daemon.h</a>.</p>

</div>
</div>
<a id="a7956881b57fbb4cf42cb60ce602c8313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7956881b57fbb4cf42cb60ce602c8313">&#9670;&nbsp;</a></span>REQUEST_GET_UUID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQUEST_GET_UUID&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8h_source.html#l00178">178</a> of file <a class="el" href="daemon_8h_source.html">daemon.h</a>.</p>

</div>
</div>
<a id="a03812c2ffe8d7c7ee20036c7ff10debb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03812c2ffe8d7c7ee20036c7ff10debb">&#9670;&nbsp;</a></span>REQUEST_START_FLOWS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQUEST_START_FLOWS&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8h_source.html#l00175">175</a> of file <a class="el" href="daemon_8h_source.html">daemon.h</a>.</p>

</div>
</div>
<a id="a3ce8d4ae1e4221490780ddcf1e48191c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ce8d4ae1e4221490780ddcf1e48191c">&#9670;&nbsp;</a></span>REQUEST_STOP_FLOW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQUEST_STOP_FLOW&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8h_source.html#l00176">176</a> of file <a class="el" href="daemon_8h_source.html">daemon.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ab8dcbe03f47dda503913a20c52bf4de7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8dcbe03f47dda503913a20c52bf4de7">&#9670;&nbsp;</a></span>flow_state_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7">flow_state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c"></a>GRIND_WAIT_CONNECT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab8dcbe03f47dda503913a20c52bf4de7a30e50ffb173bb9b94042b020c00308a8"></a>GRIND_WAIT_ACCEPT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab8dcbe03f47dda503913a20c52bf4de7a3ac693700b72f74b4434e2581a52e825"></a>GRIND&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="daemon_8h_source.html#l00053">53</a> of file <a class="el" href="daemon_8h_source.html">daemon.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="comment">/* SOURCE */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c">GRIND_WAIT_CONNECT</a> = 0,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="comment">/* DESTINATION */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a30e50ffb173bb9b94042b020c00308a8">GRIND_WAIT_ACCEPT</a>,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="comment">/* RUN */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a3ac693700b72f74b4434e2581a52e825">GRIND</a>,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0a01949c50bc8128d13198fce302a021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a01949c50bc8128d13198fce302a021">&#9670;&nbsp;</a></span>add_report()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void add_report </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structreport.html">report</a> *&#160;</td>
          <td class="paramname"><em>report</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00827">827</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;{</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;add_report trying to lock mutex&quot;</span>);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        pthread_mutex_lock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;add_report aquired mutex&quot;</span>);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="comment">/* Do not keep too much data */</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a> &gt;= 250 &amp;&amp; <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a> != <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>) {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                free(<a class="code" href="structreport.html">report</a>);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                pthread_mutex_unlock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a> = 0;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a>)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                <a class="code" href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a>-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a> = <a class="code" href="structreport.html">report</a>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a> = <a class="code" href="structreport.html">report</a>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <a class="code" href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a> = <a class="code" href="structreport.html">report</a>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <a class="code" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a>++;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        pthread_mutex_unlock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;add_report unlocked mutex&quot;</span>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab772e063b6500100f2a49a3c1cbc743e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab772e063b6500100f2a49a3c1cbc743e">&#9670;&nbsp;</a></span>daemon_main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* daemon_main </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4271388fd018c3d910e4839b3747df96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4271388fd018c3d910e4839b3747df96">&#9670;&nbsp;</a></span>dispatch_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dispatch_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrequest.html">request</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispatch a request to daemon loop. </p>
<p>Is called by the rpc server to feed in requests to the daemon. </p>

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01489">1489</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;{</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        pthread_cond_t cond;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a> = NULL;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#a76afbbb7cbf4b0627459b37b75062b40">type</a> = type;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#a37274d635f4592bd537b14b1956bde52">next</a> = NULL;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        <span class="comment">/* Create synchronization mutex */</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <span class="keywordflow">if</span> (pthread_cond_init(&amp;cond, NULL)) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                <a class="code" href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a>(<a class="code" href="structrequest.html">request</a>, <span class="stringliteral">&quot;Could not create synchronization mutex&quot;</span>);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#adf85beff9f9a1191e2c9985fde174282">condition</a> = &amp;cond;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160; </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        pthread_mutex_lock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a>) {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                <a class="code" href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a> = <a class="code" href="structrequest.html">request</a>;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                <a class="code" href="daemon_8c.html#a5c8ad0b474e5da9a984f42d401e58d9c">requests_last</a> = <a class="code" href="structrequest.html">request</a>;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                <a class="code" href="daemon_8c.html#a5c8ad0b474e5da9a984f42d401e58d9c">requests_last</a>-&gt;<a class="code" href="structrequest.html#a37274d635f4592bd537b14b1956bde52">next</a> = <a class="code" href="structrequest.html">request</a>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                <a class="code" href="daemon_8c.html#a5c8ad0b474e5da9a984f42d401e58d9c">requests_last</a> = <a class="code" href="structrequest.html">request</a>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="keywordflow">if</span> (write(<a class="code" href="daemon_8c.html#a114a7eaf522519c4b3efbefb5fc069cf">daemon_pipe</a>[1], &amp;type, 1) != 1) <span class="comment">/* Doesn&#39;t matter what we write */</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="comment">/* Wait until the daemon thread has processed the request */</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        pthread_cond_wait(&amp;cond, &amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        pthread_mutex_unlock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b81f4cc8f5217b1d4ffa4a437377429"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b81f4cc8f5217b1d4ffa4a437377429">&#9670;&nbsp;</a></span>flow_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flow_error </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00119">119</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordtype">char</span> str[1000];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        va_list ap;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        va_start(ap, fmt);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        vsnprintf(str, 1000, fmt, ap);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        va_end(ap);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        str[<span class="keyword">sizeof</span>(str) - 1] = 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a> = malloc(strlen(str) + 1);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        strcpy(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a>, str);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1c880d68d8e730eaf7836e3883b6fbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1c880d68d8e730eaf7836e3883b6fbf">&#9670;&nbsp;</a></span>get_reports()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structreport.html">report</a>* get_reports </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>has_more</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00853">853</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;{</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_reports = 50;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keyword">struct </span><a class="code" href="structreport.html">report</a>* ret;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;get_reports trying to lock mutex&quot;</span>);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        pthread_mutex_lock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;get_reports aquired mutex&quot;</span>);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        ret = <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a> &lt;= max_reports) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                *has_more = 0;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                <a class="code" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a> = 0;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a> = NULL;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                <a class="code" href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a> = 0;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <span class="comment">/* Split off first 50 items */</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                <span class="keyword">struct </span><a class="code" href="structreport.html">report</a>* tmp;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; max_reports - 1; i++)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                        <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a> = <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a>-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                tmp = <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a>-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a>-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a> = 0;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a> = tmp;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                <a class="code" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a> -= max_reports;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                *has_more = 1;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        pthread_mutex_unlock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;get_reports unlocked mutex&quot;</span>);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af02359addacb39f08b62d85d0dc38ed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af02359addacb39f08b62d85d0dc38ed8">&#9670;&nbsp;</a></span>get_uuid_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_uuid_string </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>uuid_str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To generate daemon UUID. </p>
<p>Generate the daemon UUID and convert the UUID to a string data. UUID is generated by daemon only once and stored in the global variable. The daemon return the same UUID for all the flows it maintaining. This UUID is taken as a reference to identify the daemon in the controller.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">uuid_str</td><td>daemons UUID </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01536">1536</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;{</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        uuid_t uuid;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">char</span> server_uuid[38] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <span class="keywordflow">if</span> (!strlen(server_uuid)) {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                uuid_generate_time(uuid);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                uuid_unparse(uuid,uuid_str);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                memset(server_uuid,0,<span class="keyword">sizeof</span>(server_uuid));</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                strcpy(server_uuid,uuid_str);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        strcpy(uuid_str,server_uuid);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ace116bed071948dc1f66acc55607feb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace116bed071948dc1f66acc55607feb3">&#9670;&nbsp;</a></span>request_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void request_error </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrequest.html">request</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00132">132</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordtype">char</span> str[1000];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        va_list ap;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        va_start(ap, fmt);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        vsnprintf(str, 1000, fmt, ap);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        va_end(ap);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        str[<span class="keyword">sizeof</span>(str) - 1] = 0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a> = malloc(strlen(str) + 1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        strcpy(<a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>, str);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa6483c8495b4df9665927f6ab4eaabb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa6483c8495b4df9665927f6ab4eaabb">&#9670;&nbsp;</a></span>set_flow_tcp_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_flow_tcp_options </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01424">1424</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;{</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <a class="code" href="fg__socket_8c.html#a02113c8824bad0f80c20102a1756634b">set_non_blocking</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordflow">if</span> (*<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a1206d0f66388f1f916f1ea237453a8db">cc_alg</a> &amp;&amp;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <a class="code" href="fg__socket_8c.html#acd5c2f8cbb01fc2c9aad7574fa2d7d63">set_congestion_control</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a1206d0f66388f1f916f1ea237453a8db">cc_alg</a>) == -1) {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set congestion control &quot;</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                           <span class="stringliteral">&quot;algorithm: %s&quot;</span>, strerror(errno));</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a773a21e329a31811844f9f26da458e62">elcn</a> &amp;&amp;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            <a class="code" href="fg__socket_8c.html#a82d86f7f3d35cb6f06c2cb9f57955d87">set_so_elcn</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a773a21e329a31811844f9f26da458e62">elcn</a>) == -1) {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set TCP_ELCN: %s&quot;</span>,</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#aa16b93831301f5b6faf010158327cf67">lcd</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#a9f03da778d202b26f33b7d463181856e">set_so_lcd</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set TCP_LCD: %s&quot;</span>,</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ae229f5e5bd4c3689473dcb7b7debea6e">cork</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#ab2053a8d245324b11d603cc43b327db5">set_tcp_cork</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set TCP_CORK: %s&quot;</span>,</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        }</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ae1bb84bc89626d9c6950b41a7a124ee2">so_debug</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#a2c49d58f3483817990c8b7c732891ffd">set_so_debug</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set SO_DEBUG: %s&quot;</span>,</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#aeebdd152f5d7d68a4435b31313550bad">mtcp</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#a3812672e43521addb0f94be5ec70a2c7">set_tcp_mtcp</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set TCP_MTCP: %s&quot;</span>,</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#af1d11c3e1d43f04babc48c1c002a31ac">nonagle</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#ac2ddd7ff0e28617a498b922b85ad9e29">set_tcp_nodelay</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set TCP_NODELAY: %s&quot;</span>,</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#aea33a5413dbace7b756f93afdea7963d">route_record</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#af08fd91d990fe9481090aaf7f5efabdb">set_route_record</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set route record option: %s&quot;</span>,</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        }</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">dscp</a> &amp;&amp;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            <a class="code" href="fg__socket_8c.html#a128d76deeb39f543de89cf0c52729101">set_dscp</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">dscp</a>) == -1) {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set DSCP value: %s&quot;</span>,</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a182d573decbb50a7691ab088dd630a54">ipmtudiscover</a> &amp;&amp;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <a class="code" href="fg__socket_8c.html#a28705e5f3da83f4c8721e547c41687c4">set_ip_mtu_discover</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set IP_MTU_DISCOVER value: %s&quot;</span>,</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a66910f0d25743b5d85ddfb9069198aa4">apply_extra_socket_options</a>(<a class="code" href="structflow.html">flow</a>) == -1)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a114a7eaf522519c4b3efbefb5fc069cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114a7eaf522519c4b3efbefb5fc069cf">&#9670;&nbsp;</a></span>daemon_pipe</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int daemon_pipe[2]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00087">87</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a6a00c14be1565cda838246a824529e42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a00c14be1565cda838246a824529e42">&#9670;&nbsp;</a></span>daemon_thread</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_t daemon_thread</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00089">89</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a9e00b9f05b6a2247bb6c99ff3387a932"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e00b9f05b6a2247bb6c99ff3387a932">&#9670;&nbsp;</a></span>dump_dir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* dump_dir</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00091">91</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a016095bb5b1fadba7bc57d2a0d1a75f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a016095bb5b1fadba7bc57d2a0d1a75f8">&#9670;&nbsp;</a></span>dump_prefix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* dump_prefix</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00090">90</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a404ebcfc5a80e668901703c46a807157"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404ebcfc5a80e668901703c46a807157">&#9670;&nbsp;</a></span>flows</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlinked__list.html">linked_list</a> flows</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00103">103</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a4acff8232e4aec9cd5c6dc200ac55ef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4acff8232e4aec9cd5c6dc200ac55ef3">&#9670;&nbsp;</a></span>mutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t mutex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00093">93</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a33febb18ddf50438a47e5eee54be6c77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33febb18ddf50438a47e5eee54be6c77">&#9670;&nbsp;</a></span>pending_reports</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned pending_reports</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00101">101</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a5981029394ee67ad583f0319dc9468b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5981029394ee67ad583f0319dc9468b5">&#9670;&nbsp;</a></span>reports</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structreport.html">report</a>* reports</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00099">99</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a7dd776b27a8695d29a8f178ddb26a2eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dd776b27a8695d29a8f178ddb26a2eb">&#9670;&nbsp;</a></span>reports_last</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structreport.html">report</a>* reports_last</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00100">100</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="aaa94c4a05963e33561e701944c82d645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa94c4a05963e33561e701944c82d645">&#9670;&nbsp;</a></span>requests</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structrequest.html">request</a>* requests</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00094">94</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a5c8ad0b474e5da9a984f42d401e58d9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c8ad0b474e5da9a984f42d401e58d9c">&#9670;&nbsp;</a></span>requests_last</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structrequest.html">request</a> * requests_last</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8h_source.html#l00191">191</a> of file <a class="el" href="daemon_8h_source.html">daemon.h</a>.</p>

</div>
</div>
<a id="a22822755789d0770b81f031d467cd6e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22822755789d0770b81f031d467cd6e4">&#9670;&nbsp;</a></span>started</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char started</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00105">105</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="adebug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error.</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="acommon_8h_html_aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5"><div class="ttname"><a href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a></div><div class="ttdeci">@ FINAL</div><div class="ttdoc">Final report.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00116">common.h:116</a></div></div>
<div class="ttc" id="adaemon_8c_html_a66910f0d25743b5d85ddfb9069198aa4"><div class="ttname"><a href="daemon_8c.html#a66910f0d25743b5d85ddfb9069198aa4">apply_extra_socket_options</a></div><div class="ttdeci">int apply_extra_socket_options(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01378">daemon.c:1378</a></div></div>
<div class="ttc" id="astructflow_html"><div class="ttname"><a href="structflow.html">flow</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00073">daemon.h:73</a></div></div>
<div class="ttc" id="adaemon_8c_html_ace116bed071948dc1f66acc55607feb3"><div class="ttname"><a href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a></div><div class="ttdeci">void request_error(struct request *request, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00132">daemon.c:132</a></div></div>
<div class="ttc" id="astructflow__settings_html_a06c29bb39cf7a6004178e5582949990a"><div class="ttname"><a href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">flow_settings::dscp</a></div><div class="ttdeci">int dscp</div><div class="ttdoc">DSCP value for TOS byte (option -D).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00244">common.h:244</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a02113c8824bad0f80c20102a1756634b"><div class="ttname"><a href="fg__socket_8c.html#a02113c8824bad0f80c20102a1756634b">set_non_blocking</a></div><div class="ttdeci">int set_non_blocking(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00172">fg_socket.c:172</a></div></div>
<div class="ttc" id="astructflow__settings_html_ae229f5e5bd4c3689473dcb7b7debea6e"><div class="ttname"><a href="structflow__settings.html#ae229f5e5bd4c3689473dcb7b7debea6e">flow_settings::cork</a></div><div class="ttdeci">int cork</div><div class="ttdoc">Sets SO_DEBUG on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00232">common.h:232</a></div></div>
<div class="ttc" id="adaemon_8h_html_ab8dcbe03f47dda503913a20c52bf4de7a3ac693700b72f74b4434e2581a52e825"><div class="ttname"><a href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a3ac693700b72f74b4434e2581a52e825">GRIND</a></div><div class="ttdeci">@ GRIND</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00060">daemon.h:60</a></div></div>
<div class="ttc" id="astructflow__settings_html_a1206d0f66388f1f916f1ea237453a8db"><div class="ttname"><a href="structflow__settings.html#a1206d0f66388f1f916f1ea237453a8db">flow_settings::cc_alg</a></div><div class="ttdeci">char cc_alg[TCP_CA_NAME_MAX]</div><div class="ttdoc">Set congestion control algorithm ALG on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00236">common.h:236</a></div></div>
<div class="ttc" id="astructflow_html_abf86c8f5e99971c55bee93782f3c06b4"><div class="ttname"><a href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">flow::settings</a></div><div class="ttdeci">struct flow_settings settings</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00083">daemon.h:83</a></div></div>
<div class="ttc" id="astructreport_html_a0a3773754225984337b3363320143e6e"><div class="ttname"><a href="structreport.html#a0a3773754225984337b3363320143e6e">report::next</a></div><div class="ttdeci">struct report * next</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00338">common.h:338</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a128d76deeb39f543de89cf0c52729101"><div class="ttname"><a href="fg__socket_8c.html#a128d76deeb39f543de89cf0c52729101">set_dscp</a></div><div class="ttdeci">int set_dscp(int fd, int dscp)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00132">fg_socket.c:132</a></div></div>
<div class="ttc" id="afg__socket_8c_html_ab2053a8d245324b11d603cc43b327db5"><div class="ttname"><a href="fg__socket_8c.html#ab2053a8d245324b11d603cc43b327db5">set_tcp_cork</a></div><div class="ttdeci">int set_tcp_cork(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00317">fg_socket.c:317</a></div></div>
<div class="ttc" id="astructrequest_html_a76afbbb7cbf4b0627459b37b75062b40"><div class="ttname"><a href="structrequest.html#a76afbbb7cbf4b0627459b37b75062b40">request::type</a></div><div class="ttdeci">char type</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00181">daemon.h:181</a></div></div>
<div class="ttc" id="astructreport_html"><div class="ttname"><a href="structreport.html">report</a></div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00286">common.h:286</a></div></div>
<div class="ttc" id="adaemon_8c_html_a7dd776b27a8695d29a8f178ddb26a2eb"><div class="ttname"><a href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a></div><div class="ttdeci">struct report * reports_last</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00100">daemon.c:100</a></div></div>
<div class="ttc" id="adaemon_8c_html_a4acff8232e4aec9cd5c6dc200ac55ef3"><div class="ttname"><a href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a></div><div class="ttdeci">pthread_mutex_t mutex</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00093">daemon.c:93</a></div></div>
<div class="ttc" id="astructflow__settings_html_a182d573decbb50a7691ab088dd630a54"><div class="ttname"><a href="structflow__settings.html#a182d573decbb50a7691ab088dd630a54">flow_settings::ipmtudiscover</a></div><div class="ttdeci">int ipmtudiscover</div><div class="ttdoc">Set IP_MTU_DISCOVER on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00246">common.h:246</a></div></div>
<div class="ttc" id="afg__socket_8c_html_ac2ddd7ff0e28617a498b922b85ad9e29"><div class="ttname"><a href="fg__socket_8c.html#ac2ddd7ff0e28617a498b922b85ad9e29">set_tcp_nodelay</a></div><div class="ttdeci">int set_tcp_nodelay(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00358">fg_socket.c:358</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a2c49d58f3483817990c8b7c732891ffd"><div class="ttname"><a href="fg__socket_8c.html#a2c49d58f3483817990c8b7c732891ffd">set_so_debug</a></div><div class="ttdeci">int set_so_debug(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00366">fg_socket.c:366</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a82d86f7f3d35cb6f06c2cb9f57955d87"><div class="ttname"><a href="fg__socket_8c.html#a82d86f7f3d35cb6f06c2cb9f57955d87">set_so_elcn</a></div><div class="ttdeci">int set_so_elcn(int fd, int val)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00278">fg_socket.c:278</a></div></div>
<div class="ttc" id="adaemon_8c_html_a33febb18ddf50438a47e5eee54be6c77"><div class="ttname"><a href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a></div><div class="ttdeci">unsigned pending_reports</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00101">daemon.c:101</a></div></div>
<div class="ttc" id="astructrequest_html"><div class="ttname"><a href="structrequest.html">request</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00179">daemon.h:179</a></div></div>
<div class="ttc" id="astructflow_html_a74df07d93cabc54a4b43f53fb90d7eb6"><div class="ttname"><a href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">flow::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00170">daemon.h:170</a></div></div>
<div class="ttc" id="astructrequest_html_a37274d635f4592bd537b14b1956bde52"><div class="ttname"><a href="structrequest.html#a37274d635f4592bd537b14b1956bde52">request::next</a></div><div class="ttdeci">struct request * next</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00189">daemon.h:189</a></div></div>
<div class="ttc" id="adaemon_8h_html_ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c"><div class="ttname"><a href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c">GRIND_WAIT_CONNECT</a></div><div class="ttdeci">@ GRIND_WAIT_CONNECT</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00056">daemon.h:56</a></div></div>
<div class="ttc" id="adaemon_8c_html_a5c8ad0b474e5da9a984f42d401e58d9c"><div class="ttname"><a href="daemon_8c.html#a5c8ad0b474e5da9a984f42d401e58d9c">requests_last</a></div><div class="ttdeci">struct request * requests_last</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00094">daemon.c:94</a></div></div>
<div class="ttc" id="adaemon_8h_html_ab8dcbe03f47dda503913a20c52bf4de7a30e50ffb173bb9b94042b020c00308a8"><div class="ttname"><a href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a30e50ffb173bb9b94042b020c00308a8">GRIND_WAIT_ACCEPT</a></div><div class="ttdeci">@ GRIND_WAIT_ACCEPT</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00058">daemon.h:58</a></div></div>
<div class="ttc" id="adaemon_8c_html_aaa94c4a05963e33561e701944c82d645"><div class="ttname"><a href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a></div><div class="ttdeci">struct request * requests</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00094">daemon.c:94</a></div></div>
<div class="ttc" id="astructflow__settings_html_af1d11c3e1d43f04babc48c1c002a31ac"><div class="ttname"><a href="structflow__settings.html#af1d11c3e1d43f04babc48c1c002a31ac">flow_settings::nonagle</a></div><div class="ttdeci">int nonagle</div><div class="ttdoc">Disable nagle algorithm on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00234">common.h:234</a></div></div>
<div class="ttc" id="astructrequest_html_acc214191f4fbfabdedf789adc862b393"><div class="ttname"><a href="structrequest.html#acc214191f4fbfabdedf789adc862b393">request::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00187">daemon.h:187</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a9f03da778d202b26f33b7d463181856e"><div class="ttname"><a href="fg__socket_8c.html#a9f03da778d202b26f33b7d463181856e">set_so_lcd</a></div><div class="ttdeci">int set_so_lcd(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00288">fg_socket.c:288</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a28705e5f3da83f4c8721e547c41687c4"><div class="ttname"><a href="fg__socket_8c.html#a28705e5f3da83f4c8721e547c41687c4">set_ip_mtu_discover</a></div><div class="ttdeci">int set_ip_mtu_discover(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00300">fg_socket.c:300</a></div></div>
<div class="ttc" id="afg__socket_8c_html_af08fd91d990fe9481090aaf7f5efabdb"><div class="ttname"><a href="fg__socket_8c.html#af08fd91d990fe9481090aaf7f5efabdb">set_route_record</a></div><div class="ttdeci">int set_route_record(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00149">fg_socket.c:149</a></div></div>
<div class="ttc" id="astructflow__settings_html_a773a21e329a31811844f9f26da458e62"><div class="ttname"><a href="structflow__settings.html#a773a21e329a31811844f9f26da458e62">flow_settings::elcn</a></div><div class="ttdeci">int elcn</div><div class="ttdoc">Set TCP_ELCN (20) on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00238">common.h:238</a></div></div>
<div class="ttc" id="astructflow_html_a8c89f7316d6e7fab40989f40ac8a972d"><div class="ttname"><a href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">flow::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00080">daemon.h:80</a></div></div>
<div class="ttc" id="adaemon_8c_html_a2b81f4cc8f5217b1d4ffa4a437377429"><div class="ttname"><a href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a></div><div class="ttdeci">void flow_error(struct flow *flow, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00119">daemon.c:119</a></div></div>
<div class="ttc" id="adaemon_8c_html_a5981029394ee67ad583f0319dc9468b5"><div class="ttname"><a href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a></div><div class="ttdeci">struct report * reports</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00099">daemon.c:99</a></div></div>
<div class="ttc" id="astructflow__settings_html_aa16b93831301f5b6faf010158327cf67"><div class="ttname"><a href="structflow__settings.html#aa16b93831301f5b6faf010158327cf67">flow_settings::lcd</a></div><div class="ttdeci">int lcd</div><div class="ttdoc">Set TCP_LCD (21) on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00240">common.h:240</a></div></div>
<div class="ttc" id="astructrequest_html_adf85beff9f9a1191e2c9985fde174282"><div class="ttname"><a href="structrequest.html#adf85beff9f9a1191e2c9985fde174282">request::condition</a></div><div class="ttdeci">pthread_cond_t * condition</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00185">daemon.h:185</a></div></div>
<div class="ttc" id="adaemon_8c_html_a114a7eaf522519c4b3efbefb5fc069cf"><div class="ttname"><a href="daemon_8c.html#a114a7eaf522519c4b3efbefb5fc069cf">daemon_pipe</a></div><div class="ttdeci">int daemon_pipe[2]</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00087">daemon.c:87</a></div></div>
<div class="ttc" id="astructreport_html_ad501f3629fd9df5887dde4de44d02f45"><div class="ttname"><a href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">report::type</a></div><div class="ttdeci">enum report_t type</div><div class="ttdoc">Report type - either INTERVAL or FINAL report.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00291">common.h:291</a></div></div>
<div class="ttc" id="astructflow__settings_html_aeebdd152f5d7d68a4435b31313550bad"><div class="ttname"><a href="structflow__settings.html#aeebdd152f5d7d68a4435b31313550bad">flow_settings::mtcp</a></div><div class="ttdeci">int mtcp</div><div class="ttdoc">Set TCP_MTCP (15) on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00242">common.h:242</a></div></div>
<div class="ttc" id="afg__socket_8c_html_acd5c2f8cbb01fc2c9aad7574fa2d7d63"><div class="ttname"><a href="fg__socket_8c.html#acd5c2f8cbb01fc2c9aad7574fa2d7d63">set_congestion_control</a></div><div class="ttdeci">int set_congestion_control(int fd, const char *cc_alg)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00265">fg_socket.c:265</a></div></div>
<div class="ttc" id="astructflow__settings_html_ae1bb84bc89626d9c6950b41a7a124ee2"><div class="ttname"><a href="structflow__settings.html#ae1bb84bc89626d9c6950b41a7a124ee2">flow_settings::so_debug</a></div><div class="ttdeci">int so_debug</div><div class="ttdoc">Sets SO_DEBUG on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00206">common.h:206</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a3812672e43521addb0f94be5ec70a2c7"><div class="ttname"><a href="fg__socket_8c.html#a3812672e43521addb0f94be5ec70a2c7">set_tcp_mtcp</a></div><div class="ttdeci">int set_tcp_mtcp(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00347">fg_socket.c:347</a></div></div>
<div class="ttc" id="astructflow__settings_html_aea33a5413dbace7b756f93afdea7963d"><div class="ttname"><a href="structflow__settings.html#aea33a5413dbace7b756f93afdea7963d">flow_settings::route_record</a></div><div class="ttdeci">int route_record</div><div class="ttdoc">Sets ROUTE_RECORD on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00208">common.h:208</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="daemon_8h.html">daemon.h</a></li>
    <li class="footer">Generated on Sat Jan 16 2021 18:15:29 for Flowgrind by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
