<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Flowgrind: src/daemon.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="flowgrind.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Flowgrind
   </div>
   <div id="projectbrief">Advanced TCP traffic generator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('daemon_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">daemon.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines used by the Flowgrind daemon.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdarg.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;strings.h&gt;</code><br />
<code>#include &lt;signal.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;sys/socket.h&gt;</code><br />
<code>#include &lt;sys/param.h&gt;</code><br />
<code>#include &lt;sys/select.h&gt;</code><br />
<code>#include &lt;netinet/in.h&gt;</code><br />
<code>#include &lt;arpa/inet.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;sys/wait.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;syslog.h&gt;</code><br />
<code>#include &lt;sys/time.h&gt;</code><br />
<code>#include &lt;netdb.h&gt;</code><br />
<code>#include &lt;pthread.h&gt;</code><br />
<code>#include &lt;inttypes.h&gt;</code><br />
<code>#include &lt;float.h&gt;</code><br />
<code>#include &lt;uuid/uuid.h&gt;</code><br />
<code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="debug_8h_source.html">debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__error_8h_source.html">fg_error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__math_8h_source.html">fg_math.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__definitions_8h_source.html">fg_definitions.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__socket_8h_source.html">fg_socket.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__time_8h_source.html">fg_time.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__log_8h_source.html">fg_log.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="daemon_8h_source.html">daemon.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="source_8h_source.html">source.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="destination_8h_source.html">destination.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="trafgen_8h_source.html">trafgen.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fg__pcap_8h_source.html">fg_pcap.h</a>&quot;</code><br />
</div>
<p><a href="daemon_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a08a1bae2da6cab801ece1025a260b1b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a08a1bae2da6cab801ece1025a260b1b1">CONGESTION_LIMIT</a>&#160;&#160;&#160;10000</td></tr>
<tr class="separator:a08a1bae2da6cab801ece1025a260b1b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2fb6650e86add1d5b6f02ed4625d13"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(a)&#160;&#160;&#160;info-&gt;a = (int) tmp_info.a;</td></tr>
<tr class="separator:a3e2fb6650e86add1d5b6f02ed4625d13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65409d904781e5a23529bd6bef2b673"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#ac65409d904781e5a23529bd6bef2b673">SOL_TCP</a>&#160;&#160;&#160;IPPROTO_TCP</td></tr>
<tr class="separator:ac65409d904781e5a23529bd6bef2b673"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0a01949c50bc8128d13198fce302a021"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a0a01949c50bc8128d13198fce302a021">add_report</a> (struct <a class="el" href="structreport.html">report</a> *<a class="el" href="structreport.html">report</a>)</td></tr>
<tr class="separator:a0a01949c50bc8128d13198fce302a021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66910f0d25743b5d85ddfb9069198aa4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a66910f0d25743b5d85ddfb9069198aa4">apply_extra_socket_options</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:a66910f0d25743b5d85ddfb9069198aa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9500ea675164d127b00aaaed439b09d"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#ae9500ea675164d127b00aaaed439b09d">daemon_main</a> (void *ptr __attribute__((unused)))</td></tr>
<tr class="separator:ae9500ea675164d127b00aaaed439b09d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4271388fd018c3d910e4839b3747df96"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">dispatch_request</a> (struct <a class="el" href="structrequest.html">request</a> *<a class="el" href="structrequest.html">request</a>, int type)</td></tr>
<tr class="memdesc:a4271388fd018c3d910e4839b3747df96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispatch a request to daemon loop.  <a href="daemon_8c.html#a4271388fd018c3d910e4839b3747df96">More...</a><br /></td></tr>
<tr class="separator:a4271388fd018c3d910e4839b3747df96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19814f177a4fae8c2aa668ce99361bad"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a19814f177a4fae8c2aa668ce99361bad">flow_block_scheduled</a> (struct timespec *now, struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:a19814f177a4fae8c2aa668ce99361bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b81f4cc8f5217b1d4ffa4a437377429"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, const char *fmt,...)</td></tr>
<tr class="separator:a2b81f4cc8f5217b1d4ffa4a437377429"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76e143faa3209e1a2cc97ddbfc7cba59"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a76e143faa3209e1a2cc97ddbfc7cba59">flow_in_delay</a> (struct timespec *now, struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, int direction)</td></tr>
<tr class="separator:a76e143faa3209e1a2cc97ddbfc7cba59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a842c9355b4c0c828fdae26b790006a19"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a842c9355b4c0c828fdae26b790006a19">flow_sending</a> (struct timespec *now, struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, int direction)</td></tr>
<tr class="separator:a842c9355b4c0c828fdae26b790006a19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1c880d68d8e730eaf7836e3883b6fbf"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structreport.html">report</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#ae1c880d68d8e730eaf7836e3883b6fbf">get_reports</a> (int *has_more)</td></tr>
<tr class="separator:ae1c880d68d8e730eaf7836e3883b6fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad037eac03b0881ffc9647c45daff87f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#ad037eac03b0881ffc9647c45daff87f5">get_tcp_info</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, struct <a class="el" href="structfg__tcp__info.html">fg_tcp_info</a> *info)</td></tr>
<tr class="separator:ad037eac03b0881ffc9647c45daff87f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af02359addacb39f08b62d85d0dc38ed8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#af02359addacb39f08b62d85d0dc38ed8">get_uuid_string</a> (char *uuid_str)</td></tr>
<tr class="memdesc:af02359addacb39f08b62d85d0dc38ed8"><td class="mdescLeft">&#160;</td><td class="mdescRight">To generate daemon UUID.  <a href="daemon_8c.html#af02359addacb39f08b62d85d0dc38ed8">More...</a><br /></td></tr>
<tr class="separator:af02359addacb39f08b62d85d0dc38ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22c94b0d420c70aec0021a94511684c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a22c94b0d420c70aec0021a94511684c9">init_flow</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, int is_source)</td></tr>
<tr class="memdesc:a22c94b0d420c70aec0021a94511684c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">To initialize all flows to the default value.  <a href="daemon_8c.html#a22c94b0d420c70aec0021a94511684c9">More...</a><br /></td></tr>
<tr class="separator:a22c94b0d420c70aec0021a94511684c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69bcdf37a6bd08046dc8f0fd3fee8d6a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a69bcdf37a6bd08046dc8f0fd3fee8d6a">prepare_fds</a> ()</td></tr>
<tr class="separator:a69bcdf37a6bd08046dc8f0fd3fee8d6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ceff22a02b22f3826a753ad12b102e7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a0ceff22a02b22f3826a753ad12b102e7">prepare_rfds</a> (struct timespec *now, struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, fd_set *<a class="el" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>)</td></tr>
<tr class="separator:a0ceff22a02b22f3826a753ad12b102e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a8247c715e328e3bc0b2d781c5a6b1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a74a8247c715e328e3bc0b2d781c5a6b1">prepare_wfds</a> (struct timespec *now, struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, fd_set *<a class="el" href="daemon_8c.html#a6391a90ddf873c2555b842a474fb9309">wfds</a>)</td></tr>
<tr class="separator:a74a8247c715e328e3bc0b2d781c5a6b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6457b4c850a146e92e6d9c3556306b5d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a6457b4c850a146e92e6d9c3556306b5d">process_delay</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:a6457b4c850a146e92e6d9c3556306b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54c3849a22e7bc35672dd1e04c34f5fc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a54c3849a22e7bc35672dd1e04c34f5fc">process_iat</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:a54c3849a22e7bc35672dd1e04c34f5fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc7b750d30fa56acd31644f53be03ca5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#abc7b750d30fa56acd31644f53be03ca5">process_requests</a> ()</td></tr>
<tr class="memdesc:abc7b750d30fa56acd31644f53be03ca5"><td class="mdescLeft">&#160;</td><td class="mdescRight">To process the request issued from the controller.  <a href="daemon_8c.html#abc7b750d30fa56acd31644f53be03ca5">More...</a><br /></td></tr>
<tr class="separator:abc7b750d30fa56acd31644f53be03ca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f3ff8ee35a524d84af02768849f3673"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a9f3ff8ee35a524d84af02768849f3673">process_rtt</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:a9f3ff8ee35a524d84af02768849f3673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f781d43f485b8fc44f0374bfd0b0a90"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a1f781d43f485b8fc44f0374bfd0b0a90">process_select</a> (fd_set *<a class="el" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>, fd_set *<a class="el" href="daemon_8c.html#a6391a90ddf873c2555b842a474fb9309">wfds</a>, fd_set *<a class="el" href="daemon_8c.html#a23eda314be657f32cde94fc43a19a6d7">efds</a>)</td></tr>
<tr class="separator:a1f781d43f485b8fc44f0374bfd0b0a90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f0a3334efe08cf776194c1c394cdce2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a2f0a3334efe08cf776194c1c394cdce2">read_data</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:a2f0a3334efe08cf776194c1c394cdce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6736f2aabb00598230614cdc3ec1a76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#aa6736f2aabb00598230614cdc3ec1a76">remove_flow</a> (struct <a class="el" href="structflow.html">flow</a> *const <a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:aa6736f2aabb00598230614cdc3ec1a76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18d77e6b65b799ff7229768b64c4aad9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">report_flow</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, int type)</td></tr>
<tr class="memdesc:a18d77e6b65b799ff7229768b64c4aad9"><td class="mdescLeft">&#160;</td><td class="mdescRight">To prepare a report, report type is either INTERVAL or FINAL.  <a href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">More...</a><br /></td></tr>
<tr class="separator:a18d77e6b65b799ff7229768b64c4aad9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace116bed071948dc1f66acc55607feb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a> (struct <a class="el" href="structrequest.html">request</a> *<a class="el" href="structrequest.html">request</a>, const char *fmt,...)</td></tr>
<tr class="separator:ace116bed071948dc1f66acc55607feb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5808c1a8a4f235184150b7fb30bc287"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#ae5808c1a8a4f235184150b7fb30bc287">send_response</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, int requested_response_block_size)</td></tr>
<tr class="separator:ae5808c1a8a4f235184150b7fb30bc287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa6483c8495b4df9665927f6ab4eaabb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#afa6483c8495b4df9665927f6ab4eaabb">set_flow_tcp_options</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:afa6483c8495b4df9665927f6ab4eaabb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59607f45dabe596ae017733d49caafb8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a59607f45dabe596ae017733d49caafb8">start_flows</a> (struct <a class="el" href="structrequest__start__flows.html">request_start_flows</a> *<a class="el" href="structrequest.html">request</a>)</td></tr>
<tr class="separator:a59607f45dabe596ae017733d49caafb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1f5aec48271ef6205d79be756decdc4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#aa1f5aec48271ef6205d79be756decdc4">stop_flow</a> (struct <a class="el" href="structrequest__stop__flow.html">request_stop_flow</a> *<a class="el" href="structrequest.html">request</a>)</td></tr>
<tr class="separator:aa1f5aec48271ef6205d79be756decdc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8bb1c94838c1b1156135080f0438faa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#af8bb1c94838c1b1156135080f0438faa">timer_check</a> ()</td></tr>
<tr class="separator:af8bb1c94838c1b1156135080f0438faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea7e1b0e3888d8d15f970c32e1ff290"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#afea7e1b0e3888d8d15f970c32e1ff290">try_read_n_bytes</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>, int bytes)</td></tr>
<tr class="separator:afea7e1b0e3888d8d15f970c32e1ff290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48bcab4c829140d6115c3b71e5c6ddc9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:a48bcab4c829140d6115c3b71e5c6ddc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab47d21199a51be6e1b9334d25049bd66"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#ab47d21199a51be6e1b9334d25049bd66">write_data</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="separator:ab47d21199a51be6e1b9334d25049bd66"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a114a7eaf522519c4b3efbefb5fc069cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a114a7eaf522519c4b3efbefb5fc069cf">daemon_pipe</a> [2]</td></tr>
<tr class="separator:a114a7eaf522519c4b3efbefb5fc069cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a00c14be1565cda838246a824529e42"><td class="memItemLeft" align="right" valign="top">pthread_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a6a00c14be1565cda838246a824529e42">daemon_thread</a></td></tr>
<tr class="separator:a6a00c14be1565cda838246a824529e42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e00b9f05b6a2247bb6c99ff3387a932"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a9e00b9f05b6a2247bb6c99ff3387a932">dump_dir</a></td></tr>
<tr class="separator:a9e00b9f05b6a2247bb6c99ff3387a932"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a016095bb5b1fadba7bc57d2a0d1a75f8"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a016095bb5b1fadba7bc57d2a0d1a75f8">dump_prefix</a></td></tr>
<tr class="separator:a016095bb5b1fadba7bc57d2a0d1a75f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23eda314be657f32cde94fc43a19a6d7"><td class="memItemLeft" align="right" valign="top">fd_set&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a23eda314be657f32cde94fc43a19a6d7">efds</a></td></tr>
<tr class="separator:a23eda314be657f32cde94fc43a19a6d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404ebcfc5a80e668901703c46a807157"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlinked__list.html">linked_list</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a></td></tr>
<tr class="separator:a404ebcfc5a80e668901703c46a807157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a13a361801dcc59ce4946736fa26726"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a7a13a361801dcc59ce4946736fa26726">maxfd</a></td></tr>
<tr class="separator:a7a13a361801dcc59ce4946736fa26726"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4acff8232e4aec9cd5c6dc200ac55ef3"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a></td></tr>
<tr class="separator:a4acff8232e4aec9cd5c6dc200ac55ef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33febb18ddf50438a47e5eee54be6c77"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a> = 0</td></tr>
<tr class="separator:a33febb18ddf50438a47e5eee54be6c77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5981029394ee67ad583f0319dc9468b5"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structreport.html">report</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a> = 0</td></tr>
<tr class="separator:a5981029394ee67ad583f0319dc9468b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dd776b27a8695d29a8f178ddb26a2eb"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structreport.html">report</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a> = 0</td></tr>
<tr class="separator:a7dd776b27a8695d29a8f178ddb26a2eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa94c4a05963e33561e701944c82d645"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structrequest.html">request</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a> = 0</td></tr>
<tr class="separator:aaa94c4a05963e33561e701944c82d645"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c8ad0b474e5da9a984f42d401e58d9c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structrequest.html">request</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a5c8ad0b474e5da9a984f42d401e58d9c">requests_last</a> = 0</td></tr>
<tr class="separator:a5c8ad0b474e5da9a984f42d401e58d9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66342c63e01fe543ed20793f32385f7e"><td class="memItemLeft" align="right" valign="top">fd_set&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a></td></tr>
<tr class="separator:a66342c63e01fe543ed20793f32385f7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22822755789d0770b81f031d467cd6e4"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a22822755789d0770b81f031d467cd6e4">started</a> = 0</td></tr>
<tr class="separator:a22822755789d0770b81f031d467cd6e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6391a90ddf873c2555b842a474fb9309"><td class="memItemLeft" align="right" valign="top">fd_set&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="daemon_8c.html#a6391a90ddf873c2555b842a474fb9309">wfds</a></td></tr>
<tr class="separator:a6391a90ddf873c2555b842a474fb9309"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines used by the Flowgrind daemon. </p>

<p class="definition">Definition in file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a08a1bae2da6cab801ece1025a260b1b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08a1bae2da6cab801ece1025a260b1b1">&#9670;&nbsp;</a></span>CONGESTION_LIMIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONGESTION_LIMIT&#160;&#160;&#160;10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00085">85</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a3e2fb6650e86add1d5b6f02ed4625d13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e2fb6650e86add1d5b6f02ed4625d13">&#9670;&nbsp;</a></span>CPY_INFO_MEMBER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPY_INFO_MEMBER</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a</td><td>)</td>
          <td>&#160;&#160;&#160;info-&gt;a = (int) tmp_info.a;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac65409d904781e5a23529bd6bef2b673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac65409d904781e5a23529bd6bef2b673">&#9670;&nbsp;</a></span>SOL_TCP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOL_TCP&#160;&#160;&#160;IPPROTO_TCP</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00078">78</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0a01949c50bc8128d13198fce302a021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a01949c50bc8128d13198fce302a021">&#9670;&nbsp;</a></span>add_report()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void add_report </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structreport.html">report</a> *&#160;</td>
          <td class="paramname"><em>report</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00827">827</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;{</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;add_report trying to lock mutex&quot;</span>);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        pthread_mutex_lock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;add_report aquired mutex&quot;</span>);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="comment">/* Do not keep too much data */</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a> &gt;= 250 &amp;&amp; <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a> != <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>) {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                free(<a class="code" href="structreport.html">report</a>);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                pthread_mutex_unlock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a> = 0;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a>)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                <a class="code" href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a>-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a> = <a class="code" href="structreport.html">report</a>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a> = <a class="code" href="structreport.html">report</a>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <a class="code" href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a> = <a class="code" href="structreport.html">report</a>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <a class="code" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a>++;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        pthread_mutex_unlock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;add_report unlocked mutex&quot;</span>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a66910f0d25743b5d85ddfb9069198aa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66910f0d25743b5d85ddfb9069198aa4">&#9670;&nbsp;</a></span>apply_extra_socket_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int apply_extra_socket_options </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01378">1378</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;{</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">num_extra_socket_options</a>; i++) {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                <span class="keywordtype">int</span> level, res;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                <span class="keyword">const</span> <span class="keyword">struct </span>extra_socket_options *option =</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                        &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a44ef35fc53d7df357f7de2e851694273">extra_socket_options</a>[i];</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                <span class="keywordflow">switch</span> (option-&gt;level) {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5a4408646d55b725feed6715de7902ebf4">level_sol_socket</a>:</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                        level = SOL_SOCKET;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5a091198499b13ce6a4672143fbea3527e">level_sol_tcp</a>:</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                        level = <a class="code" href="daemon_8c.html#ac65409d904781e5a23529bd6bef2b673">SOL_TCP</a>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5acadbb25555e5ecf1657bd5fee1b41e66">level_ipproto_ip</a>:</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                        level = IPPROTO_IP;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5a36587752a2be3a063f382c0997e8f36e">level_ipproto_sctp</a>:</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                        level = IPPROTO_SCTP;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5afa8fd18ddb40f762f6a278f50f0f8d50">level_ipproto_tcp</a>:</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                        level = IPPROTO_TCP;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5a9e88880373e101d2c96f2beb55b72364">level_ipproto_udp</a>:</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                        level = IPPROTO_UDP;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                        <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unknown socket option level: %d&quot;</span>,</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                                   option-&gt;level);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                }</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                res = setsockopt(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, level, option-&gt;optname,</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                                 option-&gt;optval, option-&gt;optlen);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                <span class="keywordflow">if</span> (res == -1) {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                        <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set socket option %d: %s&quot;</span>,</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                                   option-&gt;optname, strerror(errno));</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        }</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9500ea675164d127b00aaaed439b09d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9500ea675164d127b00aaaed439b09d">&#9670;&nbsp;</a></span>daemon_main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* daemon_main </td>
          <td>(</td>
          <td class="paramtype">void *ptr &#160;</td>
          <td class="paramname"><em>__attribute__</em>(unused)</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00800">800</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;{</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keyword">struct </span>timespec timeout;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <span class="keywordtype">int</span> need_timeout = <a class="code" href="daemon_8c.html#a69bcdf37a6bd08046dc8f0fd3fee8d6a">prepare_fds</a>();</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                timeout.tv_sec = 0;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                timeout.tv_nsec = <a class="code" href="daemon_8h.html#a518951727d690b29538e702125381488">DEFAULT_SELECT_TIMEOUT</a>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;calling pselect() need_timeout: %i&quot;</span>,</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                          need_timeout);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                <span class="keywordtype">int</span> rc = pselect(<a class="code" href="daemon_8c.html#a7a13a361801dcc59ce4946736fa26726">maxfd</a> + 1, &amp;<a class="code" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>, &amp;<a class="code" href="daemon_8c.html#a6391a90ddf873c2555b842a474fb9309">wfds</a>, &amp;<a class="code" href="daemon_8c.html#a23eda314be657f32cde94fc43a19a6d7">efds</a>,</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                 need_timeout ? &amp;timeout : 0, NULL);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <span class="keywordflow">if</span> (rc &lt; 0) {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                        <span class="keywordflow">if</span> (errno == EINTR)</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                        <a class="code" href="fg__error_8h.html#abe3691984c9be3f886d23938335ea8a1">crit</a>(<span class="stringliteral">&quot;pselect() failed&quot;</span>);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;pselect() finished&quot;</span>);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                <span class="keywordflow">if</span> (FD_ISSET(<a class="code" href="daemon_8c.html#a114a7eaf522519c4b3efbefb5fc069cf">daemon_pipe</a>[0], &amp;<a class="code" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>))</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                        <a class="code" href="daemon_8c.html#abc7b750d30fa56acd31644f53be03ca5">process_requests</a>();</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                <a class="code" href="daemon_8c.html#af8bb1c94838c1b1156135080f0438faa">timer_check</a>();</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                <a class="code" href="daemon_8c.html#a1f781d43f485b8fc44f0374bfd0b0a90">process_select</a>(&amp;<a class="code" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>, &amp;<a class="code" href="daemon_8c.html#a6391a90ddf873c2555b842a474fb9309">wfds</a>, &amp;<a class="code" href="daemon_8c.html#a23eda314be657f32cde94fc43a19a6d7">efds</a>);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4271388fd018c3d910e4839b3747df96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4271388fd018c3d910e4839b3747df96">&#9670;&nbsp;</a></span>dispatch_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dispatch_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrequest.html">request</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispatch a request to daemon loop. </p>
<p>Is called by the rpc server to feed in requests to the daemon. </p>

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01489">1489</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;{</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        pthread_cond_t cond;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a> = NULL;</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#a76afbbb7cbf4b0627459b37b75062b40">type</a> = type;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#a37274d635f4592bd537b14b1956bde52">next</a> = NULL;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        <span class="comment">/* Create synchronization mutex */</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <span class="keywordflow">if</span> (pthread_cond_init(&amp;cond, NULL)) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                <a class="code" href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a>(<a class="code" href="structrequest.html">request</a>, <span class="stringliteral">&quot;Could not create synchronization mutex&quot;</span>);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#adf85beff9f9a1191e2c9985fde174282">condition</a> = &amp;cond;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160; </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        pthread_mutex_lock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; </div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a>) {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                <a class="code" href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a> = <a class="code" href="structrequest.html">request</a>;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                <a class="code" href="daemon_8c.html#a5c8ad0b474e5da9a984f42d401e58d9c">requests_last</a> = <a class="code" href="structrequest.html">request</a>;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                <a class="code" href="daemon_8c.html#a5c8ad0b474e5da9a984f42d401e58d9c">requests_last</a>-&gt;<a class="code" href="structrequest.html#a37274d635f4592bd537b14b1956bde52">next</a> = <a class="code" href="structrequest.html">request</a>;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                <a class="code" href="daemon_8c.html#a5c8ad0b474e5da9a984f42d401e58d9c">requests_last</a> = <a class="code" href="structrequest.html">request</a>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="keywordflow">if</span> (write(<a class="code" href="daemon_8c.html#a114a7eaf522519c4b3efbefb5fc069cf">daemon_pipe</a>[1], &amp;type, 1) != 1) <span class="comment">/* Doesn&#39;t matter what we write */</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="comment">/* Wait until the daemon thread has processed the request */</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        pthread_cond_wait(&amp;cond, &amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        pthread_mutex_unlock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a19814f177a4fae8c2aa668ce99361bad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19814f177a4fae8c2aa668ce99361bad">&#9670;&nbsp;</a></span>flow_block_scheduled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int flow_block_scheduled </td>
          <td>(</td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00160">160</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="fg__time_8c.html#a801431f54cf89b9f658e3e29b2bba0fe">time_is_after</a>(now, &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a30e6464cf5e91f15049297e4452d120e">next_write_block_timestamp</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b81f4cc8f5217b1d4ffa4a437377429"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b81f4cc8f5217b1d4ffa4a437377429">&#9670;&nbsp;</a></span>flow_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flow_error </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00119">119</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordtype">char</span> str[1000];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        va_list ap;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        va_start(ap, fmt);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        vsnprintf(str, 1000, fmt, ap);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        va_end(ap);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        str[<span class="keyword">sizeof</span>(str) - 1] = 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a> = malloc(strlen(str) + 1);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        strcpy(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a>, str);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a76e143faa3209e1a2cc97ddbfc7cba59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76e143faa3209e1a2cc97ddbfc7cba59">&#9670;&nbsp;</a></span>flow_in_delay()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int flow_in_delay </td>
          <td>(</td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00145">145</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="fg__time_8c.html#a801431f54cf89b9f658e3e29b2bba0fe">time_is_after</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa1cfbf41ded33437a919e4ec1a7eb0c0">start_timestamp</a>[direction], now);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a842c9355b4c0c828fdae26b790006a19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a842c9355b4c0c828fdae26b790006a19">&#9670;&nbsp;</a></span>flow_sending()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int flow_sending </td>
          <td>(</td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00152">152</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;{</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">return</span> !<a class="code" href="daemon_8c.html#a76e143faa3209e1a2cc97ddbfc7cba59">flow_in_delay</a>(now, <a class="code" href="structflow.html">flow</a>, direction) &amp;&amp;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[direction] &lt; 0 ||</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                 <a class="code" href="fg__time_8c.html#a255d1a882171eae755af0936c3d78951">time_diff_now</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a9a3f07a95a7e900577be6067ccd0779d">stop_timestamp</a>[direction]) &lt; 0.0);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1c880d68d8e730eaf7836e3883b6fbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1c880d68d8e730eaf7836e3883b6fbf">&#9670;&nbsp;</a></span>get_reports()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structreport.html">report</a>* get_reports </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>has_more</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00853">853</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;{</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_reports = 50;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keyword">struct </span><a class="code" href="structreport.html">report</a>* ret;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;get_reports trying to lock mutex&quot;</span>);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        pthread_mutex_lock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;get_reports aquired mutex&quot;</span>);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        ret = <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a> &lt;= max_reports) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                *has_more = 0;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                <a class="code" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a> = 0;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a> = NULL;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                <a class="code" href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a> = 0;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <span class="comment">/* Split off first 50 items */</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                <span class="keyword">struct </span><a class="code" href="structreport.html">report</a>* tmp;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; max_reports - 1; i++)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                        <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a> = <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a>-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                tmp = <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a>-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a>-&gt;<a class="code" href="structreport.html#a0a3773754225984337b3363320143e6e">next</a> = 0;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                <a class="code" href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a> = tmp;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                <a class="code" href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a> -= max_reports;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                *has_more = 1;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        pthread_mutex_unlock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;get_reports unlocked mutex&quot;</span>);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad037eac03b0881ffc9647c45daff87f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad037eac03b0881ffc9647c45daff87f5">&#9670;&nbsp;</a></span>get_tcp_info()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int get_tcp_info </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structfg__tcp__info.html">fg_tcp_info</a> *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>FreeBSD 9.1 doesn't fill these members, but maybe FreeBSD 10.0 will fill it, so get rid of this ifdef </dd></dl>

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00650">650</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;{</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="preprocessor">#ifdef HAVE_TCP_INFO</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keyword">struct </span>tcp_info tmp_info;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        socklen_t info_len = <span class="keyword">sizeof</span>(tmp_info);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        memset(info, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structfg__tcp__info.html">fg_tcp_info</a>));</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        rc = getsockopt(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, IPPROTO_TCP, TCP_INFO, &amp;tmp_info, &amp;info_len);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span> (rc == -1) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <a class="code" href="fg__error_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;getsockopt() failed&quot;</span>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="preprocessor">        #define CPY_INFO_MEMBER(a) info-&gt;a = (int) tmp_info.a;</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_snd_cwnd);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_snd_ssthresh);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_rtt);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_rttvar);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_rto);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_snd_mss);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="comment">/* TODO FreeBSD 9.1 doesn&#39;t fill these members, but maybe FreeBSD 10.0</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">         * will fill it, so get rid of this ifdef */</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="preprocessor">#ifdef __LINUX__</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_backoff);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_unacked);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_sacked);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_lost);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_retrans);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_retransmits);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_fackets);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_reordering);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <a class="code" href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a>(tcpi_ca_state);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* __LINUX__ */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* HAVE_TCP_INFO */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        memset(info, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structfg__tcp__info.html">fg_tcp_info</a>));</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_TCP_INFO */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af02359addacb39f08b62d85d0dc38ed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af02359addacb39f08b62d85d0dc38ed8">&#9670;&nbsp;</a></span>get_uuid_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_uuid_string </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>uuid_str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To generate daemon UUID. </p>
<p>Generate the daemon UUID and convert the UUID to a string data. UUID is generated by daemon only once and stored in the global variable. The daemon return the same UUID for all the flows it maintaining. This UUID is taken as a reference to identify the daemon in the controller.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">uuid_str</td><td>daemons UUID </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01536">1536</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;{</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        uuid_t uuid;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">char</span> server_uuid[38] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <span class="keywordflow">if</span> (!strlen(server_uuid)) {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                uuid_generate_time(uuid);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                uuid_unparse(uuid,uuid_str);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                memset(server_uuid,0,<span class="keyword">sizeof</span>(server_uuid));</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                strcpy(server_uuid,uuid_str);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        strcpy(uuid_str,server_uuid);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a22c94b0d420c70aec0021a94511684c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22c94b0d420c70aec0021a94511684c9">&#9670;&nbsp;</a></span>init_flow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_flow </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To initialize all flows to the default value. </p>
<p>The daemon maintain all its data in its <code>flow</code> statistics data structure. These data are initialize to the default value or zero value according to their metrics details.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flow</td><td>flow structure maintained by a daemon </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">is_source</td><td>to determine flow endpoint i.e. source or destination </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00896">896</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;{</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        memset(<a class="code" href="structflow.html">flow</a>, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structflow.html">flow</a>));</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="comment">/* flow id is given by controller */</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a> = -1;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4f2eda16bd6129bc3057fa38b080a486">endpoint</a> = is_source ? <a class="code" href="common_8h.html#a60678bfaa9744c8078a4e317ba203ec0a0159491ea913604389155db907e0d1c0">SOURCE</a> : <a class="code" href="common_8h.html#a60678bfaa9744c8078a4e317ba203ec0a22f853bba9ebb23d90508dc6496b746c">DESTINATION</a>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ab7176e838d97cf4f2e2df0fe8ca31baa">state</a> = is_source ? <a class="code" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c">GRIND_WAIT_CONNECT</a> : <a class="code" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a30e50ffb173bb9b94042b020c00308a8">GRIND_WAIT_ACCEPT</a>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a> = -1;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a17fe9a16d079930fa345a6fc635fa1da">listenfd_data</a> = -1;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa80c2bfdd1a4f5a65d30b97c94e3cd88">current_read_block_size</a> = <a class="code" href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#afa482adb3d3445e276a009a895bd3dda">current_write_block_size</a> = <a class="code" href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>] = 0;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a65aa5ef64b2308b297a95c1160200fdc">addr</a> = 0;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a836b134622386d1fc94becbcc117cb32">bytes_read</a> = 0;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a80c710aaf10a41c6a467d34bd9bac81d">bytes_written</a> = 0;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a8e6173d615bbb6ab389b160e182b429d">request_blocks_read</a> = 0;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#ae760d10eb27eae961db503b03b693fd7">request_blocks_written</a> = 0;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#ac793e3ec0a05b118580c17b4f8086c2d">response_blocks_read</a> = 0;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a4f102ee40bfd0fcfe231aac54554787d">response_blocks_written</a> = 0;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a3b4ab703ab22b6192777b859553a3594">rtt_min</a> = FLT_MAX;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#ae1ba3445791589ef501eb765bd808665">rtt_max</a> = FLT_MIN;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#ab88cf17f8060108b739b572c66bcac10">rtt_sum</a> = 0.0F;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#aaac45192612b658846d6a0307e6bce43">iat_min</a> = FLT_MAX;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#aff32ca848eebe991a7a8cf56bf153288">iat_max</a> = FLT_MIN;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#ae55bad583676234bb11d6508222b7491">iat_sum</a> = 0.0F;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a9319c44e2e7e5cb5e396e118fe5fc7f9">delay_min</a> = FLT_MAX;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a44935f0f8dda8fa73b41a1b49f4c2e96">delay_max</a> = FLT_MIN;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a2a591497f98ee2a3aa172808f1db2699">delay_sum</a> = 0.0F;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_NOTICE, <span class="stringliteral">&quot;called init flow %d&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a69bcdf37a6bd08046dc8f0fd3fee8d6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69bcdf37a6bd08046dc8f0fd3fee8d6a">&#9670;&nbsp;</a></span>prepare_fds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int prepare_fds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00267">267</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                         {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;prepare_fds() called, number of flows: %zu&quot;</span>,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                  <a class="code" href="fg__list_8c.html#a4f790759b24f1f5d4e5867383d4dd0ad">fg_list_size</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        FD_ZERO(&amp;<a class="code" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        FD_ZERO(&amp;<a class="code" href="daemon_8c.html#a6391a90ddf873c2555b842a474fb9309">wfds</a>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        FD_ZERO(&amp;<a class="code" href="daemon_8c.html#a23eda314be657f32cde94fc43a19a6d7">efds</a>);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        FD_SET(<a class="code" href="daemon_8c.html#a114a7eaf522519c4b3efbefb5fc069cf">daemon_pipe</a>[0], &amp;<a class="code" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <a class="code" href="daemon_8c.html#a7a13a361801dcc59ce4946736fa26726">maxfd</a> = <a class="code" href="daemon_8c.html#a114a7eaf522519c4b3efbefb5fc069cf">daemon_pipe</a>[0];</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keyword">struct </span>timespec now;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;now);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlist__node.html">list_node</a> *node = <a class="code" href="fg__list_8c.html#a7b1316612a89d2df33e3be100fb1e797">fg_list_front</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">while</span> (node) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="keyword">struct </span><a class="code" href="structflow.html">flow</a> *<a class="code" href="structflow.html">flow</a> = node-&gt;<a class="code" href="structlist__node.html#aaa55c3480c90432991e01545b6ff34b5">data</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                node = node-&gt;<a class="code" href="structlist__node.html#a0b99ca890dbfe832a8475f4bbd72338c">next</a>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a22822755789d0770b81f031d467cd6e4">started</a> &amp;&amp;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] ||</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                     !<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] ||</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                     (!<a class="code" href="daemon_8c.html#a76e143faa3209e1a2cc97ddbfc7cba59">flow_in_delay</a>(&amp;now, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>) &amp;&amp;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                      !<a class="code" href="daemon_8c.html#a842c9355b4c0c828fdae26b790006a19">flow_sending</a>(&amp;now, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>))) &amp;&amp;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>] ||</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                     !<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>] ||</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                     (!<a class="code" href="daemon_8c.html#a76e143faa3209e1a2cc97ddbfc7cba59">flow_in_delay</a>(&amp;now, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>) &amp;&amp;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                      !<a class="code" href="daemon_8c.html#a842c9355b4c0c828fdae26b790006a19">flow_sending</a>(&amp;now, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>)))) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                        <span class="comment">/* On Other OSes than Linux or FreeBSD, tcp_info will contain all zeroes */</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>].<a class="code" href="structflow_1_1statistics.html#aec0e10ce5d0c7205464fcd0ffad8c232">has_tcp_info</a> =</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                <a class="code" href="daemon_8c.html#ad037eac03b0881ffc9647c45daff87f5">get_tcp_info</a>(<a class="code" href="structflow.html">flow</a>,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                             &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>].<a class="code" href="structflow_1_1statistics.html#a7522f70d387cfd231efd047d7310d721">tcp_info</a>)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                        ? 0 : 1;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a94e826d731af3ce59414ab483ff3e4f7">pmtu</a> = <a class="code" href="fg__socket_8c.html#abeb6cde31aa19f818745d2bffed938b4">get_pmtu</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">reporting_interval</a>)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                <a class="code" href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">report_flow</a>(<a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                        <a class="code" href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">report_flow</a>(<a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                        <a class="code" href="daemon_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                        <a class="code" href="daemon_8c.html#aa6736f2aabb00598230614cdc3ec1a76">remove_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ab7176e838d97cf4f2e2df0fe8ca31baa">state</a> == <a class="code" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a30e50ffb173bb9b94042b020c00308a8">GRIND_WAIT_ACCEPT</a> &amp;&amp;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a17fe9a16d079930fa345a6fc635fa1da">listenfd_data</a> != -1) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                        FD_SET(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a17fe9a16d079930fa345a6fc635fa1da">listenfd_data</a>, &amp;<a class="code" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                        <a class="code" href="daemon_8c.html#a7a13a361801dcc59ce4946736fa26726">maxfd</a> = MAX(<a class="code" href="daemon_8c.html#a7a13a361801dcc59ce4946736fa26726">maxfd</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a17fe9a16d079930fa345a6fc635fa1da">listenfd_data</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="daemon_8c.html#a22822755789d0770b81f031d467cd6e4">started</a>)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a> != -1) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                        FD_SET(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, &amp;<a class="code" href="daemon_8c.html#a23eda314be657f32cde94fc43a19a6d7">efds</a>);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                        <a class="code" href="daemon_8c.html#a7a13a361801dcc59ce4946736fa26726">maxfd</a> = MAX(<a class="code" href="daemon_8c.html#a7a13a361801dcc59ce4946736fa26726">maxfd</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                        <a class="code" href="daemon_8c.html#a74a8247c715e328e3bc0b2d781c5a6b1">prepare_wfds</a>(&amp;now, <a class="code" href="structflow.html">flow</a>, &amp;<a class="code" href="daemon_8c.html#a6391a90ddf873c2555b842a474fb9309">wfds</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                        <a class="code" href="daemon_8c.html#a0ceff22a02b22f3826a753ad12b102e7">prepare_rfds</a>(&amp;now, <a class="code" href="structflow.html">flow</a>, &amp;<a class="code" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="fg__list_8c.html#a4f790759b24f1f5d4e5867383d4dd0ad">fg_list_size</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ceff22a02b22f3826a753ad12b102e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ceff22a02b22f3826a753ad12b102e7">&#9670;&nbsp;</a></span>prepare_rfds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int prepare_rfds </td>
          <td>(</td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&#160;</td>
          <td class="paramname"><em>rfds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00233">233</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;{</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="daemon_8c.html#a76e143faa3209e1a2cc97ddbfc7cba59">flow_in_delay</a>(now, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>) &amp;&amp; !<a class="code" href="daemon_8c.html#a842c9355b4c0c828fdae26b790006a19">flow_sending</a>(now, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>)) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] &amp;&amp; <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a58ee2ce95a7ee3b8d2a06f3a55ccaf07">shutdown</a>) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                        <a class="code" href="fg__error_8h.html#ae6cfebfa20e754bd09c394f8bd07f624">warnx</a>(<span class="stringliteral">&quot;server flow %u missed to shutdown&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        rc = shutdown(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, SHUT_RD);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                        <span class="keywordflow">if</span> (rc == -1)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                <a class="code" href="fg__error_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;shutdown SHUT_RD failed&quot;</span>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] = 1;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a79abf940bb0e1fbdf027152aa00ba51a">source_settings</a>.<a class="code" href="structflow__source__settings.html#a6e94ce54173e1dfc09a560894ed2b3c3">late_connect</a> &amp;&amp; !<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a116b10ed1d681c8b889f0417ae4aafe4">connect_called</a> ) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_ERR, <span class="stringliteral">&quot;late connecting test socket for flow %d &quot;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                          <span class="stringliteral">&quot;after %.3fs delay&quot;</span>,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">delay</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>]);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="source_8c.html#a9cfb86590db53e435ca5bcf97b2dc945">do_connect</a>(<a class="code" href="structflow.html">flow</a>) == -1) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">/* Altough the server flow might be finished we keep the socket in</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">         * rfd in order to check for buggy servers */</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a116b10ed1d681c8b889f0417ae4aafe4">connect_called</a> &amp;&amp; !<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>]) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;adding sock of flow %d to rfds&quot;</span>,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                FD_SET(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a74a8247c715e328e3bc0b2d781c5a6b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74a8247c715e328e3bc0b2d781c5a6b1">&#9670;&nbsp;</a></span>prepare_wfds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void prepare_wfds </td>
          <td>(</td>
          <td class="paramtype">struct timespec *&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&#160;</td>
          <td class="paramname"><em>wfds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00199">199</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;{</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a76e143faa3209e1a2cc97ddbfc7cba59">flow_in_delay</a>(now, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>)) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;flow %i not started yet (delayed)&quot;</span>,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a842c9355b4c0c828fdae26b790006a19">flow_sending</a>(now, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>)) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                assert(!<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>]);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a19814f177a4fae8c2aa668ce99361bad">flow_block_scheduled</a>(now, <a class="code" href="structflow.html">flow</a>)) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;adding sock of flow %d to wfds&quot;</span>,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                        FD_SET(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="daemon_8c.html#a6391a90ddf873c2555b842a474fb9309">wfds</a>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;no block for flow %d scheduled &quot;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                  <span class="stringliteral">&quot;yet&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>]) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>] = 1;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a58ee2ce95a7ee3b8d2a06f3a55ccaf07">shutdown</a>) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;shutting down flow %d (WR)&quot;</span>,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                        rc = shutdown(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>,SHUT_WR);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                        <span class="keywordflow">if</span> (rc == -1)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                <a class="code" href="fg__error_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;shutdown() SHUT_WR failed&quot;</span>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6457b4c850a146e92e6d9c3556306b5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6457b4c850a146e92e6d9c3556306b5d">&#9670;&nbsp;</a></span>process_delay()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void process_delay </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01267">1267</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;{</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <span class="keywordtype">double</span> current_delay = .0;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="keyword">struct </span>timespec now;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <span class="keyword">struct </span>timespec *data = (<span class="keyword">struct </span>timespec *)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">read_block</a> + 2*(sizeof (int32_t)));</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;now);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        current_delay = <a class="code" href="fg__time_8c.html#a1ce08f00b1930420282aa6422ce66f24">time_diff</a>(data, &amp;now);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keywordflow">if</span> (current_delay &lt; 0) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_NOTICE, <span class="stringliteral">&quot;calculated malformed delay of flow &quot;</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                        <span class="stringliteral">&quot;%d (rtt = %.3lfms) (clocks out-of-sync?), ignoring&quot;</span>,</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, current_delay * 1e3);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                current_delay = NAN;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        }</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <span class="keywordflow">if</span> (!isnan(current_delay)) {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>) {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                        <a class="code" href="fg__definitions_8h.html#a5c2abadb7970717fd8339b059ddd3713">ASSIGN_MIN</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a9319c44e2e7e5cb5e396e118fe5fc7f9">delay_min</a>,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                   current_delay);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                        <a class="code" href="fg__definitions_8h.html#ad4cd7244516b51cb71cbbddaae881985">ASSIGN_MAX</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a44935f0f8dda8fa73b41a1b49f4c2e96">delay_max</a>,</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                                   current_delay);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a2a591497f98ee2a3aa172808f1db2699">delay_sum</a> += current_delay;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                }</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_NOTICE, <span class="stringliteral">&quot;processed delay of flow %d (%.3lfms)&quot;</span>,</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, current_delay * 1e3);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a54c3849a22e7bc35672dd1e04c34f5fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54c3849a22e7bc35672dd1e04c34f5fc">&#9670;&nbsp;</a></span>process_iat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void process_iat </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01234">1234</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;{</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="keywordtype">double</span> current_iat = .0;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keyword">struct </span>timespec now;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;now);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a55e06ae7dea1322b0da97d930e81e01f">last_block_read</a>.tv_sec ||</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a55e06ae7dea1322b0da97d930e81e01f">last_block_read</a>.tv_nsec)</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                current_iat = <a class="code" href="fg__time_8c.html#a1ce08f00b1930420282aa6422ce66f24">time_diff</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a55e06ae7dea1322b0da97d930e81e01f">last_block_read</a>, &amp;now);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                current_iat = NAN;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160; </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keywordflow">if</span> (current_iat &lt; 0) {</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_CRIT, <span class="stringliteral">&quot;calculated malformed iat of flow %d &quot;</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                        <span class="stringliteral">&quot;(iat = %.3lfms) (clock skew?), ignoring&quot;</span>,</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, current_iat * 1e3);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                current_iat = NAN;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a55e06ae7dea1322b0da97d930e81e01f">last_block_read</a> = now;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="keywordflow">if</span> (!isnan(current_iat)) {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>) {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                        <a class="code" href="fg__definitions_8h.html#a5c2abadb7970717fd8339b059ddd3713">ASSIGN_MIN</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#aaac45192612b658846d6a0307e6bce43">iat_min</a>, current_iat);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                        <a class="code" href="fg__definitions_8h.html#ad4cd7244516b51cb71cbbddaae881985">ASSIGN_MAX</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#aff32ca848eebe991a7a8cf56bf153288">iat_max</a>, current_iat);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#ae55bad583676234bb11d6508222b7491">iat_sum</a> += current_iat;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_NOTICE, <span class="stringliteral">&quot;processed IAT of flow %d (%.3lfms)&quot;</span>,</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, current_iat * 1e3);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abc7b750d30fa56acd31644f53be03ca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc7b750d30fa56acd31644f53be03ca5">&#9670;&nbsp;</a></span>process_requests()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void process_requests </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To process the request issued from the controller. </p>
<p>The daemon reads the request from the controller, and executes the issued request type from the controller. The daemons have separate data structure for each request type. </p>

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00446">446</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;{</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;process_requests trying to lock mutex&quot;</span>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        pthread_mutex_lock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;process_requests locked mutex&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordtype">char</span> tmp[100];</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="keywordtype">int</span> rc = read(<a class="code" href="daemon_8c.html#a114a7eaf522519c4b3efbefb5fc069cf">daemon_pipe</a>[0], tmp, 100);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <span class="keywordflow">if</span> (rc != 100)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a>) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <span class="keyword">struct </span><a class="code" href="structrequest.html">request</a>* <a class="code" href="structrequest.html">request</a> = <a class="code" href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <a class="code" href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a> = <a class="code" href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a>-&gt;<a class="code" href="structrequest.html#a37274d635f4592bd537b14b1956bde52">next</a>;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                rc = 0;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <span class="keywordflow">switch</span> (<a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#a76afbbb7cbf4b0627459b37b75062b40">type</a>) {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="daemon_8h.html#a1cb3dd3b58581d382be8492aba04511f">REQUEST_ADD_DESTINATION</a>:</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                        <a class="code" href="destination_8c.html#a5e221610bb1173dbb62d646a69c9b2fc">add_flow_destination</a>((<span class="keyword">struct</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                                <a class="code" href="structrequest__add__flow__destination.html">request_add_flow_destination</a></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                                *)<a class="code" href="structrequest.html">request</a>);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="daemon_8h.html#a3a11d078671d380e037fd310d4e614cd">REQUEST_ADD_SOURCE</a>:</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                        rc = <a class="code" href="fg__rpc__server_8c.html#a55fd54a0087dd0ac821433cbda1f65bd">add_flow_source</a>((<span class="keyword">struct</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                                <a class="code" href="structrequest__add__flow__source.html">request_add_flow_source</a></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                                *)<a class="code" href="structrequest.html">request</a>);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="daemon_8h.html#a03812c2ffe8d7c7ee20036c7ff10debb">REQUEST_START_FLOWS</a>:</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                        <a class="code" href="daemon_8c.html#a59607f45dabe596ae017733d49caafb8">start_flows</a>((<span class="keyword">struct</span> <a class="code" href="structrequest__start__flows.html">request_start_flows</a> *)<a class="code" href="structrequest.html">request</a>);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="daemon_8h.html#a3ce8d4ae1e4221490780ddcf1e48191c">REQUEST_STOP_FLOW</a>:</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                        <a class="code" href="daemon_8c.html#aa1f5aec48271ef6205d79be756decdc4">stop_flow</a>((<span class="keyword">struct</span> <a class="code" href="structrequest__stop__flow.html">request_stop_flow</a> *)<a class="code" href="structrequest.html">request</a>);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="daemon_8h.html#a98e181f48db2db4c7cbf28cde6f9232a">REQUEST_GET_STATUS</a>:</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                        {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                <span class="keyword">struct </span><a class="code" href="structrequest__get__status.html">request_get_status</a> *<a class="code" href="structrequest__get__status.html#abff36def99e64c89154a718058b1226c">r</a> =</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                        (<span class="keyword">struct </span><a class="code" href="structrequest__get__status.html">request_get_status</a> *)<a class="code" href="structrequest.html">request</a>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                <a class="code" href="structrequest__get__status.html#abff36def99e64c89154a718058b1226c">r</a>-&gt;started = <a class="code" href="daemon_8c.html#a22822755789d0770b81f031d467cd6e4">started</a>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                <a class="code" href="structrequest__get__status.html#abff36def99e64c89154a718058b1226c">r</a>-&gt;num_flows = <a class="code" href="fg__list_8c.html#a4f790759b24f1f5d4e5867383d4dd0ad">fg_list_size</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                        }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="daemon_8h.html#a7956881b57fbb4cf42cb60ce602c8313">REQUEST_GET_UUID</a>:</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                        {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                <span class="keyword">struct </span><a class="code" href="structrequest__get__uuid.html">request_get_uuid</a> *<a class="code" href="structrequest__get__uuid.html#a7738b09b8e9ab801adc04835cb573a3c">r</a> =</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                        (<span class="keyword">struct </span><a class="code" href="structrequest__get__uuid.html">request_get_uuid</a> *)<a class="code" href="structrequest.html">request</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                <a class="code" href="daemon_8c.html#af02359addacb39f08b62d85d0dc38ed8">get_uuid_string</a>(<a class="code" href="structrequest__get__uuid.html#a7738b09b8e9ab801adc04835cb573a3c">r</a>-&gt;server_uuid);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                        }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                        <a class="code" href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a>(<a class="code" href="structrequest.html">request</a>, <span class="stringliteral">&quot;Unknown request type&quot;</span>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                <span class="keywordflow">if</span> (rc != 1)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                        pthread_cond_signal(<a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#adf85beff9f9a1191e2c9985fde174282">condition</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        pthread_mutex_unlock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;process_requests unlocked mutex&quot;</span>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f3ff8ee35a524d84af02768849f3673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f3ff8ee35a524d84af02768849f3673">&#9670;&nbsp;</a></span>process_rtt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void process_rtt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01204">1204</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;{</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="keywordtype">double</span> current_rtt = .0;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="keyword">struct </span>timespec now;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="keyword">struct </span>timespec *data = (<span class="keyword">struct </span>timespec *)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">read_block</a> + 2*(sizeof (int32_t)));</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;now);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        current_rtt = <a class="code" href="fg__time_8c.html#a1ce08f00b1930420282aa6422ce66f24">time_diff</a>(data, &amp;now);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="keywordflow">if</span> (current_rtt &lt; 0) {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_CRIT, <span class="stringliteral">&quot;received malformed rtt block of flow %d &quot;</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                        <span class="stringliteral">&quot;(rtt = %.3lfms), ignoring&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, current_rtt * 1e3);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                current_rtt = NAN;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a55e06ae7dea1322b0da97d930e81e01f">last_block_read</a> = now;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <span class="keywordflow">if</span> (!isnan(current_rtt)) {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                        <a class="code" href="fg__definitions_8h.html#a5c2abadb7970717fd8339b059ddd3713">ASSIGN_MIN</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a3b4ab703ab22b6192777b859553a3594">rtt_min</a>, current_rtt);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                        <a class="code" href="fg__definitions_8h.html#ad4cd7244516b51cb71cbbddaae881985">ASSIGN_MAX</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#ae1ba3445791589ef501eb765bd808665">rtt_max</a>, current_rtt);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#ab88cf17f8060108b739b572c66bcac10">rtt_sum</a> += current_rtt;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_NOTICE, <span class="stringliteral">&quot;processed RTT of flow %d (%.3lfms)&quot;</span>,</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, current_rtt * 1e3);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f781d43f485b8fc44f0374bfd0b0a90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f781d43f485b8fc44f0374bfd0b0a90">&#9670;&nbsp;</a></span>process_select()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void process_select </td>
          <td>(</td>
          <td class="paramtype">fd_set *&#160;</td>
          <td class="paramname"><em>rfds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&#160;</td>
          <td class="paramname"><em>wfds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fd_set *&#160;</td>
          <td class="paramname"><em>efds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00729">729</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;{</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlist__node.html">list_node</a> *node = <a class="code" href="fg__list_8c.html#a7b1316612a89d2df33e3be100fb1e797">fg_list_front</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">while</span> (node) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="keyword">struct </span><a class="code" href="structflow.html">flow</a> *<a class="code" href="structflow.html">flow</a> = node-&gt;<a class="code" href="structlist__node.html#aaa55c3480c90432991e01545b6ff34b5">data</a>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                node = node-&gt;<a class="code" href="structlist__node.html#a0b99ca890dbfe832a8475f4bbd72338c">next</a>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;processing pselect() for flow %d&quot;</span>,</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a17fe9a16d079930fa345a6fc635fa1da">listenfd_data</a> != -1 &amp;&amp;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                    FD_ISSET(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a17fe9a16d079930fa345a6fc635fa1da">listenfd_data</a>, <a class="code" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>)) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;ready for accept&quot;</span>);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ab7176e838d97cf4f2e2df0fe8ca31baa">state</a> == <a class="code" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a30e50ffb173bb9b94042b020c00308a8">GRIND_WAIT_ACCEPT</a>) {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="destination_8c.html#aedc02107b0adf6f93c12f27e4858582b">accept_data</a>(<a class="code" href="structflow.html">flow</a>) == -1) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_ERR, <span class="stringliteral">&quot;accept_data() &quot;</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                                                  <span class="stringliteral">&quot;failed&quot;</span>);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                                        <span class="keywordflow">goto</span> remove;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                                }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                        }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a> != -1) {</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                        <span class="keywordflow">if</span> (FD_ISSET(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="daemon_8c.html#a23eda314be657f32cde94fc43a19a6d7">efds</a>)) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                                <span class="keywordtype">int</span> error_number, rc;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                                socklen_t error_number_size =</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                        <span class="keyword">sizeof</span>(error_number);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;sock of flow %d in efds&quot;</span>,</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                rc = getsockopt(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, SOL_SOCKET,</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                                SO_ERROR,</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                                (<span class="keywordtype">void</span> *)&amp;error_number,</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                                                &amp;error_number_size);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                                <span class="keywordflow">if</span> (rc == -1) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                                        <a class="code" href="fg__error_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;failed to get errno for&quot;</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                             <span class="stringliteral">&quot;non-blocking connect&quot;</span>);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                                        <span class="keywordflow">goto</span> remove;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                                }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                <span class="keywordflow">if</span> (error_number != 0) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                                        <a class="code" href="fg__error_8h.html#a2d766a2a0ebfa282ee1d89dbe8fd0e81">warnc</a>(error_number, <span class="stringliteral">&quot;connect&quot;</span>);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                                        <span class="keywordflow">goto</span> remove;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                                }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                        <span class="keywordflow">if</span> (FD_ISSET(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="daemon_8c.html#a6391a90ddf873c2555b842a474fb9309">wfds</a>))</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#ab47d21199a51be6e1b9334d25049bd66">write_data</a>(<a class="code" href="structflow.html">flow</a>) == -1) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_ERR, <span class="stringliteral">&quot;write_data() failed&quot;</span>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                        <span class="keywordflow">goto</span> remove;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                        <span class="keywordflow">if</span> (FD_ISSET(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a>))</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a2f0a3334efe08cf776194c1c394cdce2">read_data</a>(<a class="code" href="structflow.html">flow</a>) == -1) {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_ERR, <span class="stringliteral">&quot;read_data() failed&quot;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                        <span class="keywordflow">goto</span> remove;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                                }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;remove:</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a> != -1) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>].<a class="code" href="structflow_1_1statistics.html#aec0e10ce5d0c7205464fcd0ffad8c232">has_tcp_info</a> =</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                <a class="code" href="daemon_8c.html#ad037eac03b0881ffc9647c45daff87f5">get_tcp_info</a>(<a class="code" href="structflow.html">flow</a>,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                             &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>].<a class="code" href="structflow_1_1statistics.html#a7522f70d387cfd231efd047d7310d721">tcp_info</a>)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                        ? 0 : 1;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a94e826d731af3ce59414ab483ff3e4f7">pmtu</a> = <a class="code" href="fg__socket_8c.html#abeb6cde31aa19f818745d2bffed938b4">get_pmtu</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <a class="code" href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">report_flow</a>(<a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <a class="code" href="daemon_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_ERR, <span class="stringliteral">&quot;removing flow %d&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                <a class="code" href="daemon_8c.html#aa6736f2aabb00598230614cdc3ec1a76">remove_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f0a3334efe08cf776194c1c394cdce2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f0a3334efe08cf776194c1c394cdce2">&#9670;&nbsp;</a></span>read_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int read_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd><a class="el" href="daemon_8c.html#a9f3ff8ee35a524d84af02768849f3673">process_rtt()</a>, <a class="el" href="daemon_8c.html#a54c3849a22e7bc35672dd1e04c34f5fc">process_iat()</a>, and process_delay () call all <a class="el" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78" title="Returns the current wall-clock time with nanosecond precision.">gettime()</a>. Quite inefficient... </dd></dl>

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01113">1113</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;{</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="keywordtype">int</span> optint = 0;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <span class="keywordtype">int</span> requested_response_block_size = 0;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                <span class="comment">/* make sure to read block header for new block */</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">current_block_bytes_read</a> &lt; <a class="code" href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a>) {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                        rc = <a class="code" href="daemon_8c.html#afea7e1b0e3888d8d15f970c32e1ff290">try_read_n_bytes</a>(<a class="code" href="structflow.html">flow</a>,</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                                              <a class="code" href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a>-<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">current_block_bytes_read</a>);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">current_block_bytes_read</a> &lt; <a class="code" href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a>)</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                <span class="comment">/* parse data and update status */</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                <span class="comment">/* parse and check current block size for validity */</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                optint = ntohl( ((<span class="keyword">struct</span> <a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">read_block</a>)-&gt;this_block_size );</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                <span class="keywordflow">if</span> (optint &gt;= <a class="code" href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a> &amp;&amp;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                    optint &lt;= flow-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a> )</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa80c2bfdd1a4f5a65d30b97c94e3cd88">current_read_block_size</a> = optint;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                        <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;flow %d parsed illegal cbs %d, &quot;</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                <span class="stringliteral">&quot;ignoring (max: %d)&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, optint,</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a>);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                <span class="comment">/* parse and check current request size for validity */</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                optint = ntohl( ((<span class="keyword">struct</span> <a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">read_block</a>)-&gt;request_block_size );</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                <span class="keywordflow">if</span> (optint == -1 || optint == 0  ||</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                    (optint &gt;= <a class="code" href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a> &amp;&amp;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                     optint &lt;= flow-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a>))</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                        requested_response_block_size = optint;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                        <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;flow %d parsed illegal qbs %d, &quot;</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                                <span class="stringliteral">&quot;ignoring (max: %d)&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, optint,</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a>);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                <span class="keywordflow">if</span> (requested_response_block_size == -1) {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_NOTICE, <span class="stringliteral">&quot;processing response block on &quot;</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                                  <span class="stringliteral">&quot;flow %d size: %d&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>,</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa80c2bfdd1a4f5a65d30b97c94e3cd88">current_read_block_size</a>);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_NOTICE, <span class="stringliteral">&quot;processing request block on &quot;</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                  <span class="stringliteral">&quot;flow %d size: %d, request: %d&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>,</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa80c2bfdd1a4f5a65d30b97c94e3cd88">current_read_block_size</a>,</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                                  requested_response_block_size);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* DEBUG */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                <span class="comment">/* read rest of block, if we have more to read */</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">current_block_bytes_read</a> &lt;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                    <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa80c2bfdd1a4f5a65d30b97c94e3cd88">current_read_block_size</a>)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                        rc += <a class="code" href="daemon_8c.html#afea7e1b0e3888d8d15f970c32e1ff290">try_read_n_bytes</a>(<a class="code" href="structflow.html">flow</a>,</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                               <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa80c2bfdd1a4f5a65d30b97c94e3cd88">current_read_block_size</a> -</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                               <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">current_block_bytes_read</a>);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">current_block_bytes_read</a> &gt;=</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                    <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa80c2bfdd1a4f5a65d30b97c94e3cd88">current_read_block_size</a> ) {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                        assert(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">current_block_bytes_read</a> ==</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa80c2bfdd1a4f5a65d30b97c94e3cd88">current_read_block_size</a>);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">current_block_bytes_read</a> = 0;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                        <span class="comment">/* TODO process_rtt(), process_iat(), and</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">                         * process_delay () call all gettime().</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">                         * Quite inefficient... */</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                        <span class="keywordflow">if</span> (requested_response_block_size == -1) {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                <span class="comment">/* this is a response block, consider DATA as</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">                                 * RTT  */</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>)</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#ac793e3ec0a05b118580c17b4f8086c2d">response_blocks_read</a>++;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                                <a class="code" href="daemon_8c.html#a9f3ff8ee35a524d84af02768849f3673">process_rtt</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                <span class="comment">/* this is a request block, calculate IAT */</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                                <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a8e6173d615bbb6ab389b160e182b429d">request_blocks_read</a>++;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                                <a class="code" href="daemon_8c.html#a54c3849a22e7bc35672dd1e04c34f5fc">process_iat</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                                <a class="code" href="daemon_8c.html#a6457b4c850a146e92e6d9c3556306b5d">process_delay</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                                <span class="comment">/* send response if requested */</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                <span class="keywordflow">if</span> (requested_response_block_size &gt;=</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                                    (<span class="keywordtype">signed</span>)<a class="code" href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a> &amp;&amp; !<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>])</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                        <a class="code" href="daemon_8c.html#ae5808c1a8a4f235184150b7fb30bc287">send_response</a>(<a class="code" href="structflow.html">flow</a>,</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                                                      requested_response_block_size);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                        }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#addf539178c60faab6c8fee7a54630fbc">pushy</a>)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6736f2aabb00598230614cdc3ec1a76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6736f2aabb00598230614cdc3ec1a76">&#9670;&nbsp;</a></span>remove_flow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void remove_flow </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *const&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00191">191</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;{</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="fg__list_8c.html#a1cd905157d4b1df02ae888cc18fc0029">fg_list_remove</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>, <a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        free(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="fg__list_8c.html#a4f790759b24f1f5d4e5867383d4dd0ad">fg_list_size</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>))</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <a class="code" href="daemon_8c.html#a22822755789d0770b81f031d467cd6e4">started</a> = 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a18d77e6b65b799ff7229768b64c4aad9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18d77e6b65b799ff7229768b64c4aad9">&#9670;&nbsp;</a></span>report_flow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void report_flow </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To prepare a report, report type is either INTERVAL or FINAL. </p>
<p>The daemon report the test data and results according to time duration for reporting interval. The daemon maintain all its data in its <code>flow</code> statistics data structure. These data are stored in the report data structure and reported to the controller.The flow id, flow endpoint (source or destination) and report <code>type</code> (interval or final) are used to identify the flow report in controller.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flow</td><td>flow structure maintained by a daemon </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>To determine report type i.e. interval or final </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00522">522</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;{</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;report_flow called for flow %d (type %d)&quot;</span>,</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, type);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keyword">struct </span><a class="code" href="structreport.html">report</a>* <a class="code" href="structreport.html">report</a> =</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                (<span class="keyword">struct </span><a class="code" href="structreport.html">report</a>*)malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structreport.html">report</a>));</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a545b6df40c29e489ba5fe507d80b9042">id</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#af9a9df70cefb7cdb4d3906bc49409d23">endpoint</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4f2eda16bd6129bc3057fa38b080a486">endpoint</a>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a> = <a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a> == <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ae81ba92c32db53c978e9367ea9d0ebba">begin</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac14ab829aa152004c3173af229147c7b">last_report_time</a>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ae81ba92c32db53c978e9367ea9d0ebba">begin</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a54cfb976bbfab7a02cb6738e1a18dcfc">first_report_time</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;<a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac14ab829aa152004c3173af229147c7b">last_report_time</a> = <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="comment">/* abort if we were scheduled way to early for a interval report */</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="fg__time_8c.html#a1ce08f00b1930420282aa6422ce66f24">time_diff</a>(&amp;<a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ae81ba92c32db53c978e9367ea9d0ebba">begin</a>,&amp;<a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>) &lt; 0.2 *</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">reporting_interval</a> &amp;&amp; <a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a> == <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>){</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                free(<a class="code" href="structreport.html">report</a>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#aef54fe7e2baef46bb8e00977474ba566">bytes_read</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a836b134622386d1fc94becbcc117cb32">bytes_read</a>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a7330324173edbf9bb4f0efc9b7a534ab">bytes_written</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a80c710aaf10a41c6a467d34bd9bac81d">bytes_written</a>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a18e53a95141a93975bc72f68ca0a8cca">request_blocks_read</a> =</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a8e6173d615bbb6ab389b160e182b429d">request_blocks_read</a>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a1371323e38cf2d43f2b822ee23a5528c">response_blocks_read</a> =</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#ac793e3ec0a05b118580c17b4f8086c2d">response_blocks_read</a>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#aec7214fb99ce49098845df88cbfd7a86">request_blocks_written</a> =</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#ae760d10eb27eae961db503b03b693fd7">request_blocks_written</a>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a41799abc2e9f9df843fa4a62079de7d5">response_blocks_written</a> =</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a4f102ee40bfd0fcfe231aac54554787d">response_blocks_written</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a431ccdbe065dbfc7e641ddb7cfb71bd3">rtt_min</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a3b4ab703ab22b6192777b859553a3594">rtt_min</a>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a53022f1afe786c88882906d0f154fc72">rtt_max</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#ae1ba3445791589ef501eb765bd808665">rtt_max</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a73a129ba9326de2855f317b55245e4e5">rtt_sum</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#ab88cf17f8060108b739b572c66bcac10">rtt_sum</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a8e77e60d692703b2273e058e0f879c11">iat_min</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#aaac45192612b658846d6a0307e6bce43">iat_min</a>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ab0b9886231083d13efdd5e0e01038cc3">iat_max</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#aff32ca848eebe991a7a8cf56bf153288">iat_max</a>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#af9381bd31155ddb60adfd66b0ed26ef2">iat_sum</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#ae55bad583676234bb11d6508222b7491">iat_sum</a>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a14340938e5747205d3833a5ae3d3b6c9">delay_min</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a9319c44e2e7e5cb5e396e118fe5fc7f9">delay_min</a>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#abdaec61f3f26be9d4361780367d73e3d">delay_max</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a44935f0f8dda8fa73b41a1b49f4c2e96">delay_max</a>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a6868860ad81a10e0bb9d842cb930b0ab">delay_sum</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a2a591497f98ee2a3aa172808f1db2699">delay_sum</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="comment">/* Currently this will only contain useful information on Linux</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">         * and FreeBSD */</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a528c4587a08a4a415c7089932facd980">tcp_info</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a7522f70d387cfd231efd047d7310d721">tcp_info</a>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a> != -1) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                <span class="comment">/* Get latest MTU */</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a94e826d731af3ce59414ab483ff3e4f7">pmtu</a> = <a class="code" href="fg__socket_8c.html#abeb6cde31aa19f818745d2bffed938b4">get_pmtu</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#acbd4824b0e80be7694c7b7ec9e71166a">pmtu</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a94e826d731af3ce59414ab483ff3e4f7">pmtu</a>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a> == <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>)</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a3a4dda0155ea81a8dcd03e17acd12c3d">imtu</a> = <a class="code" href="fg__socket_8c.html#a5c7f422f6d53d7f12b6aeba065bb94f2">get_imtu</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a3a4dda0155ea81a8dcd03e17acd12c3d">imtu</a> = 0;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a3a4dda0155ea81a8dcd03e17acd12c3d">imtu</a> = 0;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#acbd4824b0e80be7694c7b7ec9e71166a">pmtu</a> = 0;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="comment">/* Add status flags to report */</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> = 0;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a836b134622386d1fc94becbcc117cb32">bytes_read</a> == 0) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a76e143faa3209e1a2cc97ddbfc7cba59">flow_in_delay</a>(&amp;<a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>))</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;d&#39;</span>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a842c9355b4c0c828fdae26b790006a19">flow_sending</a>(&amp;<a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>))</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;l&#39;</span>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] == 0)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;o&#39;</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;f&#39;</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="daemon_8c.html#a842c9355b4c0c828fdae26b790006a19">flow_sending</a>(&amp;<a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>) &amp;&amp; !<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;c&#39;</span>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;n&#39;</span>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> &lt;&lt;= 8;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>].<a class="code" href="structflow_1_1statistics.html#a80c710aaf10a41c6a467d34bd9bac81d">bytes_written</a> == 0) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a76e143faa3209e1a2cc97ddbfc7cba59">flow_in_delay</a>(&amp;<a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>))</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;d&#39;</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a842c9355b4c0c828fdae26b790006a19">flow_sending</a>(&amp;<a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>))</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;l&#39;</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>] == 0)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;o&#39;</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;f&#39;</span>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="daemon_8c.html#a842c9355b4c0c828fdae26b790006a19">flow_sending</a>(&amp;<a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">end</a>, <a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>) &amp;&amp; !<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;c&#39;</span>;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                        <a class="code" href="structreport.html">report</a>-&gt;<a class="code" href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">status</a> |= <span class="charliteral">&#39;n&#39;</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="comment">/* New report interval, reset old data */</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a> == <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#a836b134622386d1fc94becbcc117cb32">bytes_read</a> = 0;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#a80c710aaf10a41c6a467d34bd9bac81d">bytes_written</a> = 0;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#a8e6173d615bbb6ab389b160e182b429d">request_blocks_read</a> = 0;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#ac793e3ec0a05b118580c17b4f8086c2d">response_blocks_read</a> = 0;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#ae760d10eb27eae961db503b03b693fd7">request_blocks_written</a> = 0;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#a4f102ee40bfd0fcfe231aac54554787d">response_blocks_written</a> = 0;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#a3b4ab703ab22b6192777b859553a3594">rtt_min</a> = FLT_MAX;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#ae1ba3445791589ef501eb765bd808665">rtt_max</a> = FLT_MIN;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#ab88cf17f8060108b739b572c66bcac10">rtt_sum</a> = 0.0F;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#aaac45192612b658846d6a0307e6bce43">iat_min</a> = FLT_MAX;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#aff32ca848eebe991a7a8cf56bf153288">iat_max</a> = FLT_MIN;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#ae55bad583676234bb11d6508222b7491">iat_sum</a> = 0.0F;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#a9319c44e2e7e5cb5e396e118fe5fc7f9">delay_min</a> = FLT_MAX;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#a44935f0f8dda8fa73b41a1b49f4c2e96">delay_max</a> = FLT_MIN;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#a2a591497f98ee2a3aa172808f1db2699">delay_sum</a> = 0.0F;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <a class="code" href="daemon_8c.html#a0a01949c50bc8128d13198fce302a021">add_report</a>(<a class="code" href="structreport.html">report</a>);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;report_flow finished for flow %d (type %d)&quot;</span>,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, <a class="code" href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">type</a>);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ace116bed071948dc1f66acc55607feb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace116bed071948dc1f66acc55607feb3">&#9670;&nbsp;</a></span>request_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void request_error </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrequest.html">request</a> *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00132">132</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordtype">char</span> str[1000];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        va_list ap;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        va_start(ap, fmt);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        vsnprintf(str, 1000, fmt, ap);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        va_end(ap);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        str[<span class="keyword">sizeof</span>(str) - 1] = 0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a> = malloc(strlen(str) + 1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        strcpy(<a class="code" href="structrequest.html">request</a>-&gt;<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a>, str);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5808c1a8a4f235184150b7fb30bc287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5808c1a8a4f235184150b7fb30bc287">&#9670;&nbsp;</a></span>send_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void send_response </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>requested_response_block_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01298">1298</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;{</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <span class="keywordtype">int</span> <span class="keywordflow">try</span> = 0;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        assert(!<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a>);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="comment">/* write requested block size as current size */</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        ((<span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;this_block_size =</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                htonl(requested_response_block_size);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="comment">/* rqs = -1 indicates response block */</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        ((<span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;request_block_size = htonl(-1);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        <span class="comment">/* copy rtt data from received block to response block (echo back) */</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        ((<span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;data =</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                ((<span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">read_block</a>)-&gt;data;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="comment">/* workaround for 64bit sender and 32bit receiver: we check if the</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">         * timespec is 64bit and then echo the missing 32bit back, too */</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <span class="keywordflow">if</span> ((((<span class="keyword">struct</span> <a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;<a class="code" href="structblock.html#a2120c3e22dba4ab13388bc2c32d2046a">data</a>.tv_sec) ||</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            ((<span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;data.tv_nsec)</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                ((<span class="keyword">struct</span> <a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;<a class="code" href="structblock.html#a00ce1454700612ad01fb7d9caaff9663">data2</a> =</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                        ((<span class="keyword">struct</span> <a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">read_block</a>)-&gt;<a class="code" href="structblock.html#a00ce1454700612ad01fb7d9caaff9663">data2</a>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;wrote new response data to out buffer bs = %d, &quot;</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                  <span class="stringliteral">&quot;rqs = %d on flow %d&quot;</span>,</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                  ntohl(((<span class="keyword">struct</span> <a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;this_block_size),</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                  ntohl(((<span class="keyword">struct</span> <a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;request_block_size),</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="comment">/* send data out until block is finished (or abort if 0 zero bytes are</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment">         * send CONGESTION_LIMIT times) */</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                rc = write(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                           <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a> + <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a>,</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                           requested_response_block_size -</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a>);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_NOTICE, <span class="stringliteral">&quot;send %d bytes response (rqs %d) on flow &quot;</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                          <span class="stringliteral">&quot;%d&quot;</span>, rc, requested_response_block_size,<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                <span class="keywordflow">if</span> (rc == -1) {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                        <span class="keywordflow">if</span> (errno == EAGAIN) {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;%s, still trying to send &quot;</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                          <span class="stringliteral">&quot;response block (write queue hit &quot;</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                                          <span class="stringliteral">&quot;limit)&quot;</span>, strerror(errno));</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                                <span class="keywordflow">try</span>++;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                                <span class="keywordflow">if</span> (<span class="keywordflow">try</span> &gt;= <a class="code" href="daemon_8c.html#a08a1bae2da6cab801ece1025a260b1b1">CONGESTION_LIMIT</a> &amp;&amp;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                                    !<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a>) {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                                        <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;tried to send &quot;</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                                <span class="stringliteral">&quot;response block %d times without &quot;</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                                <span class="stringliteral">&quot;success, dropping (%s)&quot;</span>,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                                <span class="keywordflow">try</span>, strerror(errno));</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                                }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;premature end of test: &quot;</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                                        <span class="stringliteral">&quot;%s, abort flow&quot;</span>, strerror(errno));</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] = 1;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                        }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a> += rc;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                        <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>)</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a80c710aaf10a41c6a467d34bd9bac81d">bytes_written</a> += rc;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160; </div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a> &gt;=</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                            (<span class="keywordtype">unsigned</span>)requested_response_block_size) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                assert(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a> ==</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                                        (<span class="keywordtype">unsigned</span>)requested_response_block_size);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                <span class="comment">/* just finish sending response block */</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a> = 0;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                                <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a31e674b599e405413d0695136a443666">last_block_written</a>);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                                <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>)</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a4f102ee40bfd0fcfe231aac54554787d">response_blocks_written</a>++;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                        }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                }</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        }</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afa6483c8495b4df9665927f6ab4eaabb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa6483c8495b4df9665927f6ab4eaabb">&#9670;&nbsp;</a></span>set_flow_tcp_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_flow_tcp_options </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01424">1424</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;{</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <a class="code" href="fg__socket_8c.html#a02113c8824bad0f80c20102a1756634b">set_non_blocking</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordflow">if</span> (*<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a1206d0f66388f1f916f1ea237453a8db">cc_alg</a> &amp;&amp;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <a class="code" href="fg__socket_8c.html#acd5c2f8cbb01fc2c9aad7574fa2d7d63">set_congestion_control</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a1206d0f66388f1f916f1ea237453a8db">cc_alg</a>) == -1) {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set congestion control &quot;</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                           <span class="stringliteral">&quot;algorithm: %s&quot;</span>, strerror(errno));</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a773a21e329a31811844f9f26da458e62">elcn</a> &amp;&amp;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            <a class="code" href="fg__socket_8c.html#a82d86f7f3d35cb6f06c2cb9f57955d87">set_so_elcn</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a773a21e329a31811844f9f26da458e62">elcn</a>) == -1) {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set TCP_ELCN: %s&quot;</span>,</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#aa16b93831301f5b6faf010158327cf67">lcd</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#a9f03da778d202b26f33b7d463181856e">set_so_lcd</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set TCP_LCD: %s&quot;</span>,</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ae229f5e5bd4c3689473dcb7b7debea6e">cork</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#ab2053a8d245324b11d603cc43b327db5">set_tcp_cork</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set TCP_CORK: %s&quot;</span>,</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        }</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ae1bb84bc89626d9c6950b41a7a124ee2">so_debug</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#a2c49d58f3483817990c8b7c732891ffd">set_so_debug</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set SO_DEBUG: %s&quot;</span>,</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#aeebdd152f5d7d68a4435b31313550bad">mtcp</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#a3812672e43521addb0f94be5ec70a2c7">set_tcp_mtcp</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set TCP_MTCP: %s&quot;</span>,</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#af1d11c3e1d43f04babc48c1c002a31ac">nonagle</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#ac2ddd7ff0e28617a498b922b85ad9e29">set_tcp_nodelay</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set TCP_NODELAY: %s&quot;</span>,</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#aea33a5413dbace7b756f93afdea7963d">route_record</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#af08fd91d990fe9481090aaf7f5efabdb">set_route_record</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set route record option: %s&quot;</span>,</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        }</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">dscp</a> &amp;&amp;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            <a class="code" href="fg__socket_8c.html#a128d76deeb39f543de89cf0c52729101">set_dscp</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">dscp</a>) == -1) {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set DSCP value: %s&quot;</span>,</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a182d573decbb50a7691ab088dd630a54">ipmtudiscover</a> &amp;&amp;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <a class="code" href="fg__socket_8c.html#a28705e5f3da83f4c8721e547c41687c4">set_ip_mtu_discover</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Unable to set IP_MTU_DISCOVER value: %s&quot;</span>,</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                           strerror(errno));</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#a66910f0d25743b5d85ddfb9069198aa4">apply_extra_socket_options</a>(<a class="code" href="structflow.html">flow</a>) == -1)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a59607f45dabe596ae017733d49caafb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59607f45dabe596ae017733d49caafb8">&#9670;&nbsp;</a></span>start_flows()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void start_flows </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrequest__start__flows.html">request_start_flows</a> *&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00333">333</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;{</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keyword">struct </span>timespec start;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;start);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">if</span> (start.tv_sec &lt; <a class="code" href="structrequest.html">request</a>-&gt;start_timestamp) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <span class="comment">/* If the clock is synchronized between nodes, all nodes will</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">                 * start at the same time regardless of any RPC delays */</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                start.tv_sec = <a class="code" href="structrequest.html">request</a>-&gt;start_timestamp;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                start.tv_nsec = 0;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* 0 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <a class="code" href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a>(<a class="code" href="structrequest.html">request</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* 0 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlist__node.html">list_node</a> *node = <a class="code" href="fg__list_8c.html#a7b1316612a89d2df33e3be100fb1e797">fg_list_front</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">while</span> (node) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="keyword">struct </span><a class="code" href="structflow.html">flow</a> *<a class="code" href="structflow.html">flow</a> = node-&gt;<a class="code" href="structlist__node.html#aaa55c3480c90432991e01545b6ff34b5">data</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                node = node-&gt;<a class="code" href="structlist__node.html#a0b99ca890dbfe832a8475f4bbd72338c">next</a>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="comment">/* initalize random number generator etc */</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <a class="code" href="fg__math_8c.html#a84e0bc4337726d56f9fb3c935e1cc170">init_math_functions</a>(<a class="code" href="structflow.html">flow</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#aa32e335e786e3b6634824fa757c285b9">random_seed</a>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="comment">/* READ and WRITE */</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa1cfbf41ded33437a919e4ec1a7eb0c0">start_timestamp</a>[j] = start;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                        <a class="code" href="fg__time_8c.html#a5017d8e7d42049ef923057b5a02404be">time_add</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa1cfbf41ded33437a919e4ec1a7eb0c0">start_timestamp</a>[j],</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                 <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">delay</a>[j]);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[j] &gt;= 0) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a9a3f07a95a7e900577be6067ccd0779d">stop_timestamp</a>[j] =</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa1cfbf41ded33437a919e4ec1a7eb0c0">start_timestamp</a>[j];</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                <a class="code" href="fg__time_8c.html#a5017d8e7d42049ef923057b5a02404be">time_add</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a9a3f07a95a7e900577be6067ccd0779d">stop_timestamp</a>[j],</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                         <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">duration</a>[j]);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                        }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a30e6464cf5e91f15049297e4452d120e">next_write_block_timestamp</a> =</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa1cfbf41ded33437a919e4ec1a7eb0c0">start_timestamp</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>];</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac14ab829aa152004c3173af229147c7b">last_report_time</a>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a54cfb976bbfab7a02cb6738e1a18dcfc">first_report_time</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac14ab829aa152004c3173af229147c7b">last_report_time</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a2a332248f5cbd611defef89722b64060">next_report_time</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac14ab829aa152004c3173af229147c7b">last_report_time</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                <a class="code" href="fg__time_8c.html#a5017d8e7d42049ef923057b5a02404be">time_add</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a2a332248f5cbd611defef89722b64060">next_report_time</a>,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                         <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">reporting_interval</a>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="daemon_8c.html#a22822755789d0770b81f031d467cd6e4">started</a> = 1;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1f5aec48271ef6205d79be756decdc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1f5aec48271ef6205d79be756decdc4">&#9670;&nbsp;</a></span>stop_flow()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void stop_flow </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrequest__stop__flow.html">request_stop_flow</a> *&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00382">382</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;stop_flow forcefully unlocked mutex&quot;</span>);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        pthread_mutex_unlock(&amp;<a class="code" href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structrequest.html">request</a>-&gt;flow_id == -1) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                <span class="comment">/* Stop all flows */</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlist__node.html">list_node</a> *node = <a class="code" href="fg__list_8c.html#a7b1316612a89d2df33e3be100fb1e797">fg_list_front</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <span class="keywordflow">while</span> (node) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        <span class="keyword">struct </span><a class="code" href="structflow.html">flow</a> *<a class="code" href="structflow.html">flow</a> = node-&gt;<a class="code" href="structlist__node.html#aaa55c3480c90432991e01545b6ff34b5">data</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        node = node-&gt;<a class="code" href="structlist__node.html#a0b99ca890dbfe832a8475f4bbd72338c">next</a>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>].<a class="code" href="structflow_1_1statistics.html#aec0e10ce5d0c7205464fcd0ffad8c232">has_tcp_info</a> =</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                <a class="code" href="daemon_8c.html#ad037eac03b0881ffc9647c45daff87f5">get_tcp_info</a>(<a class="code" href="structflow.html">flow</a>,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                             &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>].<a class="code" href="structflow_1_1statistics.html#a7522f70d387cfd231efd047d7310d721">tcp_info</a>)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                        ? 0 : 1;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a94e826d731af3ce59414ab483ff3e4f7">pmtu</a> = <a class="code" href="fg__socket_8c.html#abeb6cde31aa19f818745d2bffed938b4">get_pmtu</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">reporting_interval</a>)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                <a class="code" href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">report_flow</a>(<a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        <a class="code" href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">report_flow</a>(<a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        <a class="code" href="daemon_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                        <a class="code" href="daemon_8c.html#aa6736f2aabb00598230614cdc3ec1a76">remove_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlist__node.html">list_node</a> *node = <a class="code" href="fg__list_8c.html#a7b1316612a89d2df33e3be100fb1e797">fg_list_front</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">while</span> (node) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keyword">struct </span><a class="code" href="structflow.html">flow</a> *<a class="code" href="structflow.html">flow</a> = node-&gt;<a class="code" href="structlist__node.html#aaa55c3480c90432991e01545b6ff34b5">data</a>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                node = node-&gt;<a class="code" href="structlist__node.html#a0b99ca890dbfe832a8475f4bbd72338c">next</a>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a> != <a class="code" href="structrequest.html">request</a>-&gt;flow_id)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="comment">/* On Other OSes than Linux or FreeBSD, tcp_info will contain all zeroes */</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>].<a class="code" href="structflow_1_1statistics.html#aec0e10ce5d0c7205464fcd0ffad8c232">has_tcp_info</a> =</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        <a class="code" href="daemon_8c.html#ad037eac03b0881ffc9647c45daff87f5">get_tcp_info</a>(<a class="code" href="structflow.html">flow</a>,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                     &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>].<a class="code" href="structflow_1_1statistics.html#a7522f70d387cfd231efd047d7310d721">tcp_info</a>)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                ? 0 : 1;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a94e826d731af3ce59414ab483ff3e4f7">pmtu</a> = <a class="code" href="fg__socket_8c.html#abeb6cde31aa19f818745d2bffed938b4">get_pmtu</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">reporting_interval</a>)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                        <a class="code" href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">report_flow</a>(<a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <a class="code" href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">report_flow</a>(<a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <a class="code" href="daemon_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <a class="code" href="daemon_8c.html#aa6736f2aabb00598230614cdc3ec1a76">remove_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a>(&amp;<a class="code" href="structrequest.html">request</a>-&gt;r, <span class="stringliteral">&quot;Unknown flow id&quot;</span>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af8bb1c94838c1b1156135080f0438faa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8bb1c94838c1b1156135080f0438faa">&#9670;&nbsp;</a></span>timer_check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void timer_check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00691">691</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;{</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keyword">struct </span>timespec now;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="daemon_8c.html#a22822755789d0770b81f031d467cd6e4">started</a>)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;now);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlist__node.html">list_node</a> *node = <a class="code" href="fg__list_8c.html#a7b1316612a89d2df33e3be100fb1e797">fg_list_front</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="keywordflow">while</span> (node) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                <span class="keyword">struct </span><a class="code" href="structflow.html">flow</a> *<a class="code" href="structflow.html">flow</a> = node-&gt;<a class="code" href="structlist__node.html#aaa55c3480c90432991e01545b6ff34b5">data</a>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                node = node-&gt;<a class="code" href="structlist__node.html#a0b99ca890dbfe832a8475f4bbd72338c">next</a>;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;processing timer_check() for flow %d&quot;</span>,</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">reporting_interval</a>)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="fg__time_8c.html#a801431f54cf89b9f658e3e29b2bba0fe">time_is_after</a>(&amp;now, &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a2a332248f5cbd611defef89722b64060">next_report_time</a>))</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <span class="comment">/* On Other OSes than Linux or FreeBSD, tcp_info will contain all zeroes */</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a> != -1)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#aec0e10ce5d0c7205464fcd0ffad8c232">has_tcp_info</a> =</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                <a class="code" href="daemon_8c.html#ad037eac03b0881ffc9647c45daff87f5">get_tcp_info</a>(<a class="code" href="structflow.html">flow</a>,</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                             &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[<a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>].<a class="code" href="structflow_1_1statistics.html#a7522f70d387cfd231efd047d7310d721">tcp_info</a>)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                                        ? 0 : 1;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                <a class="code" href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">report_flow</a>(<a class="code" href="structflow.html">flow</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                        <a class="code" href="fg__time_8c.html#a5017d8e7d42049ef923057b5a02404be">time_add</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a2a332248f5cbd611defef89722b64060">next_report_time</a>,</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                 <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">reporting_interval</a>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                } <span class="keywordflow">while</span> (<a class="code" href="fg__time_8c.html#a801431f54cf89b9f658e3e29b2bba0fe">time_is_after</a>(&amp;now, &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a2a332248f5cbd611defef89722b64060">next_report_time</a>));</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;finished timer_check()&quot;</span>);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afea7e1b0e3888d8d15f970c32e1ff290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afea7e1b0e3888d8d15f970c32e1ff290">&#9670;&nbsp;</a></span>try_read_n_bytes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int try_read_n_bytes </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l01054">1054</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;{</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keyword">struct </span>iovec iov;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keyword">struct </span>msghdr msg;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">/* we only read out of band data for debugging purpose */</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordtype">char</span> cbuf[512];</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keyword">struct </span>cmsghdr *cmsg;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* DEBUG */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="keywordtype">char</span> cbuf[16];</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* DEBUG */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        iov.iov_base = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">read_block</a> +</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                       <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">current_block_bytes_read</a>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        iov.iov_len = bytes;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="comment">/* no name required */</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        msg.msg_name = NULL;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        msg.msg_namelen = 0;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        msg.msg_iov = &amp;iov;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        msg.msg_iovlen = 1;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        msg.msg_control = cbuf;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        msg.msg_controllen = <span class="keyword">sizeof</span>(cbuf);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        rc = recvmsg(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, &amp;msg, 0);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;tried reading %d bytes, got %d&quot;</span>, bytes, rc);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">if</span> (rc == -1) {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                <span class="keywordflow">if</span> (errno == EAGAIN)</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                        <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;Premature end of test: %s&quot;</span>,</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                                   strerror(errno));</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="keywordflow">if</span> (rc == 0) {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_ERR, <span class="stringliteral">&quot;server shut down test socket of flow %d&quot;</span>,</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] || !<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a58ee2ce95a7ee3b8d2a06f3a55ccaf07">shutdown</a>)</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                        <a class="code" href="fg__error_8h.html#ae6cfebfa20e754bd09c394f8bd07f624">warnx</a>(<span class="stringliteral">&quot;premature shutdown of server flow&quot;</span>);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">finished</a>[<a class="code" href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a>] = 1;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;flow %d received %u bytes&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, rc);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">current_block_bytes_read</a> += rc;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>)</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a836b134622386d1fc94becbcc117cb32">bytes_read</a> += rc;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">for</span> (cmsg = CMSG_FIRSTHDR(&amp;msg); cmsg; cmsg = CMSG_NXTHDR(&amp;msg, cmsg))</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_NOTICE, <span class="stringliteral">&quot;flow %d received cmsg: type = %u, len = %u&quot;</span>,</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, cmsg-&gt;cmsg_type, (socklen_t) cmsg-&gt;cmsg_len);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* DEBUG */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a48bcab4c829140d6115c3b71e5c6ddc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48bcab4c829140d6115c3b71e5c6ddc9">&#9670;&nbsp;</a></span>uninit_flow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uninit_flow </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00165">165</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG,<span class="stringliteral">&quot;uninit_flow() called for flow %d&quot;</span>,<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a> != -1)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                close(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a17fe9a16d079930fa345a6fc635fa1da">listenfd_data</a> != -1)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                close(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a17fe9a16d079930fa345a6fc635fa1da">listenfd_data</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#ifdef HAVE_LIBPCAP</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a3aee86084eac437051355cce738de2ef">traffic_dump</a> &amp;&amp; <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a07ae1fba61090712dae7c9fbe130a48a">pcap_thread</a>) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                rc = pthread_cancel(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a07ae1fba61090712dae7c9fbe130a48a">pcap_thread</a>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="keywordflow">if</span> (rc)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                        <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;failed to cancel dump thread: %s&quot;</span>,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                strerror(rc));</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="comment">/* wait for the dump thread to react to the cancellation request */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                rc = pthread_join(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a07ae1fba61090712dae7c9fbe130a48a">pcap_thread</a>, NULL);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                <span class="keywordflow">if</span> (rc)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                        <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;failed to join dump thread: %s&quot;</span>,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                strerror(rc));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_LIBPCAP */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <a class="code" href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">read_block</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a65aa5ef64b2308b297a95c1160200fdc">addr</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="fg__math_8c.html#a5aed7ddaa34761ec72f7e862813e9832">free_math_functions</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab47d21199a51be6e1b9334d25049bd66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab47d21199a51be6e1b9334d25049bd66">&#9670;&nbsp;</a></span>write_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int write_data </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00937">937</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;{</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="keywordtype">int</span> response_block_size = 0;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="keywordtype">double</span> interpacket_gap = .0;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                <span class="comment">/* fill buffer with new data */</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a> == 0) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#afa482adb3d3445e276a009a895bd3dda">current_write_block_size</a> =</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                <a class="code" href="trafgen_8c.html#adbe1cce2507b35cccf9f8941b152882c">next_request_block_size</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                        response_block_size = <a class="code" href="trafgen_8c.html#ae5b2d6c86bbfe838e2168e2d19c9e06d">next_response_block_size</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                        <span class="comment">/* serialize data:</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">                         * this_block_size */</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                        ((<span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;this_block_size =</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                htonl(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#afa482adb3d3445e276a009a895bd3dda">current_write_block_size</a>);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                        <span class="comment">/* requested_block_size */</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                        ((<span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;request_block_size =</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                htonl(response_block_size);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                        <span class="comment">/* write rtt data (will be echoed back by the receiver</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">                         * in the response packet) */</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>((<span class="keyword">struct</span> timespec *)</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                                (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a> + 2 * (sizeof (int32_t))));</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;wrote new request data to out &quot;</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                                  <span class="stringliteral">&quot;buffer bs = %d, rqs = %d, on flow %d&quot;</span>,</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                                  ntohl(((<span class="keyword">struct</span> <a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;this_block_size),</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                                  ntohl(((<span class="keyword">struct</span> <a class="code" href="structblock.html">block</a> *)<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a>)-&gt;request_block_size),</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                  <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                rc = write(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>,</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                           <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a> +</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                           <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a>,</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                           <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#afa482adb3d3445e276a009a895bd3dda">current_write_block_size</a> -</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                           <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a>);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="keywordflow">if</span> (rc == -1) {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                        <span class="keywordflow">if</span> (errno == EAGAIN) {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;write queue limit hit for &quot;</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                                        <span class="stringliteral">&quot;flow %d&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                        }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;write() returned %d on flow %d, &quot;</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                                   <span class="stringliteral">&quot;fd %d: %s&quot;</span>, rc, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>,</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                   strerror(errno));</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                        <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;premature end of test: %s&quot;</span>,</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                   strerror(errno));</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                        <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                <span class="keywordflow">if</span> (rc == 0) {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_CRIT, <span class="stringliteral">&quot;flow %d sent zero bytes. what &quot;</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                  <span class="stringliteral">&quot;does that mean?&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                        <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_DEBUG, <span class="stringliteral">&quot;flow %d sent %d request bytes of %u &quot;</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                          <span class="stringliteral">&quot;(before = %u)&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, rc,</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#afa482adb3d3445e276a009a895bd3dda">current_write_block_size</a>,</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a>);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#a80c710aaf10a41c6a467d34bd9bac81d">bytes_written</a> += rc;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a> += rc;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a> &gt;=</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                    <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#afa482adb3d3445e276a009a895bd3dda">current_write_block_size</a>) {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                        assert(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a> ==</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                               <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#afa482adb3d3445e276a009a895bd3dda">current_write_block_size</a>);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                        <span class="comment">/* we just finished writing a block */</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a3709d35dd1086e178000fe1cd7775656">current_block_bytes_written</a> = 0;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                        <a class="code" href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a31e674b599e405413d0695136a443666">last_block_written</a>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                        <span class="keywordflow">foreach</span>(<span class="keywordtype">int</span> *i, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a>, <a class="code" href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a>)</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">statistics</a>[*i].<a class="code" href="structflow_1_1statistics.html#ae760d10eb27eae961db503b03b693fd7">request_blocks_written</a>++;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                        interpacket_gap = <a class="code" href="trafgen_8c.html#ae3ebec7eeb55c6bfb03341576327e322">next_interpacket_gap</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                        <span class="comment">/* if we calculated a non-zero packet add relative time</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">                         * to the next write stamp which is then checked in the</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">                         * select call */</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                        <span class="keywordflow">if</span> (interpacket_gap) {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                                <a class="code" href="fg__time_8c.html#a5017d8e7d42049ef923057b5a02404be">time_add</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a30e6464cf5e91f15049297e4452d120e">next_write_block_timestamp</a>,</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                         interpacket_gap);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="fg__time_8c.html#a801431f54cf89b9f658e3e29b2bba0fe">time_is_after</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a31e674b599e405413d0695136a443666">last_block_written</a>,</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                                                  &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a30e6464cf5e91f15049297e4452d120e">next_write_block_timestamp</a>)) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                                        <span class="keywordtype">char</span> timestamp[30] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                                        <a class="code" href="fg__time_8c.html#a171ccad0a7b8941cc4a1f366c2e34c4c">ctimespec_r</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a30e6464cf5e91f15049297e4452d120e">next_write_block_timestamp</a>,</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                                    timestamp, <span class="keyword">sizeof</span>(timestamp), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                                        <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_WARNING, <span class="stringliteral">&quot;incipient &quot;</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                                  <span class="stringliteral">&quot;congestion on flow %u new &quot;</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                                                  <span class="stringliteral">&quot;block scheduled for %s, &quot;</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                                                  <span class="stringliteral">&quot;%.6lfs before now&quot;</span>,</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                                                   <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, timestamp,</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                                   <a class="code" href="fg__time_8c.html#a1ce08f00b1930420282aa6422ce66f24">time_diff</a>(&amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a30e6464cf5e91f15049297e4452d120e">next_write_block_timestamp</a>,</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                                             &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a31e674b599e405413d0695136a443666">last_block_written</a>));</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac032e656440cac4f092ba3129b3e33a1">congestion_counter</a>++;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac032e656440cac4f092ba3129b3e33a1">congestion_counter</a> &gt;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                            <a class="code" href="daemon_8c.html#a08a1bae2da6cab801ece1025a260b1b1">CONGESTION_LIMIT</a> &amp;&amp;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                            <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a9b37b291808623d607848c54c48f19f4">flow_control</a>)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                                                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                        }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#ae229f5e5bd4c3689473dcb7b7debea6e">cork</a> &amp;&amp; <a class="code" href="fg__socket_8c.html#a2534f3f0b9b8526b2e30d9941f7e2dcf">toggle_tcp_cork</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>) == -1)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(LOG_NOTICE, <span class="stringliteral">&quot;failed to recork test &quot;</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                          <span class="stringliteral">&quot;socket for flow %d: %s&quot;</span>,</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                                          <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>, strerror(errno));</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#addf539178c60faab6c8fee7a54630fbc">pushy</a>)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a114a7eaf522519c4b3efbefb5fc069cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114a7eaf522519c4b3efbefb5fc069cf">&#9670;&nbsp;</a></span>daemon_pipe</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int daemon_pipe[2]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00087">87</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a6a00c14be1565cda838246a824529e42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a00c14be1565cda838246a824529e42">&#9670;&nbsp;</a></span>daemon_thread</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_t daemon_thread</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00089">89</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a9e00b9f05b6a2247bb6c99ff3387a932"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e00b9f05b6a2247bb6c99ff3387a932">&#9670;&nbsp;</a></span>dump_dir</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* dump_dir</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00091">91</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a016095bb5b1fadba7bc57d2a0d1a75f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a016095bb5b1fadba7bc57d2a0d1a75f8">&#9670;&nbsp;</a></span>dump_prefix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* dump_prefix</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00090">90</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a23eda314be657f32cde94fc43a19a6d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23eda314be657f32cde94fc43a19a6d7">&#9670;&nbsp;</a></span>efds</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fd_set efds</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00096">96</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a404ebcfc5a80e668901703c46a807157"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404ebcfc5a80e668901703c46a807157">&#9670;&nbsp;</a></span>flows</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlinked__list.html">linked_list</a> flows</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00103">103</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a7a13a361801dcc59ce4946736fa26726"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a13a361801dcc59ce4946736fa26726">&#9670;&nbsp;</a></span>maxfd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int maxfd</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00097">97</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a4acff8232e4aec9cd5c6dc200ac55ef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4acff8232e4aec9cd5c6dc200ac55ef3">&#9670;&nbsp;</a></span>mutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t mutex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00093">93</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a33febb18ddf50438a47e5eee54be6c77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33febb18ddf50438a47e5eee54be6c77">&#9670;&nbsp;</a></span>pending_reports</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned pending_reports = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00101">101</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a5981029394ee67ad583f0319dc9468b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5981029394ee67ad583f0319dc9468b5">&#9670;&nbsp;</a></span>reports</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structreport.html">report</a>* reports = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00099">99</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a7dd776b27a8695d29a8f178ddb26a2eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dd776b27a8695d29a8f178ddb26a2eb">&#9670;&nbsp;</a></span>reports_last</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structreport.html">report</a>* reports_last = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00100">100</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="aaa94c4a05963e33561e701944c82d645"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa94c4a05963e33561e701944c82d645">&#9670;&nbsp;</a></span>requests</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structrequest.html">request</a>* requests = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00094">94</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a5c8ad0b474e5da9a984f42d401e58d9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c8ad0b474e5da9a984f42d401e58d9c">&#9670;&nbsp;</a></span>requests_last</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structrequest.html">request</a> * requests_last = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00094">94</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a66342c63e01fe543ed20793f32385f7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66342c63e01fe543ed20793f32385f7e">&#9670;&nbsp;</a></span>rfds</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fd_set rfds</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00096">96</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a22822755789d0770b81f031d467cd6e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22822755789d0770b81f031d467cd6e4">&#9670;&nbsp;</a></span>started</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char started = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00105">105</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
<a id="a6391a90ddf873c2555b842a474fb9309"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6391a90ddf873c2555b842a474fb9309">&#9670;&nbsp;</a></span>wfds</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fd_set wfds</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="daemon_8c_source.html#l00096">96</a> of file <a class="el" href="daemon_8c_source.html">daemon.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="adebug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error.</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_ac793e3ec0a05b118580c17b4f8086c2d"><div class="ttname"><a href="structflow_1_1statistics.html#ac793e3ec0a05b118580c17b4f8086c2d">flow::statistics::response_blocks_read</a></div><div class="ttdeci">unsigned response_blocks_read</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00132">daemon.h:132</a></div></div>
<div class="ttc" id="acommon_8h_html_aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5"><div class="ttname"><a href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6afb43b8264ea4d3dd9957ba1b3fd3f3d5">FINAL</a></div><div class="ttdeci">@ FINAL</div><div class="ttdoc">Final report.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00116">common.h:116</a></div></div>
<div class="ttc" id="adaemon_8h_html_a3ce8d4ae1e4221490780ddcf1e48191c"><div class="ttname"><a href="daemon_8h.html#a3ce8d4ae1e4221490780ddcf1e48191c">REQUEST_STOP_FLOW</a></div><div class="ttdeci">#define REQUEST_STOP_FLOW</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00176">daemon.h:176</a></div></div>
<div class="ttc" id="acommon_8h_html_a413eaa5f6866b1c5f00fc612e7afadc5a4408646d55b725feed6715de7902ebf4"><div class="ttname"><a href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5a4408646d55b725feed6715de7902ebf4">level_sol_socket</a></div><div class="ttdeci">@ level_sol_socket</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00121">common.h:121</a></div></div>
<div class="ttc" id="acommon_8h_html_aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6"><div class="ttname"><a href="common_8h.html#aef184f6632fca2f51c24b0808fcee0a6a15685f61e1f7ab09f7543d6ffbb51ac6">INTERVAL</a></div><div class="ttdeci">@ INTERVAL</div><div class="ttdoc">Intermediated interval report.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00114">common.h:114</a></div></div>
<div class="ttc" id="astructreport_html_a545b6df40c29e489ba5fe507d80b9042"><div class="ttname"><a href="structreport.html#a545b6df40c29e489ba5fe507d80b9042">report::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00287">common.h:287</a></div></div>
<div class="ttc" id="adaemon_8c_html_a74a8247c715e328e3bc0b2d781c5a6b1"><div class="ttname"><a href="daemon_8c.html#a74a8247c715e328e3bc0b2d781c5a6b1">prepare_wfds</a></div><div class="ttdeci">static void prepare_wfds(struct timespec *now, struct flow *flow, fd_set *wfds)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00199">daemon.c:199</a></div></div>
<div class="ttc" id="afg__definitions_8h_html_ad4cd7244516b51cb71cbbddaae881985"><div class="ttname"><a href="fg__definitions_8h.html#ad4cd7244516b51cb71cbbddaae881985">ASSIGN_MAX</a></div><div class="ttdeci">#define ASSIGN_MAX(s, c)</div><div class="ttdoc">Assign value if it's greater than current one.</div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00068">fg_definitions.h:68</a></div></div>
<div class="ttc" id="adaemon_8c_html_a66910f0d25743b5d85ddfb9069198aa4"><div class="ttname"><a href="daemon_8c.html#a66910f0d25743b5d85ddfb9069198aa4">apply_extra_socket_options</a></div><div class="ttdeci">int apply_extra_socket_options(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01378">daemon.c:1378</a></div></div>
<div class="ttc" id="acommon_8h_html_a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc"><div class="ttname"><a href="common_8h.html#a423620ef7d69894833f70cfc395caaa9a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a></div><div class="ttdeci">@ WRITE</div><div class="ttdoc">Write operation.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00106">common.h:106</a></div></div>
<div class="ttc" id="adaemon_8c_html_a66342c63e01fe543ed20793f32385f7e"><div class="ttname"><a href="daemon_8c.html#a66342c63e01fe543ed20793f32385f7e">rfds</a></div><div class="ttdeci">fd_set rfds</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00096">daemon.c:96</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_a2a591497f98ee2a3aa172808f1db2699"><div class="ttname"><a href="structflow_1_1statistics.html#a2a591497f98ee2a3aa172808f1db2699">flow::statistics::delay_sum</a></div><div class="ttdeci">double delay_sum</div><div class="ttdoc">Accumulated one-way delay.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00148">daemon.h:148</a></div></div>
<div class="ttc" id="astructflow_html_aa80c2bfdd1a4f5a65d30b97c94e3cd88"><div class="ttname"><a href="structflow.html#aa80c2bfdd1a4f5a65d30b97c94e3cd88">flow::current_read_block_size</a></div><div class="ttdeci">unsigned current_read_block_size</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00101">daemon.h:101</a></div></div>
<div class="ttc" id="afg__time_8c_html_a5017d8e7d42049ef923057b5a02404be"><div class="ttname"><a href="fg__time_8c.html#a5017d8e7d42049ef923057b5a02404be">time_add</a></div><div class="ttdeci">void time_add(struct timespec *tp, double seconds)</div><div class="ttdoc">Add an amount of time seconds to a specific point in time tp.</div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00136">fg_time.c:136</a></div></div>
<div class="ttc" id="astructrequest__get__status_html"><div class="ttname"><a href="structrequest__get__status.html">request_get_status</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00247">daemon.h:247</a></div></div>
<div class="ttc" id="astructflow__settings_html_aa32e335e786e3b6634824fa757c285b9"><div class="ttname"><a href="structflow__settings.html#aa32e335e786e3b6634824fa757c285b9">flow_settings::random_seed</a></div><div class="ttdeci">unsigned random_seed</div><div class="ttdoc">Random seed to use (default: read /dev/urandom) (option -J).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00223">common.h:223</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_aaac45192612b658846d6a0307e6bce43"><div class="ttname"><a href="structflow_1_1statistics.html#aaac45192612b658846d6a0307e6bce43">flow::statistics::iat_min</a></div><div class="ttdeci">double iat_min</div><div class="ttdoc">Minimum interarrival time.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00138">daemon.h:138</a></div></div>
<div class="ttc" id="afg__list_8c_html_a4f790759b24f1f5d4e5867383d4dd0ad"><div class="ttname"><a href="fg__list_8c.html#a4f790759b24f1f5d4e5867383d4dd0ad">fg_list_size</a></div><div class="ttdeci">size_t fg_list_size(struct linked_list *const list)</div><div class="ttdoc">Returns the number of elements in the list.</div><div class="ttdef"><b>Definition:</b> <a href="fg__list_8c_source.html#l00211">fg_list.c:211</a></div></div>
<div class="ttc" id="astructreport_html_a53022f1afe786c88882906d0f154fc72"><div class="ttname"><a href="structreport.html#a53022f1afe786c88882906d0f154fc72">report::rtt_max</a></div><div class="ttdeci">double rtt_max</div><div class="ttdoc">Maximum round-trip time.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00323">common.h:323</a></div></div>
<div class="ttc" id="astructflow_html_a116b10ed1d681c8b889f0417ae4aafe4"><div class="ttname"><a href="structflow.html#a116b10ed1d681c8b889f0417ae4aafe4">flow::connect_called</a></div><div class="ttdeci">char connect_called</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00111">daemon.h:111</a></div></div>
<div class="ttc" id="adaemon_8h_html_a7956881b57fbb4cf42cb60ce602c8313"><div class="ttname"><a href="daemon_8h.html#a7956881b57fbb4cf42cb60ce602c8313">REQUEST_GET_UUID</a></div><div class="ttdeci">#define REQUEST_GET_UUID</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00178">daemon.h:178</a></div></div>
<div class="ttc" id="afg__time_8c_html_a1ce08f00b1930420282aa6422ce66f24"><div class="ttname"><a href="fg__time_8c.html#a1ce08f00b1930420282aa6422ce66f24">time_diff</a></div><div class="ttdeci">double time_diff(const struct timespec *tp1, const struct timespec *tp2)</div><div class="ttdoc">Returns the time difference between two the specific points in time tp1 and tp2.</div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00095">fg_time.c:95</a></div></div>
<div class="ttc" id="astructflow_html"><div class="ttname"><a href="structflow.html">flow</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00073">daemon.h:73</a></div></div>
<div class="ttc" id="adaemon_8c_html_ace116bed071948dc1f66acc55607feb3"><div class="ttname"><a href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a></div><div class="ttdeci">void request_error(struct request *request, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00132">daemon.c:132</a></div></div>
<div class="ttc" id="acommon_8h_html_a413eaa5f6866b1c5f00fc612e7afadc5a9e88880373e101d2c96f2beb55b72364"><div class="ttname"><a href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5a9e88880373e101d2c96f2beb55b72364">level_ipproto_udp</a></div><div class="ttdeci">@ level_ipproto_udp</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00126">common.h:126</a></div></div>
<div class="ttc" id="afg__rpc__server_8c_html_a55fd54a0087dd0ac821433cbda1f65bd"><div class="ttname"><a href="fg__rpc__server_8c.html#a55fd54a0087dd0ac821433cbda1f65bd">add_flow_source</a></div><div class="ttdeci">static xmlrpc_value * add_flow_source(xmlrpc_env *const env, xmlrpc_value *const param_array, void *const user_data)</div><div class="ttdoc">Prepare data connection for source endpoint.</div><div class="ttdef"><b>Definition:</b> <a href="fg__rpc__server_8c_source.html#l00062">fg_rpc_server.c:62</a></div></div>
<div class="ttc" id="astructreport_html_a73a129ba9326de2855f317b55245e4e5"><div class="ttname"><a href="structreport.html#a73a129ba9326de2855f317b55245e4e5">report::rtt_sum</a></div><div class="ttdeci">double rtt_sum</div><div class="ttdoc">Accumulated round-trip time.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00325">common.h:325</a></div></div>
<div class="ttc" id="adestination_8c_html_aedc02107b0adf6f93c12f27e4858582b"><div class="ttname"><a href="destination_8c.html#aedc02107b0adf6f93c12f27e4858582b">accept_data</a></div><div class="ttdeci">int accept_data(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="destination_8c_source.html#l00250">destination.c:250</a></div></div>
<div class="ttc" id="afg__error_8h_html_abe3691984c9be3f886d23938335ea8a1"><div class="ttname"><a href="fg__error_8h.html#abe3691984c9be3f886d23938335ea8a1">crit</a></div><div class="ttdeci">#define crit(...)</div><div class="ttdoc">To report an critical error w/ the corresponding system error message.</div><div class="ttdef"><b>Definition:</b> <a href="fg__error_8h_source.html#l00036">fg_error.h:36</a></div></div>
<div class="ttc" id="astructflow__settings_html_a06c29bb39cf7a6004178e5582949990a"><div class="ttname"><a href="structflow__settings.html#a06c29bb39cf7a6004178e5582949990a">flow_settings::dscp</a></div><div class="ttdeci">int dscp</div><div class="ttdoc">DSCP value for TOS byte (option -D).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00244">common.h:244</a></div></div>
<div class="ttc" id="astructreport_html_abdaec61f3f26be9d4361780367d73e3d"><div class="ttname"><a href="structreport.html#abdaec61f3f26be9d4361780367d73e3d">report::delay_max</a></div><div class="ttdeci">double delay_max</div><div class="ttdoc">Maximum one-way delay.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00317">common.h:317</a></div></div>
<div class="ttc" id="afg__list_8c_html_a1cd905157d4b1df02ae888cc18fc0029"><div class="ttname"><a href="fg__list_8c.html#a1cd905157d4b1df02ae888cc18fc0029">fg_list_remove</a></div><div class="ttdeci">int fg_list_remove(struct linked_list *const list, const void *const data)</div><div class="ttdoc">Removes from the list the first element whose data points to data.</div><div class="ttdef"><b>Definition:</b> <a href="fg__list_8c_source.html#l00065">fg_list.c:65</a></div></div>
<div class="ttc" id="afg__time_8c_html_a801431f54cf89b9f658e3e29b2bba0fe"><div class="ttname"><a href="fg__time_8c.html#a801431f54cf89b9f658e3e29b2bba0fe">time_is_after</a></div><div class="ttdeci">bool time_is_after(const struct timespec *tp1, const struct timespec *tp2)</div><div class="ttdoc">Returns true if second point in time tp2 is chronologically after the first point in time tp1.</div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00110">fg_time.c:110</a></div></div>
<div class="ttc" id="astructreport_html_aec7214fb99ce49098845df88cbfd7a86"><div class="ttname"><a href="structreport.html#aec7214fb99ce49098845df88cbfd7a86">report::request_blocks_written</a></div><div class="ttdeci">unsigned request_blocks_written</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00302">common.h:302</a></div></div>
<div class="ttc" id="adaemon_8h_html_a518951727d690b29538e702125381488"><div class="ttname"><a href="daemon_8h.html#a518951727d690b29538e702125381488">DEFAULT_SELECT_TIMEOUT</a></div><div class="ttdeci">#define DEFAULT_SELECT_TIMEOUT</div><div class="ttdoc">Time select() will block waiting for a file descriptor to become ready.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00051">daemon.h:51</a></div></div>
<div class="ttc" id="atrafgen_8c_html_ae5b2d6c86bbfe838e2168e2d19c9e06d"><div class="ttname"><a href="trafgen_8c.html#ae5b2d6c86bbfe838e2168e2d19c9e06d">next_response_block_size</a></div><div class="ttdeci">int next_response_block_size(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="trafgen_8c_source.html#l00143">trafgen.c:143</a></div></div>
<div class="ttc" id="afg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_ab88cf17f8060108b739b572c66bcac10"><div class="ttname"><a href="structflow_1_1statistics.html#ab88cf17f8060108b739b572c66bcac10">flow::statistics::rtt_sum</a></div><div class="ttdeci">double rtt_sum</div><div class="ttdoc">Accumulated round-trip time.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00154">daemon.h:154</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a02113c8824bad0f80c20102a1756634b"><div class="ttname"><a href="fg__socket_8c.html#a02113c8824bad0f80c20102a1756634b">set_non_blocking</a></div><div class="ttdeci">int set_non_blocking(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00172">fg_socket.c:172</a></div></div>
<div class="ttc" id="astructreport_html_aef54fe7e2baef46bb8e00977474ba566"><div class="ttname"><a href="structreport.html#aef54fe7e2baef46bb8e00977474ba566">report::bytes_read</a></div><div class="ttdeci">unsigned long long bytes_read</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00295">common.h:295</a></div></div>
<div class="ttc" id="astructreport_html_af9381bd31155ddb60adfd66b0ed26ef2"><div class="ttname"><a href="structreport.html#af9381bd31155ddb60adfd66b0ed26ef2">report::iat_sum</a></div><div class="ttdeci">double iat_sum</div><div class="ttdoc">Accumulated inter-arrival time.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00313">common.h:313</a></div></div>
<div class="ttc" id="astructflow__settings_html_a44ef35fc53d7df357f7de2e851694273"><div class="ttname"><a href="structflow__settings.html#a44ef35fc53d7df357f7de2e851694273">flow_settings::extra_socket_options</a></div><div class="ttdeci">struct flow_settings::extra_socket_options extra_socket_options[MAX_EXTRA_SOCKET_OPTIONS]</div></div>
<div class="ttc" id="astructflow_1_1statistics_html_a7522f70d387cfd231efd047d7310d721"><div class="ttname"><a href="structflow_1_1statistics.html#a7522f70d387cfd231efd047d7310d721">flow::statistics::tcp_info</a></div><div class="ttdeci">struct fg_tcp_info tcp_info</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00157">daemon.h:157</a></div></div>
<div class="ttc" id="acommon_8h_html_a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6"><div class="ttname"><a href="common_8h.html#a423620ef7d69894833f70cfc395caaa9acb9be765f361bb7efb9073730aac92c6">READ</a></div><div class="ttdeci">@ READ</div><div class="ttdoc">Read operation.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00108">common.h:108</a></div></div>
<div class="ttc" id="afg__definitions_8h_html_a239dd5192fcd165ce89d2c6d08e34993"><div class="ttname"><a href="fg__definitions_8h.html#a239dd5192fcd165ce89d2c6d08e34993">UNUSED_ARGUMENT</a></div><div class="ttdeci">#define UNUSED_ARGUMENT(x)</div><div class="ttdoc">Suppress warning for unused argument.</div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00038">fg_definitions.h:38</a></div></div>
<div class="ttc" id="acommon_8h_html_a60678bfaa9744c8078a4e317ba203ec0a22f853bba9ebb23d90508dc6496b746c"><div class="ttname"><a href="common_8h.html#a60678bfaa9744c8078a4e317ba203ec0a22f853bba9ebb23d90508dc6496b746c">DESTINATION</a></div><div class="ttdeci">@ DESTINATION</div><div class="ttdoc">Endpoint that accepts the connection.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00100">common.h:100</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_a44935f0f8dda8fa73b41a1b49f4c2e96"><div class="ttname"><a href="structflow_1_1statistics.html#a44935f0f8dda8fa73b41a1b49f4c2e96">flow::statistics::delay_max</a></div><div class="ttdeci">double delay_max</div><div class="ttdoc">Maximum one-way delay.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00146">daemon.h:146</a></div></div>
<div class="ttc" id="astructflow__settings_html_a4f29273c21baece6aabd20a46efdc0c8"><div class="ttname"><a href="structflow__settings.html#a4f29273c21baece6aabd20a46efdc0c8">flow_settings::duration</a></div><div class="ttdeci">double duration[2]</div><div class="ttdoc">Duration of flow in seconds (option -T).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00190">common.h:190</a></div></div>
<div class="ttc" id="astructflow_html_a79abf940bb0e1fbdf027152aa00ba51a"><div class="ttname"><a href="structflow.html#a79abf940bb0e1fbdf027152aa00ba51a">flow::source_settings</a></div><div class="ttdeci">struct flow_source_settings source_settings</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00084">daemon.h:84</a></div></div>
<div class="ttc" id="afg__error_8h_html_ae6cfebfa20e754bd09c394f8bd07f624"><div class="ttname"><a href="fg__error_8h.html#ae6cfebfa20e754bd09c394f8bd07f624">warnx</a></div><div class="ttdeci">#define warnx(...)</div><div class="ttdoc">To report a warning w/ a system error message.</div><div class="ttdef"><b>Definition:</b> <a href="fg__error_8h_source.html#l00054">fg_error.h:54</a></div></div>
<div class="ttc" id="astructflow_html_a94e826d731af3ce59414ab483ff3e4f7"><div class="ttname"><a href="structflow.html#a94e826d731af3ce59414ab483ff3e4f7">flow::pmtu</a></div><div class="ttdeci">int pmtu</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00114">daemon.h:114</a></div></div>
<div class="ttc" id="astructflow__settings_html_ae229f5e5bd4c3689473dcb7b7debea6e"><div class="ttname"><a href="structflow__settings.html#ae229f5e5bd4c3689473dcb7b7debea6e">flow_settings::cork</a></div><div class="ttdeci">int cork</div><div class="ttdoc">Sets SO_DEBUG on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00232">common.h:232</a></div></div>
<div class="ttc" id="astructreport_html_a14340938e5747205d3833a5ae3d3b6c9"><div class="ttname"><a href="structreport.html#a14340938e5747205d3833a5ae3d3b6c9">report::delay_min</a></div><div class="ttdeci">double delay_min</div><div class="ttdoc">Minimum one-way delay.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00315">common.h:315</a></div></div>
<div class="ttc" id="adaemon_8c_html_a59607f45dabe596ae017733d49caafb8"><div class="ttname"><a href="daemon_8c.html#a59607f45dabe596ae017733d49caafb8">start_flows</a></div><div class="ttdeci">static void start_flows(struct request_start_flows *request)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00333">daemon.c:333</a></div></div>
<div class="ttc" id="adaemon_8c_html_a18d77e6b65b799ff7229768b64c4aad9"><div class="ttname"><a href="daemon_8c.html#a18d77e6b65b799ff7229768b64c4aad9">report_flow</a></div><div class="ttdeci">static void report_flow(struct flow *flow, int type)</div><div class="ttdoc">To prepare a report, report type is either INTERVAL or FINAL.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00522">daemon.c:522</a></div></div>
<div class="ttc" id="astructlist__node_html_aaa55c3480c90432991e01545b6ff34b5"><div class="ttname"><a href="structlist__node.html#aaa55c3480c90432991e01545b6ff34b5">list_node::data</a></div><div class="ttdeci">void * data</div><div class="ttdoc">Pointer to user defined data stored with this node.</div><div class="ttdef"><b>Definition:</b> <a href="fg__list_8h_source.html#l00038">fg_list.h:38</a></div></div>
<div class="ttc" id="astructflow_html_a30e6464cf5e91f15049297e4452d120e"><div class="ttname"><a href="structflow.html#a30e6464cf5e91f15049297e4452d120e">flow::next_write_block_timestamp</a></div><div class="ttdeci">struct timespec next_write_block_timestamp</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00095">daemon.h:95</a></div></div>
<div class="ttc" id="astructflow__settings_html_a1206d0f66388f1f916f1ea237453a8db"><div class="ttname"><a href="structflow__settings.html#a1206d0f66388f1f916f1ea237453a8db">flow_settings::cc_alg</a></div><div class="ttdeci">char cc_alg[TCP_CA_NAME_MAX]</div><div class="ttdoc">Set congestion control algorithm ALG on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00236">common.h:236</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_a9319c44e2e7e5cb5e396e118fe5fc7f9"><div class="ttname"><a href="structflow_1_1statistics.html#a9319c44e2e7e5cb5e396e118fe5fc7f9">flow::statistics::delay_min</a></div><div class="ttdeci">double delay_min</div><div class="ttdoc">Minimum one-way delay.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00144">daemon.h:144</a></div></div>
<div class="ttc" id="astructflow_html_abf86c8f5e99971c55bee93782f3c06b4"><div class="ttname"><a href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">flow::settings</a></div><div class="ttdeci">struct flow_settings settings</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00083">daemon.h:83</a></div></div>
<div class="ttc" id="astructflow_html_ac14ab829aa152004c3173af229147c7b"><div class="ttname"><a href="structflow.html#ac14ab829aa152004c3173af229147c7b">flow::last_report_time</a></div><div class="ttdeci">struct timespec last_report_time</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00092">daemon.h:92</a></div></div>
<div class="ttc" id="astructflow_html_ac95c5a7384556d504e9b1312c766d5f5"><div class="ttname"><a href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">flow::read_block</a></div><div class="ttdeci">char * read_block</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00097">daemon.h:97</a></div></div>
<div class="ttc" id="astructreport_html_a0a3773754225984337b3363320143e6e"><div class="ttname"><a href="structreport.html#a0a3773754225984337b3363320143e6e">report::next</a></div><div class="ttdeci">struct report * next</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00338">common.h:338</a></div></div>
<div class="ttc" id="adaemon_8c_html_a23eda314be657f32cde94fc43a19a6d7"><div class="ttname"><a href="daemon_8c.html#a23eda314be657f32cde94fc43a19a6d7">efds</a></div><div class="ttdeci">fd_set efds</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00096">daemon.c:96</a></div></div>
<div class="ttc" id="astructrequest__stop__flow_html"><div class="ttname"><a href="structrequest__stop__flow.html">request_stop_flow</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00227">daemon.h:227</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a128d76deeb39f543de89cf0c52729101"><div class="ttname"><a href="fg__socket_8c.html#a128d76deeb39f543de89cf0c52729101">set_dscp</a></div><div class="ttdeci">int set_dscp(int fd, int dscp)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00132">fg_socket.c:132</a></div></div>
<div class="ttc" id="astructrequest__add__flow__destination_html"><div class="ttname"><a href="structrequest__add__flow__destination.html">request_add_flow_destination</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00193">daemon.h:193</a></div></div>
<div class="ttc" id="afg__socket_8c_html_ab2053a8d245324b11d603cc43b327db5"><div class="ttname"><a href="fg__socket_8c.html#ab2053a8d245324b11d603cc43b327db5">set_tcp_cork</a></div><div class="ttdeci">int set_tcp_cork(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00317">fg_socket.c:317</a></div></div>
<div class="ttc" id="astructrequest__start__flows_html"><div class="ttname"><a href="structrequest__start__flows.html">request_start_flows</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00220">daemon.h:220</a></div></div>
<div class="ttc" id="adaemon_8c_html_a3e2fb6650e86add1d5b6f02ed4625d13"><div class="ttname"><a href="daemon_8c.html#a3e2fb6650e86add1d5b6f02ed4625d13">CPY_INFO_MEMBER</a></div><div class="ttdeci">#define CPY_INFO_MEMBER(a)</div></div>
<div class="ttc" id="afg__definitions_8h_html_a5c2abadb7970717fd8339b059ddd3713"><div class="ttname"><a href="fg__definitions_8h.html#a5c2abadb7970717fd8339b059ddd3713">ASSIGN_MIN</a></div><div class="ttdeci">#define ASSIGN_MIN(s, c)</div><div class="ttdoc">Assign value if it less than current one.</div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00062">fg_definitions.h:62</a></div></div>
<div class="ttc" id="adaemon_8c_html_af02359addacb39f08b62d85d0dc38ed8"><div class="ttname"><a href="daemon_8c.html#af02359addacb39f08b62d85d0dc38ed8">get_uuid_string</a></div><div class="ttdeci">void get_uuid_string(char *uuid_str)</div><div class="ttdoc">To generate daemon UUID.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01536">daemon.c:1536</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_a80c710aaf10a41c6a467d34bd9bac81d"><div class="ttname"><a href="structflow_1_1statistics.html#a80c710aaf10a41c6a467d34bd9bac81d">flow::statistics::bytes_written</a></div><div class="ttdeci">unsigned long long bytes_written</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00125">daemon.h:125</a></div></div>
<div class="ttc" id="adaemon_8c_html_a48bcab4c829140d6115c3b71e5c6ddc9"><div class="ttname"><a href="daemon_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a></div><div class="ttdeci">void uninit_flow(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00165">daemon.c:165</a></div></div>
<div class="ttc" id="afg__time_8c_html_a255d1a882171eae755af0936c3d78951"><div class="ttname"><a href="fg__time_8c.html#a255d1a882171eae755af0936c3d78951">time_diff_now</a></div><div class="ttdeci">double time_diff_now(const struct timespec *tp)</div><div class="ttdoc">Returns time difference between now and the specific point in time tp.</div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00101">fg_time.c:101</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_ae1ba3445791589ef501eb765bd808665"><div class="ttname"><a href="structflow_1_1statistics.html#ae1ba3445791589ef501eb765bd808665">flow::statistics::rtt_max</a></div><div class="ttdeci">double rtt_max</div><div class="ttdoc">Maximum round-trip time.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00152">daemon.h:152</a></div></div>
<div class="ttc" id="adaemon_8c_html_ac65409d904781e5a23529bd6bef2b673"><div class="ttname"><a href="daemon_8c.html#ac65409d904781e5a23529bd6bef2b673">SOL_TCP</a></div><div class="ttdeci">#define SOL_TCP</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00078">daemon.c:78</a></div></div>
<div class="ttc" id="astructrequest_html_a76afbbb7cbf4b0627459b37b75062b40"><div class="ttname"><a href="structrequest.html#a76afbbb7cbf4b0627459b37b75062b40">request::type</a></div><div class="ttdeci">char type</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00181">daemon.h:181</a></div></div>
<div class="ttc" id="astructreport_html"><div class="ttname"><a href="structreport.html">report</a></div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00286">common.h:286</a></div></div>
<div class="ttc" id="astructflow__settings_html_a3aee86084eac437051355cce738de2ef"><div class="ttname"><a href="structflow__settings.html#a3aee86084eac437051355cce738de2ef">flow_settings::traffic_dump</a></div><div class="ttdeci">int traffic_dump</div><div class="ttdoc">Dump traffic using libpcap (option -M).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00204">common.h:204</a></div></div>
<div class="ttc" id="adaemon_8c_html_a7dd776b27a8695d29a8f178ddb26a2eb"><div class="ttname"><a href="daemon_8c.html#a7dd776b27a8695d29a8f178ddb26a2eb">reports_last</a></div><div class="ttdeci">struct report * reports_last</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00100">daemon.c:100</a></div></div>
<div class="ttc" id="astructflow_html_a4e9e4493f32b9f3cd4c520a399a17bac"><div class="ttname"><a href="structflow.html#a4e9e4493f32b9f3cd4c520a399a17bac">flow::current_block_bytes_read</a></div><div class="ttdeci">unsigned current_block_bytes_read</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00103">daemon.h:103</a></div></div>
<div class="ttc" id="adaemon_8c_html_a4acff8232e4aec9cd5c6dc200ac55ef3"><div class="ttname"><a href="daemon_8c.html#a4acff8232e4aec9cd5c6dc200ac55ef3">mutex</a></div><div class="ttdeci">pthread_mutex_t mutex</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00093">daemon.c:93</a></div></div>
<div class="ttc" id="astructflow__settings_html_a182d573decbb50a7691ab088dd630a54"><div class="ttname"><a href="structflow__settings.html#a182d573decbb50a7691ab088dd630a54">flow_settings::ipmtudiscover</a></div><div class="ttdeci">int ipmtudiscover</div><div class="ttdoc">Set IP_MTU_DISCOVER on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00246">common.h:246</a></div></div>
<div class="ttc" id="afg__socket_8c_html_ac2ddd7ff0e28617a498b922b85ad9e29"><div class="ttname"><a href="fg__socket_8c.html#ac2ddd7ff0e28617a498b922b85ad9e29">set_tcp_nodelay</a></div><div class="ttdeci">int set_tcp_nodelay(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00358">fg_socket.c:358</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a2c49d58f3483817990c8b7c732891ffd"><div class="ttname"><a href="fg__socket_8c.html#a2c49d58f3483817990c8b7c732891ffd">set_so_debug</a></div><div class="ttdeci">int set_so_debug(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00366">fg_socket.c:366</a></div></div>
<div class="ttc" id="adaemon_8c_html_a54c3849a22e7bc35672dd1e04c34f5fc"><div class="ttname"><a href="daemon_8c.html#a54c3849a22e7bc35672dd1e04c34f5fc">process_iat</a></div><div class="ttdeci">static void process_iat(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01234">daemon.c:1234</a></div></div>
<div class="ttc" id="astructflow__settings_html_a89b7f00123725264aab18759d7bc7258"><div class="ttname"><a href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">flow_settings::maximum_block_size</a></div><div class="ttdeci">int maximum_block_size</div><div class="ttdoc">Application buffer size in bytes (option -U).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00201">common.h:201</a></div></div>
<div class="ttc" id="astructflow__source__settings_html_a6e94ce54173e1dfc09a560894ed2b3c3"><div class="ttname"><a href="structflow__source__settings.html#a6e94ce54173e1dfc09a560894ed2b3c3">flow_source_settings::late_connect</a></div><div class="ttdeci">int late_connect</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00068">daemon.h:68</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a82d86f7f3d35cb6f06c2cb9f57955d87"><div class="ttname"><a href="fg__socket_8c.html#a82d86f7f3d35cb6f06c2cb9f57955d87">set_so_elcn</a></div><div class="ttdeci">int set_so_elcn(int fd, int val)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00278">fg_socket.c:278</a></div></div>
<div class="ttc" id="astructflow__settings_html_a9b37b291808623d607848c54c48f19f4"><div class="ttname"><a href="structflow__settings.html#a9b37b291808623d607848c54c48f19f4">flow_settings::flow_control</a></div><div class="ttdeci">int flow_control</div><div class="ttdoc">Stop flow if it is experiencing local congestion (option -C).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00226">common.h:226</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_a4f102ee40bfd0fcfe231aac54554787d"><div class="ttname"><a href="structflow_1_1statistics.html#a4f102ee40bfd0fcfe231aac54554787d">flow::statistics::response_blocks_written</a></div><div class="ttdeci">unsigned response_blocks_written</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00133">daemon.h:133</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a2534f3f0b9b8526b2e30d9941f7e2dcf"><div class="ttname"><a href="fg__socket_8c.html#a2534f3f0b9b8526b2e30d9941f7e2dcf">toggle_tcp_cork</a></div><div class="ttdeci">int toggle_tcp_cork(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00331">fg_socket.c:331</a></div></div>
<div class="ttc" id="astructrequest__add__flow__source_html"><div class="ttname"><a href="structrequest__add__flow__source.html">request_add_flow_source</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00206">daemon.h:206</a></div></div>
<div class="ttc" id="adaemon_8c_html_a33febb18ddf50438a47e5eee54be6c77"><div class="ttname"><a href="daemon_8c.html#a33febb18ddf50438a47e5eee54be6c77">pending_reports</a></div><div class="ttdeci">unsigned pending_reports</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00101">daemon.c:101</a></div></div>
<div class="ttc" id="astructrequest_html"><div class="ttname"><a href="structrequest.html">request</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00179">daemon.h:179</a></div></div>
<div class="ttc" id="astructreport_html_ab0b9886231083d13efdd5e0e01038cc3"><div class="ttname"><a href="structreport.html#ab0b9886231083d13efdd5e0e01038cc3">report::iat_max</a></div><div class="ttdeci">double iat_max</div><div class="ttdoc">Maximum inter-arrival time.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00311">common.h:311</a></div></div>
<div class="ttc" id="astructflow_html_a74df07d93cabc54a4b43f53fb90d7eb6"><div class="ttname"><a href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">flow::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00170">daemon.h:170</a></div></div>
<div class="ttc" id="afg__time_8c_html_a171ccad0a7b8941cc4a1f366c2e34c4c"><div class="ttname"><a href="fg__time_8c.html#a171ccad0a7b8941cc4a1f366c2e34c4c">ctimespec_r</a></div><div class="ttdeci">const char * ctimespec_r(const struct timespec *tp, char *buf, size_t size, bool ns)</div><div class="ttdoc">Converts timespec struct tp into a null-terminated string.</div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00066">fg_time.c:66</a></div></div>
<div class="ttc" id="astructrequest_html_a37274d635f4592bd537b14b1956bde52"><div class="ttname"><a href="structrequest.html#a37274d635f4592bd537b14b1956bde52">request::next</a></div><div class="ttdeci">struct request * next</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00189">daemon.h:189</a></div></div>
<div class="ttc" id="astructflow_html_afa482adb3d3445e276a009a895bd3dda"><div class="ttname"><a href="structflow.html#afa482adb3d3445e276a009a895bd3dda">flow::current_write_block_size</a></div><div class="ttdeci">unsigned current_write_block_size</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00100">daemon.h:100</a></div></div>
<div class="ttc" id="adaemon_8h_html_ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c"><div class="ttname"><a href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c">GRIND_WAIT_CONNECT</a></div><div class="ttdeci">@ GRIND_WAIT_CONNECT</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00056">daemon.h:56</a></div></div>
<div class="ttc" id="adaemon_8c_html_a5c8ad0b474e5da9a984f42d401e58d9c"><div class="ttname"><a href="daemon_8c.html#a5c8ad0b474e5da9a984f42d401e58d9c">requests_last</a></div><div class="ttdeci">struct request * requests_last</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00094">daemon.c:94</a></div></div>
<div class="ttc" id="adaemon_8h_html_ab8dcbe03f47dda503913a20c52bf4de7a30e50ffb173bb9b94042b020c00308a8"><div class="ttname"><a href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a30e50ffb173bb9b94042b020c00308a8">GRIND_WAIT_ACCEPT</a></div><div class="ttdeci">@ GRIND_WAIT_ACCEPT</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00058">daemon.h:58</a></div></div>
<div class="ttc" id="adaemon_8c_html_a69bcdf37a6bd08046dc8f0fd3fee8d6a"><div class="ttname"><a href="daemon_8c.html#a69bcdf37a6bd08046dc8f0fd3fee8d6a">prepare_fds</a></div><div class="ttdeci">static int prepare_fds()</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00267">daemon.c:267</a></div></div>
<div class="ttc" id="adaemon_8c_html_aaa94c4a05963e33561e701944c82d645"><div class="ttname"><a href="daemon_8c.html#aaa94c4a05963e33561e701944c82d645">requests</a></div><div class="ttdeci">struct request * requests</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00094">daemon.c:94</a></div></div>
<div class="ttc" id="afg__socket_8c_html_abeb6cde31aa19f818745d2bffed938b4"><div class="ttname"><a href="fg__socket_8c.html#abeb6cde31aa19f818745d2bffed938b4">get_pmtu</a></div><div class="ttdeci">int get_pmtu(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00193">fg_socket.c:193</a></div></div>
<div class="ttc" id="astructflow__settings_html_a7e76c24f63b5771588d75e427d3df2cc"><div class="ttname"><a href="structflow__settings.html#a7e76c24f63b5771588d75e427d3df2cc">flow_settings::num_extra_socket_options</a></div><div class="ttdeci">int num_extra_socket_options</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00262">common.h:262</a></div></div>
<div class="ttc" id="adaemon_8c_html_a6457b4c850a146e92e6d9c3556306b5d"><div class="ttname"><a href="daemon_8c.html#a6457b4c850a146e92e6d9c3556306b5d">process_delay</a></div><div class="ttdeci">static void process_delay(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01267">daemon.c:1267</a></div></div>
<div class="ttc" id="astructflow__settings_html_addf539178c60faab6c8fee7a54630fbc"><div class="ttname"><a href="structflow__settings.html#addf539178c60faab6c8fee7a54630fbc">flow_settings::pushy</a></div><div class="ttdeci">int pushy</div><div class="ttdoc">Do not iterate through select() to continue sending in case block size did not suffice to fill sendin...</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00213">common.h:213</a></div></div>
<div class="ttc" id="adaemon_8c_html_a842c9355b4c0c828fdae26b790006a19"><div class="ttname"><a href="daemon_8c.html#a842c9355b4c0c828fdae26b790006a19">flow_sending</a></div><div class="ttdeci">static int flow_sending(struct timespec *now, struct flow *flow, int direction)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00152">daemon.c:152</a></div></div>
<div class="ttc" id="astructflow_html_a4f2eda16bd6129bc3057fa38b080a486"><div class="ttname"><a href="structflow.html#a4f2eda16bd6129bc3057fa38b080a486">flow::endpoint</a></div><div class="ttdeci">enum endpoint_t endpoint</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00078">daemon.h:78</a></div></div>
<div class="ttc" id="afg__math_8c_html_a84e0bc4337726d56f9fb3c935e1cc170"><div class="ttname"><a href="fg__math_8c.html#a84e0bc4337726d56f9fb3c935e1cc170">init_math_functions</a></div><div class="ttdeci">void init_math_functions(struct flow *flow, unsigned long seed)</div><div class="ttdef"><b>Definition:</b> <a href="fg__math_8c_source.html#l00058">fg_math.c:58</a></div></div>
<div class="ttc" id="adaemon_8c_html_aa1f5aec48271ef6205d79be756decdc4"><div class="ttname"><a href="daemon_8c.html#aa1f5aec48271ef6205d79be756decdc4">stop_flow</a></div><div class="ttdeci">static void stop_flow(struct request_stop_flow *request)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00382">daemon.c:382</a></div></div>
<div class="ttc" id="astructflow__settings_html_af1d11c3e1d43f04babc48c1c002a31ac"><div class="ttname"><a href="structflow__settings.html#af1d11c3e1d43f04babc48c1c002a31ac">flow_settings::nonagle</a></div><div class="ttdeci">int nonagle</div><div class="ttdoc">Disable nagle algorithm on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00234">common.h:234</a></div></div>
<div class="ttc" id="astructrequest_html_acc214191f4fbfabdedf789adc862b393"><div class="ttname"><a href="structrequest.html#acc214191f4fbfabdedf789adc862b393">request::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00187">daemon.h:187</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a9f03da778d202b26f33b7d463181856e"><div class="ttname"><a href="fg__socket_8c.html#a9f03da778d202b26f33b7d463181856e">set_so_lcd</a></div><div class="ttdeci">int set_so_lcd(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00288">fg_socket.c:288</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a28705e5f3da83f4c8721e547c41687c4"><div class="ttname"><a href="fg__socket_8c.html#a28705e5f3da83f4c8721e547c41687c4">set_ip_mtu_discover</a></div><div class="ttdeci">int set_ip_mtu_discover(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00300">fg_socket.c:300</a></div></div>
<div class="ttc" id="acommon_8h_html_ac1f29ba54415975a2fa23e276fdf8a0f"><div class="ttname"><a href="common_8h.html#ac1f29ba54415975a2fa23e276fdf8a0f">MIN_BLOCK_SIZE</a></div><div class="ttdeci">#define MIN_BLOCK_SIZE</div><div class="ttdoc">Minium block (message) size we can send.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00079">common.h:79</a></div></div>
<div class="ttc" id="adaemon_8c_html_a76e143faa3209e1a2cc97ddbfc7cba59"><div class="ttname"><a href="daemon_8c.html#a76e143faa3209e1a2cc97ddbfc7cba59">flow_in_delay</a></div><div class="ttdeci">static int flow_in_delay(struct timespec *now, struct flow *flow, int direction)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00145">daemon.c:145</a></div></div>
<div class="ttc" id="astructflow_html_a17fe9a16d079930fa345a6fc635fa1da"><div class="ttname"><a href="structflow.html#a17fe9a16d079930fa345a6fc635fa1da">flow::listenfd_data</a></div><div class="ttdeci">int listenfd_data</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00081">daemon.h:81</a></div></div>
<div class="ttc" id="adaemon_8c_html_a0ceff22a02b22f3826a753ad12b102e7"><div class="ttname"><a href="daemon_8c.html#a0ceff22a02b22f3826a753ad12b102e7">prepare_rfds</a></div><div class="ttdeci">static int prepare_rfds(struct timespec *now, struct flow *flow, fd_set *rfds)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00233">daemon.c:233</a></div></div>
<div class="ttc" id="astructreport_html_a7330324173edbf9bb4f0efc9b7a534ab"><div class="ttname"><a href="structreport.html#a7330324173edbf9bb4f0efc9b7a534ab">report::bytes_written</a></div><div class="ttdeci">unsigned long long bytes_written</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00296">common.h:296</a></div></div>
<div class="ttc" id="adaemon_8c_html_abc7b750d30fa56acd31644f53be03ca5"><div class="ttname"><a href="daemon_8c.html#abc7b750d30fa56acd31644f53be03ca5">process_requests</a></div><div class="ttdeci">static void process_requests()</div><div class="ttdoc">To process the request issued from the controller.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00446">daemon.c:446</a></div></div>
<div class="ttc" id="astructflow__settings_html_ad632a70ea0d27ceefb51e2a8059a0dae"><div class="ttname"><a href="structflow__settings.html#ad632a70ea0d27ceefb51e2a8059a0dae">flow_settings::reporting_interval</a></div><div class="ttdeci">double reporting_interval</div><div class="ttdoc">Interval to report flow on screen (option -i).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00193">common.h:193</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_aec0e10ce5d0c7205464fcd0ffad8c232"><div class="ttname"><a href="structflow_1_1statistics.html#aec0e10ce5d0c7205464fcd0ffad8c232">flow::statistics::has_tcp_info</a></div><div class="ttdeci">int has_tcp_info</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00156">daemon.h:156</a></div></div>
<div class="ttc" id="adaemon_8c_html_ab47d21199a51be6e1b9334d25049bd66"><div class="ttname"><a href="daemon_8c.html#ab47d21199a51be6e1b9334d25049bd66">write_data</a></div><div class="ttdeci">static int write_data(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00937">daemon.c:937</a></div></div>
<div class="ttc" id="afg__socket_8c_html_af08fd91d990fe9481090aaf7f5efabdb"><div class="ttname"><a href="fg__socket_8c.html#af08fd91d990fe9481090aaf7f5efabdb">set_route_record</a></div><div class="ttdeci">int set_route_record(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00149">fg_socket.c:149</a></div></div>
<div class="ttc" id="adaemon_8c_html_afea7e1b0e3888d8d15f970c32e1ff290"><div class="ttname"><a href="daemon_8c.html#afea7e1b0e3888d8d15f970c32e1ff290">try_read_n_bytes</a></div><div class="ttdeci">static int try_read_n_bytes(struct flow *flow, int bytes)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01054">daemon.c:1054</a></div></div>
<div class="ttc" id="acommon_8h_html_a60678bfaa9744c8078a4e317ba203ec0a0159491ea913604389155db907e0d1c0"><div class="ttname"><a href="common_8h.html#a60678bfaa9744c8078a4e317ba203ec0a0159491ea913604389155db907e0d1c0">SOURCE</a></div><div class="ttdeci">@ SOURCE</div><div class="ttdoc">Endpoint that opens the connection.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00098">common.h:98</a></div></div>
<div class="ttc" id="astructflow__settings_html_a773a21e329a31811844f9f26da458e62"><div class="ttname"><a href="structflow__settings.html#a773a21e329a31811844f9f26da458e62">flow_settings::elcn</a></div><div class="ttdeci">int elcn</div><div class="ttdoc">Set TCP_ELCN (20) on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00238">common.h:238</a></div></div>
<div class="ttc" id="adaemon_8c_html_a7a13a361801dcc59ce4946736fa26726"><div class="ttname"><a href="daemon_8c.html#a7a13a361801dcc59ce4946736fa26726">maxfd</a></div><div class="ttdeci">int maxfd</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00097">daemon.c:97</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_a8e6173d615bbb6ab389b160e182b429d"><div class="ttname"><a href="structflow_1_1statistics.html#a8e6173d615bbb6ab389b160e182b429d">flow::statistics::request_blocks_read</a></div><div class="ttdeci">unsigned request_blocks_read</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00130">daemon.h:130</a></div></div>
<div class="ttc" id="astructreport_html_acbd4824b0e80be7694c7b7ec9e71166a"><div class="ttname"><a href="structreport.html#acbd4824b0e80be7694c7b7ec9e71166a">report::pmtu</a></div><div class="ttdeci">unsigned pmtu</div><div class="ttdoc">Discovered Path MTU.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00332">common.h:332</a></div></div>
<div class="ttc" id="astructflow_html_a8c89f7316d6e7fab40989f40ac8a972d"><div class="ttname"><a href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">flow::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00080">daemon.h:80</a></div></div>
<div class="ttc" id="adaemon_8c_html_a6391a90ddf873c2555b842a474fb9309"><div class="ttname"><a href="daemon_8c.html#a6391a90ddf873c2555b842a474fb9309">wfds</a></div><div class="ttdeci">fd_set wfds</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00096">daemon.c:96</a></div></div>
<div class="ttc" id="astructblock_html"><div class="ttname"><a href="structblock.html">block</a></div><div class="ttdoc">Flowgrind's data block layout.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00148">common.h:148</a></div></div>
<div class="ttc" id="astructflow_html_a869a73927029efaf89a23c52e6de9eb7"><div class="ttname"><a href="structflow.html#a869a73927029efaf89a23c52e6de9eb7">flow::finished</a></div><div class="ttdeci">char finished[2]</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00112">daemon.h:112</a></div></div>
<div class="ttc" id="adaemon_8c_html_a2b81f4cc8f5217b1d4ffa4a437377429"><div class="ttname"><a href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a></div><div class="ttdeci">void flow_error(struct flow *flow, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00119">daemon.c:119</a></div></div>
<div class="ttc" id="astructflow_html_a55e06ae7dea1322b0da97d930e81e01f"><div class="ttname"><a href="structflow.html#a55e06ae7dea1322b0da97d930e81e01f">flow::last_block_read</a></div><div class="ttdeci">struct timespec last_block_read</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00088">daemon.h:88</a></div></div>
<div class="ttc" id="adaemon_8c_html_ae5808c1a8a4f235184150b7fb30bc287"><div class="ttname"><a href="daemon_8c.html#ae5808c1a8a4f235184150b7fb30bc287">send_response</a></div><div class="ttdeci">static void send_response(struct flow *flow, int requested_response_block_size)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01298">daemon.c:1298</a></div></div>
<div class="ttc" id="astructflow__settings_html_a65188cf299b16d1dbc05ceba51d2328a"><div class="ttname"><a href="structflow__settings.html#a65188cf299b16d1dbc05ceba51d2328a">flow_settings::delay</a></div><div class="ttdeci">double delay[2]</div><div class="ttdoc">Delay of flow in seconds (option -Y).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00188">common.h:188</a></div></div>
<div class="ttc" id="astructflow_html_ac032e656440cac4f092ba3129b3e33a1"><div class="ttname"><a href="structflow.html#ac032e656440cac4f092ba3129b3e33a1">flow::congestion_counter</a></div><div class="ttdeci">unsigned congestion_counter</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00116">daemon.h:116</a></div></div>
<div class="ttc" id="adaemon_8h_html_a98e181f48db2db4c7cbf28cde6f9232a"><div class="ttname"><a href="daemon_8h.html#a98e181f48db2db4c7cbf28cde6f9232a">REQUEST_GET_STATUS</a></div><div class="ttdeci">#define REQUEST_GET_STATUS</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00177">daemon.h:177</a></div></div>
<div class="ttc" id="adaemon_8c_html_a5981029394ee67ad583f0319dc9468b5"><div class="ttname"><a href="daemon_8c.html#a5981029394ee67ad583f0319dc9468b5">reports</a></div><div class="ttdeci">struct report * reports</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00099">daemon.c:99</a></div></div>
<div class="ttc" id="adaemon_8c_html_a1f781d43f485b8fc44f0374bfd0b0a90"><div class="ttname"><a href="daemon_8c.html#a1f781d43f485b8fc44f0374bfd0b0a90">process_select</a></div><div class="ttdeci">static void process_select(fd_set *rfds, fd_set *wfds, fd_set *efds)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00729">daemon.c:729</a></div></div>
<div class="ttc" id="astructreport_html_ac70e6c6ed639f5d93f9391e33e29a44f"><div class="ttname"><a href="structreport.html#ac70e6c6ed639f5d93f9391e33e29a44f">report::status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00336">common.h:336</a></div></div>
<div class="ttc" id="afg__error_8h_html_a8224a361dddd2ad59b411982e5ea746f"><div class="ttname"><a href="fg__error_8h.html#a8224a361dddd2ad59b411982e5ea746f">warn</a></div><div class="ttdeci">#define warn(...)</div><div class="ttdoc">To report a warning w/ the corresponding system error message.</div><div class="ttdef"><b>Definition:</b> <a href="fg__error_8h_source.html#l00050">fg_error.h:50</a></div></div>
<div class="ttc" id="astructflow__settings_html_aa16b93831301f5b6faf010158327cf67"><div class="ttname"><a href="structflow__settings.html#aa16b93831301f5b6faf010158327cf67">flow_settings::lcd</a></div><div class="ttdeci">int lcd</div><div class="ttdoc">Set TCP_LCD (21) on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00240">common.h:240</a></div></div>
<div class="ttc" id="afg__definitions_8h_html_a9735559a214ac1d8d9f8ceddfaeca672"><div class="ttname"><a href="fg__definitions_8h.html#a9735559a214ac1d8d9f8ceddfaeca672">free_all</a></div><div class="ttdeci">#define free_all(...)</div><div class="ttdoc">To free() an arbitrary number of variables.</div><div class="ttdef"><b>Definition:</b> <a href="fg__definitions_8h_source.html#l00059">fg_definitions.h:59</a></div></div>
<div class="ttc" id="astructreport_html_a6868860ad81a10e0bb9d842cb930b0ab"><div class="ttname"><a href="structreport.html#a6868860ad81a10e0bb9d842cb930b0ab">report::delay_sum</a></div><div class="ttdeci">double delay_sum</div><div class="ttdoc">Accumulated one-way delay.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00319">common.h:319</a></div></div>
<div class="ttc" id="astructflow_html_a65aa5ef64b2308b297a95c1160200fdc"><div class="ttname"><a href="structflow.html#a65aa5ef64b2308b297a95c1160200fdc">flow::addr</a></div><div class="ttdeci">struct sockaddr * addr</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00119">daemon.h:119</a></div></div>
<div class="ttc" id="acommon_8h_html_a413eaa5f6866b1c5f00fc612e7afadc5acadbb25555e5ecf1657bd5fee1b41e66"><div class="ttname"><a href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5acadbb25555e5ecf1657bd5fee1b41e66">level_ipproto_ip</a></div><div class="ttdeci">@ level_ipproto_ip</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00123">common.h:123</a></div></div>
<div class="ttc" id="adaemon_8c_html_a19814f177a4fae8c2aa668ce99361bad"><div class="ttname"><a href="daemon_8c.html#a19814f177a4fae8c2aa668ce99361bad">flow_block_scheduled</a></div><div class="ttdeci">static int flow_block_scheduled(struct timespec *now, struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00160">daemon.c:160</a></div></div>
<div class="ttc" id="astructflow_html_a38257f57bf1c4d26c1d50c02630c744d"><div class="ttname"><a href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">flow::write_block</a></div><div class="ttdeci">char * write_block</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00098">daemon.h:98</a></div></div>
<div class="ttc" id="astructrequest_html_adf85beff9f9a1191e2c9985fde174282"><div class="ttname"><a href="structrequest.html#adf85beff9f9a1191e2c9985fde174282">request::condition</a></div><div class="ttdeci">pthread_cond_t * condition</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00185">daemon.h:185</a></div></div>
<div class="ttc" id="astructrequest__get__uuid_html"><div class="ttname"><a href="structrequest__get__uuid.html">request_get_uuid</a></div><div class="ttdoc">structure for getting the UUID.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00240">daemon.h:240</a></div></div>
<div class="ttc" id="adaemon_8c_html_a114a7eaf522519c4b3efbefb5fc069cf"><div class="ttname"><a href="daemon_8c.html#a114a7eaf522519c4b3efbefb5fc069cf">daemon_pipe</a></div><div class="ttdeci">int daemon_pipe[2]</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00087">daemon.c:87</a></div></div>
<div class="ttc" id="astructreport_html_a41799abc2e9f9df843fa4a62079de7d5"><div class="ttname"><a href="structreport.html#a41799abc2e9f9df843fa4a62079de7d5">report::response_blocks_written</a></div><div class="ttdeci">unsigned response_blocks_written</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00304">common.h:304</a></div></div>
<div class="ttc" id="astructflow_html_a31e674b599e405413d0695136a443666"><div class="ttname"><a href="structflow.html#a31e674b599e405413d0695136a443666">flow::last_block_written</a></div><div class="ttdeci">struct timespec last_block_written</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00089">daemon.h:89</a></div></div>
<div class="ttc" id="afg__math_8c_html_a5aed7ddaa34761ec72f7e862813e9832"><div class="ttname"><a href="fg__math_8c.html#a5aed7ddaa34761ec72f7e862813e9832">free_math_functions</a></div><div class="ttdeci">void free_math_functions(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="fg__math_8c_source.html#l00097">fg_math.c:97</a></div></div>
<div class="ttc" id="astructblock_html_a2120c3e22dba4ab13388bc2c32d2046a"><div class="ttname"><a href="structblock.html#a2120c3e22dba4ab13388bc2c32d2046a">block::data</a></div><div class="ttdeci">struct timespec data</div><div class="ttdoc">Sending timestap for calculating delay and RTT.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00160">common.h:160</a></div></div>
<div class="ttc" id="astructflow_html_ab7176e838d97cf4f2e2df0fe8ca31baa"><div class="ttname"><a href="structflow.html#ab7176e838d97cf4f2e2df0fe8ca31baa">flow::state</a></div><div class="ttdeci">enum flow_state_t state</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00077">daemon.h:77</a></div></div>
<div class="ttc" id="astructrequest__get__uuid_html_a7738b09b8e9ab801adc04835cb573a3c"><div class="ttname"><a href="structrequest__get__uuid.html#a7738b09b8e9ab801adc04835cb573a3c">request_get_uuid::r</a></div><div class="ttdeci">struct request r</div><div class="ttdoc">Daemon thread process the request r.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00242">daemon.h:242</a></div></div>
<div class="ttc" id="acommon_8h_html_a413eaa5f6866b1c5f00fc612e7afadc5a36587752a2be3a063f382c0997e8f36e"><div class="ttname"><a href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5a36587752a2be3a063f382c0997e8f36e">level_ipproto_sctp</a></div><div class="ttdeci">@ level_ipproto_sctp</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00124">common.h:124</a></div></div>
<div class="ttc" id="adaemon_8c_html_ad037eac03b0881ffc9647c45daff87f5"><div class="ttname"><a href="daemon_8c.html#ad037eac03b0881ffc9647c45daff87f5">get_tcp_info</a></div><div class="ttdeci">int get_tcp_info(struct flow *flow, struct fg_tcp_info *info)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00650">daemon.c:650</a></div></div>
<div class="ttc" id="astructflow_html_a9a3f07a95a7e900577be6067ccd0779d"><div class="ttname"><a href="structflow.html#a9a3f07a95a7e900577be6067ccd0779d">flow::stop_timestamp</a></div><div class="ttdeci">struct timespec stop_timestamp[2]</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00087">daemon.h:87</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_a836b134622386d1fc94becbcc117cb32"><div class="ttname"><a href="structflow_1_1statistics.html#a836b134622386d1fc94becbcc117cb32">flow::statistics::bytes_read</a></div><div class="ttdeci">unsigned long long bytes_read</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00124">daemon.h:124</a></div></div>
<div class="ttc" id="astructflow_html_aa1cfbf41ded33437a919e4ec1a7eb0c0"><div class="ttname"><a href="structflow.html#aa1cfbf41ded33437a919e4ec1a7eb0c0">flow::start_timestamp</a></div><div class="ttdeci">struct timespec start_timestamp[2]</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00086">daemon.h:86</a></div></div>
<div class="ttc" id="acommon_8h_html_a413eaa5f6866b1c5f00fc612e7afadc5a091198499b13ce6a4672143fbea3527e"><div class="ttname"><a href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5a091198499b13ce6a4672143fbea3527e">level_sol_tcp</a></div><div class="ttdeci">@ level_sol_tcp</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00122">common.h:122</a></div></div>
<div class="ttc" id="astructflow_html_a2a332248f5cbd611defef89722b64060"><div class="ttname"><a href="structflow.html#a2a332248f5cbd611defef89722b64060">flow::next_report_time</a></div><div class="ttdeci">struct timespec next_report_time</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00093">daemon.h:93</a></div></div>
<div class="ttc" id="atrafgen_8c_html_ae3ebec7eeb55c6bfb03341576327e322"><div class="ttname"><a href="trafgen_8c.html#ae3ebec7eeb55c6bfb03341576327e322">next_interpacket_gap</a></div><div class="ttdeci">double next_interpacket_gap(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="trafgen_8c_source.html#l00173">trafgen.c:173</a></div></div>
<div class="ttc" id="astructreport_html_ad501f3629fd9df5887dde4de44d02f45"><div class="ttname"><a href="structreport.html#ad501f3629fd9df5887dde4de44d02f45">report::type</a></div><div class="ttdeci">enum report_t type</div><div class="ttdoc">Report type - either INTERVAL or FINAL report.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00291">common.h:291</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_ae760d10eb27eae961db503b03b693fd7"><div class="ttname"><a href="structflow_1_1statistics.html#ae760d10eb27eae961db503b03b693fd7">flow::statistics::request_blocks_written</a></div><div class="ttdeci">unsigned request_blocks_written</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00131">daemon.h:131</a></div></div>
<div class="ttc" id="afg__error_8h_html_a2d766a2a0ebfa282ee1d89dbe8fd0e81"><div class="ttname"><a href="fg__error_8h.html#a2d766a2a0ebfa282ee1d89dbe8fd0e81">warnc</a></div><div class="ttdeci">#define warnc(code,...)</div><div class="ttdoc">To report a warning w/ the system error message 'code'.</div><div class="ttdef"><b>Definition:</b> <a href="fg__error_8h_source.html#l00052">fg_error.h:52</a></div></div>
<div class="ttc" id="astructflow__settings_html_a58ee2ce95a7ee3b8d2a06f3a55ccaf07"><div class="ttname"><a href="structflow__settings.html#a58ee2ce95a7ee3b8d2a06f3a55ccaf07">flow_settings::shutdown</a></div><div class="ttdeci">int shutdown</div><div class="ttdoc">Shutdown socket after test flow (option -N).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00215">common.h:215</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a5c7f422f6d53d7f12b6aeba065bb94f2"><div class="ttname"><a href="fg__socket_8c.html#a5c7f422f6d53d7f12b6aeba065bb94f2">get_imtu</a></div><div class="ttdeci">int get_imtu(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00214">fg_socket.c:214</a></div></div>
<div class="ttc" id="astructlist__node_html"><div class="ttname"><a href="structlist__node.html">list_node</a></div><div class="ttdoc">Single element in a doubly linked list.</div><div class="ttdef"><b>Definition:</b> <a href="fg__list_8h_source.html#l00036">fg_list.h:36</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_aff32ca848eebe991a7a8cf56bf153288"><div class="ttname"><a href="structflow_1_1statistics.html#aff32ca848eebe991a7a8cf56bf153288">flow::statistics::iat_max</a></div><div class="ttdeci">double iat_max</div><div class="ttdoc">Maximum interarrival time.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00140">daemon.h:140</a></div></div>
<div class="ttc" id="atrafgen_8c_html_adbe1cce2507b35cccf9f8941b152882c"><div class="ttname"><a href="trafgen_8c.html#adbe1cce2507b35cccf9f8941b152882c">next_request_block_size</a></div><div class="ttdeci">int next_request_block_size(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="trafgen_8c_source.html#l00107">trafgen.c:107</a></div></div>
<div class="ttc" id="adaemon_8c_html_a2f0a3334efe08cf776194c1c394cdce2"><div class="ttname"><a href="daemon_8c.html#a2f0a3334efe08cf776194c1c394cdce2">read_data</a></div><div class="ttdeci">static int read_data(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01113">daemon.c:1113</a></div></div>
<div class="ttc" id="adaemon_8c_html_aa6736f2aabb00598230614cdc3ec1a76"><div class="ttname"><a href="daemon_8c.html#aa6736f2aabb00598230614cdc3ec1a76">remove_flow</a></div><div class="ttdeci">void remove_flow(struct flow *const flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00191">daemon.c:191</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_a3b4ab703ab22b6192777b859553a3594"><div class="ttname"><a href="structflow_1_1statistics.html#a3b4ab703ab22b6192777b859553a3594">flow::statistics::rtt_min</a></div><div class="ttdeci">double rtt_min</div><div class="ttdoc">Minimum round-trip time.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00150">daemon.h:150</a></div></div>
<div class="ttc" id="astructblock_html_a00ce1454700612ad01fb7d9caaff9663"><div class="ttname"><a href="structblock.html#a00ce1454700612ad01fb7d9caaff9663">block::data2</a></div><div class="ttdeci">struct timespec data2</div><div class="ttdoc">Used to access 64bit timespec on 32bit arch.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00162">common.h:162</a></div></div>
<div class="ttc" id="adaemon_8c_html_a0a01949c50bc8128d13198fce302a021"><div class="ttname"><a href="daemon_8c.html#a0a01949c50bc8128d13198fce302a021">add_report</a></div><div class="ttdeci">void add_report(struct report *report)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00827">daemon.c:827</a></div></div>
<div class="ttc" id="astructreport_html_af9a9df70cefb7cdb4d3906bc49409d23"><div class="ttname"><a href="structreport.html#af9a9df70cefb7cdb4d3906bc49409d23">report::endpoint</a></div><div class="ttdeci">enum endpoint_t endpoint</div><div class="ttdoc">Daemon endpoint - either source or destination.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00289">common.h:289</a></div></div>
<div class="ttc" id="astructreport_html_a3a4dda0155ea81a8dcd03e17acd12c3d"><div class="ttname"><a href="structreport.html#a3a4dda0155ea81a8dcd03e17acd12c3d">report::imtu</a></div><div class="ttdeci">unsigned imtu</div><div class="ttdoc">Interface MTU.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00334">common.h:334</a></div></div>
<div class="ttc" id="astructflow_html_a54cfb976bbfab7a02cb6738e1a18dcfc"><div class="ttname"><a href="structflow.html#a54cfb976bbfab7a02cb6738e1a18dcfc">flow::first_report_time</a></div><div class="ttdeci">struct timespec first_report_time</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00091">daemon.h:91</a></div></div>
<div class="ttc" id="adestination_8c_html_a5e221610bb1173dbb62d646a69c9b2fc"><div class="ttname"><a href="destination_8c.html#a5e221610bb1173dbb62d646a69c9b2fc">add_flow_destination</a></div><div class="ttdeci">void add_flow_destination(struct request_add_flow_destination *request)</div><div class="ttdoc">To set daemon flow as destination endpoint.</div><div class="ttdef"><b>Definition:</b> <a href="destination_8c_source.html#l00158">destination.c:158</a></div></div>
<div class="ttc" id="astructfg__tcp__info_html"><div class="ttname"><a href="structfg__tcp__info.html">fg_tcp_info</a></div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00267">common.h:267</a></div></div>
<div class="ttc" id="astructflow_html_a61e91ee616f0dd7339cc2994239df3b1"><div class="ttname"><a href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">flow::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00075">daemon.h:75</a></div></div>
<div class="ttc" id="astructlist__node_html_a0b99ca890dbfe832a8475f4bbd72338c"><div class="ttname"><a href="structlist__node.html#a0b99ca890dbfe832a8475f4bbd72338c">list_node::next</a></div><div class="ttdeci">struct list_node * next</div><div class="ttdoc">Pointer to the previous node in the list.</div><div class="ttdef"><b>Definition:</b> <a href="fg__list_8h_source.html#l00040">fg_list.h:40</a></div></div>
<div class="ttc" id="asource_8c_html_a9cfb86590db53e435ca5bcf97b2dc945"><div class="ttname"><a href="source_8c.html#a9cfb86590db53e435ca5bcf97b2dc945">do_connect</a></div><div class="ttdeci">int do_connect(struct flow *flow)</div><div class="ttdoc">Establishes a connection of a flow.</div><div class="ttdef"><b>Definition:</b> <a href="source_8c_source.html#l00153">source.c:153</a></div></div>
<div class="ttc" id="astructreport_html_a4cced7e0a3c15aa25a0b1a095ad3e78e"><div class="ttname"><a href="structreport.html#a4cced7e0a3c15aa25a0b1a095ad3e78e">report::end</a></div><div class="ttdeci">struct timespec end</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00293">common.h:293</a></div></div>
<div class="ttc" id="adaemon_8c_html_a404ebcfc5a80e668901703c46a807157"><div class="ttname"><a href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a></div><div class="ttdeci">struct linked_list flows</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00103">daemon.c:103</a></div></div>
<div class="ttc" id="astructreport_html_a528c4587a08a4a415c7089932facd980"><div class="ttname"><a href="structreport.html#a528c4587a08a4a415c7089932facd980">report::tcp_info</a></div><div class="ttdeci">struct fg_tcp_info tcp_info</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00329">common.h:329</a></div></div>
<div class="ttc" id="adaemon_8h_html_a03812c2ffe8d7c7ee20036c7ff10debb"><div class="ttname"><a href="daemon_8h.html#a03812c2ffe8d7c7ee20036c7ff10debb">REQUEST_START_FLOWS</a></div><div class="ttdeci">#define REQUEST_START_FLOWS</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00175">daemon.h:175</a></div></div>
<div class="ttc" id="astructflow_html_a3709d35dd1086e178000fe1cd7775656"><div class="ttname"><a href="structflow.html#a3709d35dd1086e178000fe1cd7775656">flow::current_block_bytes_written</a></div><div class="ttdeci">unsigned current_block_bytes_written</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00104">daemon.h:104</a></div></div>
<div class="ttc" id="adaemon_8c_html_af8bb1c94838c1b1156135080f0438faa"><div class="ttname"><a href="daemon_8c.html#af8bb1c94838c1b1156135080f0438faa">timer_check</a></div><div class="ttdeci">static void timer_check()</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00691">daemon.c:691</a></div></div>
<div class="ttc" id="astructreport_html_a18e53a95141a93975bc72f68ca0a8cca"><div class="ttname"><a href="structreport.html#a18e53a95141a93975bc72f68ca0a8cca">report::request_blocks_read</a></div><div class="ttdeci">unsigned request_blocks_read</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00301">common.h:301</a></div></div>
<div class="ttc" id="astructflow__settings_html_aeebdd152f5d7d68a4435b31313550bad"><div class="ttname"><a href="structflow__settings.html#aeebdd152f5d7d68a4435b31313550bad">flow_settings::mtcp</a></div><div class="ttdeci">int mtcp</div><div class="ttdoc">Set TCP_MTCP (15) on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00242">common.h:242</a></div></div>
<div class="ttc" id="afg__socket_8c_html_acd5c2f8cbb01fc2c9aad7574fa2d7d63"><div class="ttname"><a href="fg__socket_8c.html#acd5c2f8cbb01fc2c9aad7574fa2d7d63">set_congestion_control</a></div><div class="ttdeci">int set_congestion_control(int fd, const char *cc_alg)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00265">fg_socket.c:265</a></div></div>
<div class="ttc" id="astructreport_html_a431ccdbe065dbfc7e641ddb7cfb71bd3"><div class="ttname"><a href="structreport.html#a431ccdbe065dbfc7e641ddb7cfb71bd3">report::rtt_min</a></div><div class="ttdeci">double rtt_min</div><div class="ttdoc">Minimum round-trip time.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00321">common.h:321</a></div></div>
<div class="ttc" id="astructflow_1_1statistics_html_ae55bad583676234bb11d6508222b7491"><div class="ttname"><a href="structflow_1_1statistics.html#ae55bad583676234bb11d6508222b7491">flow::statistics::iat_sum</a></div><div class="ttdeci">double iat_sum</div><div class="ttdoc">Accumulated interarrival time.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00142">daemon.h:142</a></div></div>
<div class="ttc" id="adaemon_8c_html_a9f3ff8ee35a524d84af02768849f3673"><div class="ttname"><a href="daemon_8c.html#a9f3ff8ee35a524d84af02768849f3673">process_rtt</a></div><div class="ttdeci">static void process_rtt(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01204">daemon.c:1204</a></div></div>
<div class="ttc" id="astructflow_html_a07ae1fba61090712dae7c9fbe130a48a"><div class="ttname"><a href="structflow.html#a07ae1fba61090712dae7c9fbe130a48a">flow::pcap_thread</a></div><div class="ttdeci">pthread_t pcap_thread</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00161">daemon.h:161</a></div></div>
<div class="ttc" id="adaemon_8c_html_a22822755789d0770b81f031d467cd6e4"><div class="ttname"><a href="daemon_8c.html#a22822755789d0770b81f031d467cd6e4">started</a></div><div class="ttdeci">char started</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00105">daemon.c:105</a></div></div>
<div class="ttc" id="adaemon_8c_html_a08a1bae2da6cab801ece1025a260b1b1"><div class="ttname"><a href="daemon_8c.html#a08a1bae2da6cab801ece1025a260b1b1">CONGESTION_LIMIT</a></div><div class="ttdeci">#define CONGESTION_LIMIT</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00085">daemon.c:85</a></div></div>
<div class="ttc" id="acommon_8h_html_a413eaa5f6866b1c5f00fc612e7afadc5afa8fd18ddb40f762f6a278f50f0f8d50"><div class="ttname"><a href="common_8h.html#a413eaa5f6866b1c5f00fc612e7afadc5afa8fd18ddb40f762f6a278f50f0f8d50">level_ipproto_tcp</a></div><div class="ttdeci">@ level_ipproto_tcp</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00125">common.h:125</a></div></div>
<div class="ttc" id="adaemon_8h_html_a3a11d078671d380e037fd310d4e614cd"><div class="ttname"><a href="daemon_8h.html#a3a11d078671d380e037fd310d4e614cd">REQUEST_ADD_SOURCE</a></div><div class="ttdeci">#define REQUEST_ADD_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00174">daemon.h:174</a></div></div>
<div class="ttc" id="adaemon_8h_html_a1cb3dd3b58581d382be8492aba04511f"><div class="ttname"><a href="daemon_8h.html#a1cb3dd3b58581d382be8492aba04511f">REQUEST_ADD_DESTINATION</a></div><div class="ttdeci">#define REQUEST_ADD_DESTINATION</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00173">daemon.h:173</a></div></div>
<div class="ttc" id="astructreport_html_ae81ba92c32db53c978e9367ea9d0ebba"><div class="ttname"><a href="structreport.html#ae81ba92c32db53c978e9367ea9d0ebba">report::begin</a></div><div class="ttdeci">struct timespec begin</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00292">common.h:292</a></div></div>
<div class="ttc" id="astructflow__settings_html_ae1bb84bc89626d9c6950b41a7a124ee2"><div class="ttname"><a href="structflow__settings.html#ae1bb84bc89626d9c6950b41a7a124ee2">flow_settings::so_debug</a></div><div class="ttdeci">int so_debug</div><div class="ttdoc">Sets SO_DEBUG on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00206">common.h:206</a></div></div>
<div class="ttc" id="astructrequest__get__status_html_abff36def99e64c89154a718058b1226c"><div class="ttname"><a href="structrequest__get__status.html#abff36def99e64c89154a718058b1226c">request_get_status::r</a></div><div class="ttdeci">struct request r</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00249">daemon.h:249</a></div></div>
<div class="ttc" id="afg__socket_8c_html_a3812672e43521addb0f94be5ec70a2c7"><div class="ttname"><a href="fg__socket_8c.html#a3812672e43521addb0f94be5ec70a2c7">set_tcp_mtcp</a></div><div class="ttdeci">int set_tcp_mtcp(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00347">fg_socket.c:347</a></div></div>
<div class="ttc" id="afg__time_8c_html_ac2b9db9a31fa442023443d234787ef78"><div class="ttname"><a href="fg__time_8c.html#ac2b9db9a31fa442023443d234787ef78">gettime</a></div><div class="ttdeci">int gettime(struct timespec *tp)</div><div class="ttdoc">Returns the current wall-clock time with nanosecond precision.</div><div class="ttdef"><b>Definition:</b> <a href="fg__time_8c_source.html#l00145">fg_time.c:145</a></div></div>
<div class="ttc" id="astructreport_html_a8e77e60d692703b2273e058e0f879c11"><div class="ttname"><a href="structreport.html#a8e77e60d692703b2273e058e0f879c11">report::iat_min</a></div><div class="ttdeci">double iat_min</div><div class="ttdoc">Minimum inter-arrival time.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00309">common.h:309</a></div></div>
<div class="ttc" id="afg__list_8c_html_a7b1316612a89d2df33e3be100fb1e797"><div class="ttname"><a href="fg__list_8c.html#a7b1316612a89d2df33e3be100fb1e797">fg_list_front</a></div><div class="ttdeci">const struct list_node * fg_list_front(struct linked_list *const list)</div><div class="ttdoc">Returns the first element of the list.</div><div class="ttdef"><b>Definition:</b> <a href="fg__list_8c_source.html#l00049">fg_list.c:49</a></div></div>
<div class="ttc" id="astructreport_html_a1371323e38cf2d43f2b822ee23a5528c"><div class="ttname"><a href="structreport.html#a1371323e38cf2d43f2b822ee23a5528c">report::response_blocks_read</a></div><div class="ttdeci">unsigned response_blocks_read</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00303">common.h:303</a></div></div>
<div class="ttc" id="astructflow__settings_html_aea33a5413dbace7b756f93afdea7963d"><div class="ttname"><a href="structflow__settings.html#aea33a5413dbace7b756f93afdea7963d">flow_settings::route_record</a></div><div class="ttdeci">int route_record</div><div class="ttdoc">Sets ROUTE_RECORD on test socket (option -O).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00208">common.h:208</a></div></div>
<div class="ttc" id="astructflow_html_aa2528505c57e84cca76a29fd0881fd37"><div class="ttname"><a href="structflow.html#aa2528505c57e84cca76a29fd0881fd37">flow::statistics</a></div><div class="ttdeci">struct flow::statistics statistics[2]</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="daemon_8c.html">daemon.c</a></li>
    <li class="footer">Generated on Sat Jan 16 2021 18:15:29 for Flowgrind by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
