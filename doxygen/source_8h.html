<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Flowgrind: src/source.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="flowgrind.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Flowgrind
   </div>
   <div id="projectbrief">Advanced TCP traffic generator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('source_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">source.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Routines used by Flowgrind to setup the source for a test flow.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="config_8h_source.html">config.h</a>&quot;</code><br />
</div>
<p><a href="source_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a775335e0a04baa4925bb57dbec7d8b44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="source_8h.html#a775335e0a04baa4925bb57dbec7d8b44">add_flow_source</a> (struct <a class="el" href="structrequest__add__flow__source.html">request_add_flow_source</a> *<a class="el" href="structrequest.html">request</a>)</td></tr>
<tr class="memdesc:a775335e0a04baa4925bb57dbec7d8b44"><td class="mdescLeft">&#160;</td><td class="mdescRight">To set daemon flow as source endpoint.  <a href="source_8h.html#a775335e0a04baa4925bb57dbec7d8b44">More...</a><br /></td></tr>
<tr class="separator:a775335e0a04baa4925bb57dbec7d8b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cfb86590db53e435ca5bcf97b2dc945"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="source_8h.html#a9cfb86590db53e435ca5bcf97b2dc945">do_connect</a> (struct <a class="el" href="structflow.html">flow</a> *<a class="el" href="structflow.html">flow</a>)</td></tr>
<tr class="memdesc:a9cfb86590db53e435ca5bcf97b2dc945"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establishes a connection of a flow.  <a href="source_8h.html#a9cfb86590db53e435ca5bcf97b2dc945">More...</a><br /></td></tr>
<tr class="separator:a9cfb86590db53e435ca5bcf97b2dc945"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines used by Flowgrind to setup the source for a test flow. </p>

<p class="definition">Definition in file <a class="el" href="source_8h_source.html">source.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a775335e0a04baa4925bb57dbec7d8b44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a775335e0a04baa4925bb57dbec7d8b44">&#9670;&nbsp;</a></span>add_flow_source()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int add_flow_source </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrequest__add__flow__source.html">request_add_flow_source</a> *&#160;</td>
          <td class="paramname"><em>request</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To set daemon flow as source endpoint. </p>
<p>To set the flow options and settings as source endpoint. Depending upon the late connection option the data connection is established to connect the destination daemon listening port address with source daemon.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">request</td><td>Contain the test option and parameter for daemon source endpoint </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="source_8c_source.html#l00177">177</a> of file <a class="el" href="source_8c_source.html">source.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#ifdef HAVE_SO_TCP_CONGESTION</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        socklen_t opt_len = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_SO_TCP_CONGESTION */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keyword">struct </span><a class="code" href="structflow.html">flow</a> *<a class="code" href="structflow.html">flow</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="fg__list_8c.html#a4f790759b24f1f5d4e5867383d4dd0ad">fg_list_size</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>) &gt;= <a class="code" href="common_8h.html#a9c706d595e905d5c4cec26b794d85634">MAX_FLOWS_DAEMON</a>) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_WARNING, <span class="stringliteral">&quot;can not accept another flow, already &quot;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                        <span class="stringliteral">&quot;handling %zu flows&quot;</span>, <a class="code" href="fg__list_8c.html#a4f790759b24f1f5d4e5867383d4dd0ad">fg_list_size</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <a class="code" href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a>(&amp;<a class="code" href="structrequest.html">request</a>-&gt;r,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        <span class="stringliteral">&quot;Can not accept another flow, already &quot;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                        <span class="stringliteral">&quot;handling %zu flows.&quot;</span>, <a class="code" href="fg__list_8c.html#a4f790759b24f1f5d4e5867383d4dd0ad">fg_list_size</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="structflow.html">flow</a> = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structflow.html">flow</a>));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="structflow.html">flow</a>) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_ALERT, <span class="stringliteral">&quot;could not allocate memory for flow&quot;</span>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="source_8c.html#a22c94b0d420c70aec0021a94511684c9">init_flow</a>(<a class="code" href="structflow.html">flow</a>, 1);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a> = <a class="code" href="structrequest.html">request</a>-&gt;settings;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a79abf940bb0e1fbdf027152aa00ba51a">source_settings</a> = <a class="code" href="structrequest.html">request</a>-&gt;source_settings;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">/* be greedy with buffer sizes */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a> = calloc(1, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">read_block</a> = calloc(1, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">/* Controller flow ID is set in the daemon */</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a1144784676f7ead2cf557fa96838ddb2">flow_id</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a> == NULL || <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">read_block</a> == NULL) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_ALERT, <span class="stringliteral">&quot;could not allocate memory for read/write &quot;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        <span class="stringliteral">&quot;blocks&quot;</span>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <a class="code" href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a>(&amp;<a class="code" href="structrequest.html">request</a>-&gt;r, <span class="stringliteral">&quot;could not allocate memory for read/write blocks&quot;</span>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <a class="code" href="source_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#abc6728769659e18a72dd12549d4f6f94">byte_counting</a>) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="keywordtype">int</span> byte_idx;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <span class="keywordflow">for</span> (byte_idx = 0; byte_idx &lt; <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">maximum_block_size</a>; byte_idx++)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                        *(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">write_block</a> + byte_idx) = (<span class="keywordtype">unsigned</span> char)(byte_idx &amp; 0xff);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#ab7176e838d97cf4f2e2df0fe8ca31baa">state</a> = <a class="code" href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c">GRIND_WAIT_CONNECT</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a> = <a class="code" href="source_8c.html#ae470c436de77e5f4d64f087029502569">name2socket</a>(<a class="code" href="structflow.html">flow</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a79abf940bb0e1fbdf027152aa00ba51a">source_settings</a>.<a class="code" href="structflow__source__settings.html#abc33c5c7eb17c03684e7af4c5fc7254a">destination_host</a>,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a79abf940bb0e1fbdf027152aa00ba51a">source_settings</a>.<a class="code" href="structflow__source__settings.html#a04b3a72e499b89c1f658f9000e8bfe8a">destination_port</a>,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                        &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a65aa5ef64b2308b297a95c1160200fdc">addr</a>, &amp;<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a6b33be7c69c542994e0861d0421d1338">addr_len</a>,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a6f82584854b543c89a1cf9bd21c1ddc2">requested_read_buffer_size</a>, &amp;<a class="code" href="structrequest.html">request</a>-&gt;real_read_buffer_size,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">settings</a>.<a class="code" href="structflow__settings.html#a2b2a17fb2fce5fb908dad96b110cf17b">requested_send_buffer_size</a>, &amp;<a class="code" href="structrequest.html">request</a>-&gt;real_send_buffer_size);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a> == -1) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <a class="code" href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a>(LOG_ALERT, <span class="stringliteral">&quot;could not create data socket: %s&quot;</span>,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <a class="code" href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a>(&amp;<a class="code" href="structrequest.html">request</a>-&gt;r, <span class="stringliteral">&quot;Could not create data socket: %s&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <a class="code" href="source_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="daemon_8c.html#afa6483c8495b4df9665927f6ab4eaabb">set_flow_tcp_options</a>(<a class="code" href="structflow.html">flow</a>) == -1) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <a class="code" href="structrequest.html">request</a>-&gt;r.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a> = NULL;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <a class="code" href="source_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#ifdef HAVE_SO_TCP_CONGESTION</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        opt_len = <span class="keyword">sizeof</span>(<a class="code" href="structrequest.html">request</a>-&gt;cc_alg);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> (getsockopt(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, IPPROTO_TCP, TCP_CONGESTION,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                <a class="code" href="structrequest.html">request</a>-&gt;cc_alg, &amp;opt_len) == -1) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <a class="code" href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a>(&amp;<a class="code" href="structrequest.html">request</a>-&gt;r, <span class="stringliteral">&quot;failed to determine actual congestion control algorithm: %s&quot;</span>,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                        strerror(errno));</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <a class="code" href="source_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_SO_TCP_CONGESTION */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="preprocessor">#ifdef HAVE_LIBPCAP</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="fg__pcap_8c.html#ac5b67a433dfaab6960b30c8e310ff748">fg_pcap_go</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_LIBPCAP */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a79abf940bb0e1fbdf027152aa00ba51a">source_settings</a>.<a class="code" href="structflow__source__settings.html#a6e94ce54173e1dfc09a560894ed2b3c3">late_connect</a>) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <a class="code" href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a>(4, <span class="stringliteral">&quot;(early) connecting test socket (fd=%u)&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="source_8c.html#a9cfb86590db53e435ca5bcf97b2dc945">do_connect</a>(<a class="code" href="structflow.html">flow</a>) == -1) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                        <a class="code" href="structrequest.html">request</a>-&gt;r.<a class="code" href="structrequest.html#acc214191f4fbfabdedf789adc862b393">error</a> = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">error</a> = NULL;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                        <a class="code" href="source_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a>(<a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="structrequest.html">request</a>-&gt;flow_id = <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="fg__list_8c.html#a1068bfcc67cd1f670b8a66fc359c3a81">fg_list_push_back</a>(&amp;<a class="code" href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a>, <a class="code" href="structflow.html">flow</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9cfb86590db53e435ca5bcf97b2dc945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cfb86590db53e435ca5bcf97b2dc945">&#9670;&nbsp;</a></span>do_connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int do_connect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structflow.html">flow</a> *&#160;</td>
          <td class="paramname"><em>flow</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establishes a connection of a flow. </p>
<p>Establishes a connection to the destination daemon listening port, and marks the flow as connected.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">flow</td><td>Flow to connect. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="source_8c_source.html#l00153">153</a> of file <a class="el" href="source_8c_source.html">source.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                  {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        rc = connect(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a65aa5ef64b2308b297a95c1160200fdc">addr</a>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a6b33be7c69c542994e0861d0421d1338">addr_len</a>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> (rc == -1 &amp;&amp; errno != EINPROGRESS) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <a class="code" href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a>(<a class="code" href="structflow.html">flow</a>, <span class="stringliteral">&quot;connect() failed: %s&quot;</span>,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                strerror(errno));</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <a class="code" href="fg__error_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a>(<span class="stringliteral">&quot;failed to connect flow %u&quot;</span>, <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">id</a>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a116b10ed1d681c8b889f0417ae4aafe4">connect_called</a> = 1;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a94e826d731af3ce59414ab483ff3e4f7">pmtu</a> = <a class="code" href="fg__socket_8c.html#abeb6cde31aa19f818745d2bffed938b4">get_pmtu</a>(<a class="code" href="structflow.html">flow</a>-&gt;<a class="code" href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">fd</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="adebug_8h_html_ae420d5a1d63f99c6a2a386c4eea54250"><div class="ttname"><a href="debug_8h.html#ae420d5a1d63f99c6a2a386c4eea54250">DEBUG_MSG</a></div><div class="ttdeci">#define DEBUG_MSG(LVL, MSG,...)</div><div class="ttdoc">Print debug message to standard error.</div><div class="ttdef"><b>Definition:</b> <a href="debug_8h_source.html#l00049">debug.h:49</a></div></div>
<div class="ttc" id="afg__list_8c_html_a4f790759b24f1f5d4e5867383d4dd0ad"><div class="ttname"><a href="fg__list_8c.html#a4f790759b24f1f5d4e5867383d4dd0ad">fg_list_size</a></div><div class="ttdeci">size_t fg_list_size(struct linked_list *const list)</div><div class="ttdoc">Returns the number of elements in the list.</div><div class="ttdef"><b>Definition:</b> <a href="fg__list_8c_source.html#l00211">fg_list.c:211</a></div></div>
<div class="ttc" id="astructflow_html_a116b10ed1d681c8b889f0417ae4aafe4"><div class="ttname"><a href="structflow.html#a116b10ed1d681c8b889f0417ae4aafe4">flow::connect_called</a></div><div class="ttdeci">char connect_called</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00111">daemon.h:111</a></div></div>
<div class="ttc" id="astructflow_html"><div class="ttname"><a href="structflow.html">flow</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00073">daemon.h:73</a></div></div>
<div class="ttc" id="adaemon_8c_html_ace116bed071948dc1f66acc55607feb3"><div class="ttname"><a href="daemon_8c.html#ace116bed071948dc1f66acc55607feb3">request_error</a></div><div class="ttdeci">void request_error(struct request *request, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00132">daemon.c:132</a></div></div>
<div class="ttc" id="astructflow__settings_html_a6f82584854b543c89a1cf9bd21c1ddc2"><div class="ttname"><a href="structflow__settings.html#a6f82584854b543c89a1cf9bd21c1ddc2">flow_settings::requested_read_buffer_size</a></div><div class="ttdeci">int requested_read_buffer_size</div><div class="ttdoc">Request receiver buffer, advertised window in bytes (option -W).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00198">common.h:198</a></div></div>
<div class="ttc" id="astructflow__source__settings_html_abc33c5c7eb17c03684e7af4c5fc7254a"><div class="ttname"><a href="structflow__source__settings.html#abc33c5c7eb17c03684e7af4c5fc7254a">flow_source_settings::destination_host</a></div><div class="ttdeci">char destination_host[256]</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00065">daemon.h:65</a></div></div>
<div class="ttc" id="asource_8c_html_ae470c436de77e5f4d64f087029502569"><div class="ttname"><a href="source_8c.html#ae470c436de77e5f4d64f087029502569">name2socket</a></div><div class="ttdeci">static int name2socket(struct flow *flow, char *server_name, unsigned port, struct sockaddr **saptr, socklen_t *lenp, const int read_buffer_size_req, int *read_buffer_size, const int send_buffer_size_req, int *send_buffer_size)</div><div class="ttdef"><b>Definition:</b> <a href="source_8c_source.html#l00076">source.c:76</a></div></div>
<div class="ttc" id="adaemon_8c_html_afa6483c8495b4df9665927f6ab4eaabb"><div class="ttname"><a href="daemon_8c.html#afa6483c8495b4df9665927f6ab4eaabb">set_flow_tcp_options</a></div><div class="ttdeci">int set_flow_tcp_options(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l01424">daemon.c:1424</a></div></div>
<div class="ttc" id="afg__log_8c_html_a2aea54bb4eab90a69510db34326d82f4"><div class="ttname"><a href="fg__log_8c.html#a2aea54bb4eab90a69510db34326d82f4">logging</a></div><div class="ttdeci">void logging(int priority, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="fg__log_8c_source.html#l00069">fg_log.c:69</a></div></div>
<div class="ttc" id="acommon_8h_html_a9c706d595e905d5c4cec26b794d85634"><div class="ttname"><a href="common_8h.html#a9c706d595e905d5c4cec26b794d85634">MAX_FLOWS_DAEMON</a></div><div class="ttdeci">#define MAX_FLOWS_DAEMON</div><div class="ttdoc">Maximal number of parallel flows supported by one daemon instance.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00065">common.h:65</a></div></div>
<div class="ttc" id="astructflow_html_a79abf940bb0e1fbdf027152aa00ba51a"><div class="ttname"><a href="structflow.html#a79abf940bb0e1fbdf027152aa00ba51a">flow::source_settings</a></div><div class="ttdeci">struct flow_source_settings source_settings</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00084">daemon.h:84</a></div></div>
<div class="ttc" id="astructflow_html_a94e826d731af3ce59414ab483ff3e4f7"><div class="ttname"><a href="structflow.html#a94e826d731af3ce59414ab483ff3e4f7">flow::pmtu</a></div><div class="ttdeci">int pmtu</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00114">daemon.h:114</a></div></div>
<div class="ttc" id="astructflow__settings_html_abc6728769659e18a72dd12549d4f6f94"><div class="ttname"><a href="structflow__settings.html#abc6728769659e18a72dd12549d4f6f94">flow_settings::byte_counting</a></div><div class="ttdeci">int byte_counting</div><div class="ttdoc">Enumerate bytes in payload instead of sending zeros (option -E).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00229">common.h:229</a></div></div>
<div class="ttc" id="astructflow_html_abf86c8f5e99971c55bee93782f3c06b4"><div class="ttname"><a href="structflow.html#abf86c8f5e99971c55bee93782f3c06b4">flow::settings</a></div><div class="ttdeci">struct flow_settings settings</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00083">daemon.h:83</a></div></div>
<div class="ttc" id="astructflow_html_ac95c5a7384556d504e9b1312c766d5f5"><div class="ttname"><a href="structflow.html#ac95c5a7384556d504e9b1312c766d5f5">flow::read_block</a></div><div class="ttdeci">char * read_block</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00097">daemon.h:97</a></div></div>
<div class="ttc" id="asource_8c_html_a22c94b0d420c70aec0021a94511684c9"><div class="ttname"><a href="source_8c.html#a22c94b0d420c70aec0021a94511684c9">init_flow</a></div><div class="ttdeci">void init_flow(struct flow *flow, int is_source)</div><div class="ttdoc">To initialize all flows to the default value.</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00896">daemon.c:896</a></div></div>
<div class="ttc" id="afg__error_8h_html_ad25a1c617278c25cbcbb9b9a3a6b8024"><div class="ttname"><a href="fg__error_8h.html#ad25a1c617278c25cbcbb9b9a3a6b8024">err</a></div><div class="ttdeci">#define err(...)</div><div class="ttdoc">To report an error w/ the corresponding system error message.</div><div class="ttdef"><b>Definition:</b> <a href="fg__error_8h_source.html#l00043">fg_error.h:43</a></div></div>
<div class="ttc" id="astructflow__settings_html_a89b7f00123725264aab18759d7bc7258"><div class="ttname"><a href="structflow__settings.html#a89b7f00123725264aab18759d7bc7258">flow_settings::maximum_block_size</a></div><div class="ttdeci">int maximum_block_size</div><div class="ttdoc">Application buffer size in bytes (option -U).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00201">common.h:201</a></div></div>
<div class="ttc" id="astructflow__source__settings_html_a6e94ce54173e1dfc09a560894ed2b3c3"><div class="ttname"><a href="structflow__source__settings.html#a6e94ce54173e1dfc09a560894ed2b3c3">flow_source_settings::late_connect</a></div><div class="ttdeci">int late_connect</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00068">daemon.h:68</a></div></div>
<div class="ttc" id="afg__pcap_8c_html_ac5b67a433dfaab6960b30c8e310ff748"><div class="ttname"><a href="fg__pcap_8c.html#ac5b67a433dfaab6960b30c8e310ff748">fg_pcap_go</a></div><div class="ttdeci">void fg_pcap_go(struct flow *flow)</div><div class="ttdoc">Start a tcpdump to capture traffic of the provided flow.</div><div class="ttdef"><b>Definition:</b> <a href="fg__pcap_8c_source.html#l00314">fg_pcap.c:314</a></div></div>
<div class="ttc" id="astructflow__settings_html_a1144784676f7ead2cf557fa96838ddb2"><div class="ttname"><a href="structflow__settings.html#a1144784676f7ead2cf557fa96838ddb2">flow_settings::flow_id</a></div><div class="ttdeci">int flow_id</div><div class="ttdoc">Flow ID maintained by controller.</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00186">common.h:186</a></div></div>
<div class="ttc" id="astructrequest_html"><div class="ttname"><a href="structrequest.html">request</a></div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00179">daemon.h:179</a></div></div>
<div class="ttc" id="astructflow_html_a74df07d93cabc54a4b43f53fb90d7eb6"><div class="ttname"><a href="structflow.html#a74df07d93cabc54a4b43f53fb90d7eb6">flow::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00170">daemon.h:170</a></div></div>
<div class="ttc" id="adaemon_8h_html_ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c"><div class="ttname"><a href="daemon_8h.html#ab8dcbe03f47dda503913a20c52bf4de7a775efd247fbb05a726a596cac1b2ad7c">GRIND_WAIT_CONNECT</a></div><div class="ttdeci">@ GRIND_WAIT_CONNECT</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00056">daemon.h:56</a></div></div>
<div class="ttc" id="afg__socket_8c_html_abeb6cde31aa19f818745d2bffed938b4"><div class="ttname"><a href="fg__socket_8c.html#abeb6cde31aa19f818745d2bffed938b4">get_pmtu</a></div><div class="ttdeci">int get_pmtu(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fg__socket_8c_source.html#l00193">fg_socket.c:193</a></div></div>
<div class="ttc" id="astructrequest_html_acc214191f4fbfabdedf789adc862b393"><div class="ttname"><a href="structrequest.html#acc214191f4fbfabdedf789adc862b393">request::error</a></div><div class="ttdeci">char * error</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00187">daemon.h:187</a></div></div>
<div class="ttc" id="astructflow_html_a6b33be7c69c542994e0861d0421d1338"><div class="ttname"><a href="structflow.html#a6b33be7c69c542994e0861d0421d1338">flow::addr_len</a></div><div class="ttdeci">socklen_t addr_len</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00120">daemon.h:120</a></div></div>
<div class="ttc" id="astructflow_html_a8c89f7316d6e7fab40989f40ac8a972d"><div class="ttname"><a href="structflow.html#a8c89f7316d6e7fab40989f40ac8a972d">flow::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00080">daemon.h:80</a></div></div>
<div class="ttc" id="adaemon_8c_html_a2b81f4cc8f5217b1d4ffa4a437377429"><div class="ttname"><a href="daemon_8c.html#a2b81f4cc8f5217b1d4ffa4a437377429">flow_error</a></div><div class="ttdeci">void flow_error(struct flow *flow, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00119">daemon.c:119</a></div></div>
<div class="ttc" id="astructflow_html_a65aa5ef64b2308b297a95c1160200fdc"><div class="ttname"><a href="structflow.html#a65aa5ef64b2308b297a95c1160200fdc">flow::addr</a></div><div class="ttdeci">struct sockaddr * addr</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00119">daemon.h:119</a></div></div>
<div class="ttc" id="astructflow_html_a38257f57bf1c4d26c1d50c02630c744d"><div class="ttname"><a href="structflow.html#a38257f57bf1c4d26c1d50c02630c744d">flow::write_block</a></div><div class="ttdeci">char * write_block</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00098">daemon.h:98</a></div></div>
<div class="ttc" id="afg__list_8c_html_a1068bfcc67cd1f670b8a66fc359c3a81"><div class="ttname"><a href="fg__list_8c.html#a1068bfcc67cd1f670b8a66fc359c3a81">fg_list_push_back</a></div><div class="ttdeci">int fg_list_push_back(struct linked_list *const list, void *const data)</div><div class="ttdoc">Inserts a new element at the end of the list.</div><div class="ttdef"><b>Definition:</b> <a href="fg__list_8c_source.html#l00167">fg_list.c:167</a></div></div>
<div class="ttc" id="astructflow_html_ab7176e838d97cf4f2e2df0fe8ca31baa"><div class="ttname"><a href="structflow.html#ab7176e838d97cf4f2e2df0fe8ca31baa">flow::state</a></div><div class="ttdeci">enum flow_state_t state</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00077">daemon.h:77</a></div></div>
<div class="ttc" id="astructflow_html_a61e91ee616f0dd7339cc2994239df3b1"><div class="ttname"><a href="structflow.html#a61e91ee616f0dd7339cc2994239df3b1">flow::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00075">daemon.h:75</a></div></div>
<div class="ttc" id="asource_8c_html_a9cfb86590db53e435ca5bcf97b2dc945"><div class="ttname"><a href="source_8c.html#a9cfb86590db53e435ca5bcf97b2dc945">do_connect</a></div><div class="ttdeci">int do_connect(struct flow *flow)</div><div class="ttdoc">Establishes a connection of a flow.</div><div class="ttdef"><b>Definition:</b> <a href="source_8c_source.html#l00153">source.c:153</a></div></div>
<div class="ttc" id="adaemon_8c_html_a404ebcfc5a80e668901703c46a807157"><div class="ttname"><a href="daemon_8c.html#a404ebcfc5a80e668901703c46a807157">flows</a></div><div class="ttdeci">struct linked_list flows</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00103">daemon.c:103</a></div></div>
<div class="ttc" id="astructflow__source__settings_html_a04b3a72e499b89c1f658f9000e8bfe8a"><div class="ttname"><a href="structflow__source__settings.html#a04b3a72e499b89c1f658f9000e8bfe8a">flow_source_settings::destination_port</a></div><div class="ttdeci">int destination_port</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8h_source.html#l00066">daemon.h:66</a></div></div>
<div class="ttc" id="asource_8c_html_a48bcab4c829140d6115c3b71e5c6ddc9"><div class="ttname"><a href="source_8c.html#a48bcab4c829140d6115c3b71e5c6ddc9">uninit_flow</a></div><div class="ttdeci">void uninit_flow(struct flow *flow)</div><div class="ttdef"><b>Definition:</b> <a href="daemon_8c_source.html#l00165">daemon.c:165</a></div></div>
<div class="ttc" id="astructflow__settings_html_a2b2a17fb2fce5fb908dad96b110cf17b"><div class="ttname"><a href="structflow__settings.html#a2b2a17fb2fce5fb908dad96b110cf17b">flow_settings::requested_send_buffer_size</a></div><div class="ttdeci">int requested_send_buffer_size</div><div class="ttdoc">Request sender buffer in bytes (option -B).</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00196">common.h:196</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="source_8h.html">source.h</a></li>
    <li class="footer">Generated on Sat Jan 16 2021 18:15:30 for Flowgrind by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
